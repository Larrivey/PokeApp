(()=>{var hb=Object.create;var Kf=Object.defineProperty;var fb=Object.getOwnPropertyDescriptor;var pb=Object.getOwnPropertyNames;var mb=Object.getPrototypeOf,gb=Object.prototype.hasOwnProperty;var Bs=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,n)=>(typeof require!="undefined"?require:e)[n]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var zs=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var _b=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of pb(e))!gb.call(t,r)&&r!==n&&Kf(t,r,{get:()=>e[r],enumerable:!(i=fb(e,r))||i.enumerable});return t};var Vs=(t,e,n)=>(n=t!=null?hb(mb(t)):{},_b(e||!t||!t.__esModule?Kf(n,"default",{value:t,enumerable:!0}):n,t));var Qm=zs((cd,ud)=>{(function(t,e){typeof cd=="object"&&typeof ud<"u"?ud.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs=e()})(cd,function(){"use strict";var t=1e3,e=6e4,n=36e5,i="millisecond",r="second",s="minute",o="hour",a="day",l="week",c="month",h="quarter",u="year",d="date",p="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(L,f,I){var q=String(L);return!q||q.length>=f?L:""+Array(f+1-q.length).join(I)+L},w={s:v,z:function(L){var f=-L.utcOffset(),I=Math.abs(f),q=Math.floor(I/60),M=I%60;return(f<=0?"+":"-")+v(q,2,"0")+":"+v(M,2,"0")},m:function L(f,I){if(f.date()<I.date())return-L(I,f);var q=12*(I.year()-f.year())+(I.month()-f.month()),M=f.clone().add(q,c),Q=I-M<0,b=f.clone().add(q+(Q?-1:1),c);return+(-(q+(I-M)/(Q?M-b:b-M))||0)},a:function(L){return L<0?Math.ceil(L)||0:Math.floor(L)},p:function(L){return{M:c,y:u,w:l,d:a,D:d,h:o,m:s,s:r,ms:i,Q:h}[L]||String(L||"").toLowerCase().replace(/s$/,"")},u:function(L){return L===void 0}},S="en",x={};x[S]=y;var P=function(L){return L instanceof G},F=function L(f,I,q){var M;if(!f)return S;if(typeof f=="string"){var Q=f.toLowerCase();x[Q]&&(M=Q),I&&(x[Q]=I,M=Q);var b=f.split("-");if(!M&&b.length>1)return L(b[0])}else{var W=f.name;x[W]=f,M=W}return!q&&M&&(S=M),M||!q&&S},C=function(L,f){if(P(L))return L.clone();var I=typeof f=="object"?f:{};return I.date=L,I.args=arguments,new G(I)},B=w;B.l=F,B.i=P,B.w=function(L,f){return C(L,{locale:f.$L,utc:f.$u,x:f.$x,$offset:f.$offset})};var G=function(){function L(I){this.$L=F(I.locale,null,!0),this.parse(I)}var f=L.prototype;return f.parse=function(I){this.$d=function(q){var M=q.date,Q=q.utc;if(M===null)return new Date(NaN);if(B.u(M))return new Date;if(M instanceof Date)return new Date(M);if(typeof M=="string"&&!/Z$/i.test(M)){var b=M.match(_);if(b){var W=b[2]-1||0,O=(b[7]||"0").substring(0,3);return Q?new Date(Date.UTC(b[1],W,b[3]||1,b[4]||0,b[5]||0,b[6]||0,O)):new Date(b[1],W,b[3]||1,b[4]||0,b[5]||0,b[6]||0,O)}}return new Date(M)}(I),this.$x=I.x||{},this.init()},f.init=function(){var I=this.$d;this.$y=I.getFullYear(),this.$M=I.getMonth(),this.$D=I.getDate(),this.$W=I.getDay(),this.$H=I.getHours(),this.$m=I.getMinutes(),this.$s=I.getSeconds(),this.$ms=I.getMilliseconds()},f.$utils=function(){return B},f.isValid=function(){return this.$d.toString()!==p},f.isSame=function(I,q){var M=C(I);return this.startOf(q)<=M&&M<=this.endOf(q)},f.isAfter=function(I,q){return C(I)<this.startOf(q)},f.isBefore=function(I,q){return this.endOf(q)<C(I)},f.$g=function(I,q,M){return B.u(I)?this[q]:this.set(M,I)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(I,q){var M=this,Q=!!B.u(q)||q,b=B.p(I),W=function(_e,pe){var Ae=B.w(M.$u?Date.UTC(M.$y,pe,_e):new Date(M.$y,pe,_e),M);return Q?Ae:Ae.endOf(a)},O=function(_e,pe){return B.w(M.toDate()[_e].apply(M.toDate("s"),(Q?[0,0,0,0]:[23,59,59,999]).slice(pe)),M)},R=this.$W,ee=this.$M,te=this.$D,ne="set"+(this.$u?"UTC":"");switch(b){case u:return Q?W(1,0):W(31,11);case c:return Q?W(1,ee):W(0,ee+1);case l:var ve=this.$locale().weekStart||0,Ie=(R<ve?R+7:R)-ve;return W(Q?te-Ie:te+(6-Ie),ee);case a:case d:return O(ne+"Hours",0);case o:return O(ne+"Minutes",1);case s:return O(ne+"Seconds",2);case r:return O(ne+"Milliseconds",3);default:return this.clone()}},f.endOf=function(I){return this.startOf(I,!1)},f.$set=function(I,q){var M,Q=B.p(I),b="set"+(this.$u?"UTC":""),W=(M={},M[a]=b+"Date",M[d]=b+"Date",M[c]=b+"Month",M[u]=b+"FullYear",M[o]=b+"Hours",M[s]=b+"Minutes",M[r]=b+"Seconds",M[i]=b+"Milliseconds",M)[Q],O=Q===a?this.$D+(q-this.$W):q;if(Q===c||Q===u){var R=this.clone().set(d,1);R.$d[W](O),R.init(),this.$d=R.set(d,Math.min(this.$D,R.daysInMonth())).$d}else W&&this.$d[W](O);return this.init(),this},f.set=function(I,q){return this.clone().$set(I,q)},f.get=function(I){return this[B.p(I)]()},f.add=function(I,q){var M,Q=this;I=Number(I);var b=B.p(q),W=function(ee){var te=C(Q);return B.w(te.date(te.date()+Math.round(ee*I)),Q)};if(b===c)return this.set(c,this.$M+I);if(b===u)return this.set(u,this.$y+I);if(b===a)return W(1);if(b===l)return W(7);var O=(M={},M[s]=e,M[o]=n,M[r]=t,M)[b]||1,R=this.$d.getTime()+I*O;return B.w(R,this)},f.subtract=function(I,q){return this.add(-1*I,q)},f.format=function(I){var q=this,M=this.$locale();if(!this.isValid())return M.invalidDate||p;var Q=I||"YYYY-MM-DDTHH:mm:ssZ",b=B.z(this),W=this.$H,O=this.$m,R=this.$M,ee=M.weekdays,te=M.months,ne=function(pe,Ae,xe,qe){return pe&&(pe[Ae]||pe(q,Q))||xe[Ae].slice(0,qe)},ve=function(pe){return B.s(W%12||12,pe,"0")},Ie=M.meridiem||function(pe,Ae,xe){var qe=pe<12?"AM":"PM";return xe?qe.toLowerCase():qe},_e={YY:String(this.$y).slice(-2),YYYY:this.$y,M:R+1,MM:B.s(R+1,2,"0"),MMM:ne(M.monthsShort,R,te,3),MMMM:ne(te,R),D:this.$D,DD:B.s(this.$D,2,"0"),d:String(this.$W),dd:ne(M.weekdaysMin,this.$W,ee,2),ddd:ne(M.weekdaysShort,this.$W,ee,3),dddd:ee[this.$W],H:String(W),HH:B.s(W,2,"0"),h:ve(1),hh:ve(2),a:Ie(W,O,!0),A:Ie(W,O,!1),m:String(O),mm:B.s(O,2,"0"),s:String(this.$s),ss:B.s(this.$s,2,"0"),SSS:B.s(this.$ms,3,"0"),Z:b};return Q.replace(g,function(pe,Ae){return Ae||_e[pe]||b.replace(":","")})},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(I,q,M){var Q,b=B.p(q),W=C(I),O=(W.utcOffset()-this.utcOffset())*e,R=this-W,ee=B.m(this,W);return ee=(Q={},Q[u]=ee/12,Q[c]=ee,Q[h]=ee/3,Q[l]=(R-O)/6048e5,Q[a]=(R-O)/864e5,Q[o]=R/n,Q[s]=R/e,Q[r]=R/t,Q)[b]||R,M?ee:B.a(ee)},f.daysInMonth=function(){return this.endOf(c).$D},f.$locale=function(){return x[this.$L]},f.locale=function(I,q){if(!I)return this.$L;var M=this.clone(),Q=F(I,q,!0);return Q&&(M.$L=Q),M},f.clone=function(){return B.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},L}(),T=G.prototype;return C.prototype=T,[["$ms",i],["$s",r],["$m",s],["$H",o],["$W",a],["$M",c],["$y",u],["$D",d]].forEach(function(L){T[L[1]]=function(f){return this.$g(f,L[0],L[1])}}),C.extend=function(L,f){return L.$i||(L(f,G,C),L.$i=!0),C},C.locale=F,C.isDayjs=P,C.unix=function(L){return C(1e3*L)},C.en=x[S],C.Ls=x,C.p={},C})});var eg=zs((dd,hd)=>{(function(t,e){typeof dd=="object"&&typeof hd<"u"?hd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_relativeTime=e()})(dd,function(){"use strict";return function(t,e,n){t=t||{};var i=e.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(a,l,c,h){return i.fromToBase(a,l,c,h)}n.en.relativeTime=r,i.fromToBase=function(a,l,c,h,u){for(var d,p,_,g=c.$locale().relativeTime||r,y=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],v=y.length,w=0;w<v;w+=1){var S=y[w];S.d&&(d=h?n(a).diff(c,S.d,!0):c.diff(a,S.d,!0));var x=(t.rounding||Math.round)(Math.abs(d));if(_=d>0,x<=S.r||!S.r){x<=1&&w>0&&(S=y[w-1]);var P=g[S.l];u&&(x=u(""+x)),p=typeof P=="string"?P.replace("%d",x):P(x,l,S.l,_);break}}if(l)return p;var F=_?g.future:g.past;return typeof F=="function"?F(p):F.replace("%s",p)},i.to=function(a,l){return s(a,l,this,!0)},i.from=function(a,l){return s(a,l,this)};var o=function(a){return a.$u?n.utc():n()};i.toNow=function(a){return this.to(o(this),a)},i.fromNow=function(a){return this.from(o(this),a)}}})});var tg=zs((fd,pd)=>{(function(t,e){typeof fd=="object"&&typeof pd<"u"?pd.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.DOMPurify=e())})(fd,function(){"use strict";function t(D){return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},t(D)}function e(D,Y){return e=Object.setPrototypeOf||function(ae,Te){return ae.__proto__=Te,ae},e(D,Y)}function n(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(D,Y,re){return n()?i=Reflect.construct:i=function(Te,Ke,Ye){var k=[null];k.push.apply(k,Ke);var U=Function.bind.apply(Te,k),N=new U;return Ye&&e(N,Ye.prototype),N},i.apply(null,arguments)}function r(D){return s(D)||o(D)||a(D)||c()}function s(D){if(Array.isArray(D))return l(D)}function o(D){if(typeof Symbol<"u"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}function a(D,Y){if(!!D){if(typeof D=="string")return l(D,Y);var re=Object.prototype.toString.call(D).slice(8,-1);if(re==="Object"&&D.constructor&&(re=D.constructor.name),re==="Map"||re==="Set")return Array.from(D);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return l(D,Y)}}function l(D,Y){(Y==null||Y>D.length)&&(Y=D.length);for(var re=0,ae=new Array(Y);re<Y;re++)ae[re]=D[re];return ae}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=Object.hasOwnProperty,u=Object.setPrototypeOf,d=Object.isFrozen,p=Object.getPrototypeOf,_=Object.getOwnPropertyDescriptor,g=Object.freeze,y=Object.seal,v=Object.create,w=typeof Reflect<"u"&&Reflect,S=w.apply,x=w.construct;S||(S=function(Y,re,ae){return Y.apply(re,ae)}),g||(g=function(Y){return Y}),y||(y=function(Y){return Y}),x||(x=function(Y,re){return i(Y,r(re))});var P=M(Array.prototype.forEach),F=M(Array.prototype.pop),C=M(Array.prototype.push),B=M(String.prototype.toLowerCase),G=M(String.prototype.match),T=M(String.prototype.replace),L=M(String.prototype.indexOf),f=M(String.prototype.trim),I=M(RegExp.prototype.test),q=Q(TypeError);function M(D){return function(Y){for(var re=arguments.length,ae=new Array(re>1?re-1:0),Te=1;Te<re;Te++)ae[Te-1]=arguments[Te];return S(D,Y,ae)}}function Q(D){return function(){for(var Y=arguments.length,re=new Array(Y),ae=0;ae<Y;ae++)re[ae]=arguments[ae];return x(D,re)}}function b(D,Y){u&&u(D,null);for(var re=Y.length;re--;){var ae=Y[re];if(typeof ae=="string"){var Te=B(ae);Te!==ae&&(d(Y)||(Y[re]=Te),ae=Te)}D[ae]=!0}return D}function W(D){var Y=v(null),re;for(re in D)S(h,D,[re])&&(Y[re]=D[re]);return Y}function O(D,Y){for(;D!==null;){var re=_(D,Y);if(re){if(re.get)return M(re.get);if(typeof re.value=="function")return M(re.value)}D=p(D)}function ae(Te){return console.warn("fallback value for",Te),null}return ae}var R=g(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ee=g(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),te=g(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ne=g(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ve=g(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Ie=g(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_e=g(["#text"]),pe=g(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ae=g(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),xe=g(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),qe=g(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),rt=y(/\{\{[\w\W]*|[\w\W]*\}\}/gm),m=y(/<%[\w\W]*|[\w\W]*%>/gm),J=y(/^data-[\-\w.\u00B7-\uFFFF]/),j=y(/^aria-[\-\w]+$/),A=y(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),E=y(/^(?:\w+script|data):/i),z=y(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=y(/^html$/i),K=function(){return typeof window>"u"?null:window},H=function(Y,re){if(t(Y)!=="object"||typeof Y.createPolicy!="function")return null;var ae=null,Te="data-tt-policy-suffix";re.currentScript&&re.currentScript.hasAttribute(Te)&&(ae=re.currentScript.getAttribute(Te));var Ke="dompurify"+(ae?"#"+ae:"");try{return Y.createPolicy(Ke,{createHTML:function(k){return k}})}catch{return console.warn("TrustedTypes policy "+Ke+" could not be created."),null}};function Z(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:K(),Y=function(V){return Z(V)};if(Y.version="2.3.8",Y.removed=[],!D||!D.document||D.document.nodeType!==9)return Y.isSupported=!1,Y;var re=D.document,ae=D.document,Te=D.DocumentFragment,Ke=D.HTMLTemplateElement,Ye=D.Node,k=D.Element,U=D.NodeFilter,N=D.NamedNodeMap,se=N===void 0?D.NamedNodeMap||D.MozNamedAttrMap:N,le=D.HTMLFormElement,ye=D.DOMParser,Pe=D.trustedTypes,Re=k.prototype,Ee=O(Re,"cloneNode"),et=O(Re,"nextSibling"),dt=O(Re,"childNodes"),tt=O(Re,"parentNode");if(typeof Ke=="function"){var Ar=ae.createElement("template");Ar.content&&Ar.content.ownerDocument&&(ae=Ar.content.ownerDocument)}var wn=H(Pe,re),Qn=wn?wn.createHTML(""):"",Sn=ae,xs=Sn.implementation,vc=Sn.createNodeIterator,Pr=Sn.createDocumentFragment,ha=Sn.getElementsByTagName,yc=re.importNode,Rr={};try{Rr=W(ae).documentMode?ae.documentMode:{}}catch{}var _t={};Y.isSupported=typeof tt=="function"&&xs&&typeof xs.createHTMLDocument<"u"&&Rr!==9;var ei=rt,ln=m,ji=J,ti=j,Ei=E,fa=z,cn=A,Ze=null,qi=b({},[].concat(r(R),r(ee),r(te),r(ve),r(_e))),ht=null,Os=b({},[].concat(r(pe),r(Ae),r(xe),r(qe))),st=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),En=null,Ds=null,Ms=!0,Ki=!0,Nr=!1,ni=!1,Mn=!1,Yi=!1,xr=!1,ii=!1,un=!1,Or=!1,Ln=!0,vt=!0,ri=!1,qt={},Kt=null,Ls=b({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),si=null,dn=b({},["audio","video","img","source","image","track"]),$s=null,pa=b({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Fs="http://www.w3.org/1998/Math/MathML",Dr="http://www.w3.org/2000/svg",$n="http://www.w3.org/1999/xhtml",oi=$n,ue=!1,de,Se=["application/xhtml+xml","text/html"],he="text/html",$e,it=null,Mr=ae.createElement("form"),Ci=function(V){return V instanceof RegExp||V instanceof Function},ai=function(V){it&&it===V||((!V||t(V)!=="object")&&(V={}),V=W(V),Ze="ALLOWED_TAGS"in V?b({},V.ALLOWED_TAGS):qi,ht="ALLOWED_ATTR"in V?b({},V.ALLOWED_ATTR):Os,$s="ADD_URI_SAFE_ATTR"in V?b(W(pa),V.ADD_URI_SAFE_ATTR):pa,si="ADD_DATA_URI_TAGS"in V?b(W(dn),V.ADD_DATA_URI_TAGS):dn,Kt="FORBID_CONTENTS"in V?b({},V.FORBID_CONTENTS):Ls,En="FORBID_TAGS"in V?b({},V.FORBID_TAGS):{},Ds="FORBID_ATTR"in V?b({},V.FORBID_ATTR):{},qt="USE_PROFILES"in V?V.USE_PROFILES:!1,Ms=V.ALLOW_ARIA_ATTR!==!1,Ki=V.ALLOW_DATA_ATTR!==!1,Nr=V.ALLOW_UNKNOWN_PROTOCOLS||!1,ni=V.SAFE_FOR_TEMPLATES||!1,Mn=V.WHOLE_DOCUMENT||!1,ii=V.RETURN_DOM||!1,un=V.RETURN_DOM_FRAGMENT||!1,Or=V.RETURN_TRUSTED_TYPE||!1,xr=V.FORCE_BODY||!1,Ln=V.SANITIZE_DOM!==!1,vt=V.KEEP_CONTENT!==!1,ri=V.IN_PLACE||!1,cn=V.ALLOWED_URI_REGEXP||cn,oi=V.NAMESPACE||$n,V.CUSTOM_ELEMENT_HANDLING&&Ci(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(st.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&Ci(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(st.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(st.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),de=Se.indexOf(V.PARSER_MEDIA_TYPE)===-1?de=he:de=V.PARSER_MEDIA_TYPE,$e=de==="application/xhtml+xml"?function(ie){return ie}:B,ni&&(Ki=!1),un&&(ii=!0),qt&&(Ze=b({},r(_e)),ht=[],qt.html===!0&&(b(Ze,R),b(ht,pe)),qt.svg===!0&&(b(Ze,ee),b(ht,Ae),b(ht,qe)),qt.svgFilters===!0&&(b(Ze,te),b(ht,Ae),b(ht,qe)),qt.mathMl===!0&&(b(Ze,ve),b(ht,xe),b(ht,qe))),V.ADD_TAGS&&(Ze===qi&&(Ze=W(Ze)),b(Ze,V.ADD_TAGS)),V.ADD_ATTR&&(ht===Os&&(ht=W(ht)),b(ht,V.ADD_ATTR)),V.ADD_URI_SAFE_ATTR&&b($s,V.ADD_URI_SAFE_ATTR),V.FORBID_CONTENTS&&(Kt===Ls&&(Kt=W(Kt)),b(Kt,V.FORBID_CONTENTS)),vt&&(Ze["#text"]=!0),Mn&&b(Ze,["html","head","body"]),Ze.table&&(b(Ze,["tbody"]),delete En.tbody),g&&g(V),it=V)},ma=b({},["mi","mo","mn","ms","mtext"]),ga=b({},["foreignobject","desc","title","annotation-xml"]),ab=b({},["title","style","font","a","script"]),_a=b({},ee);b(_a,te),b(_a,ne);var bc=b({},ve);b(bc,Ie);var lb=function(V){var ie=tt(V);(!ie||!ie.tagName)&&(ie={namespaceURI:$n,tagName:"template"});var fe=B(V.tagName),He=B(ie.tagName);return V.namespaceURI===Dr?ie.namespaceURI===$n?fe==="svg":ie.namespaceURI===Fs?fe==="svg"&&(He==="annotation-xml"||ma[He]):Boolean(_a[fe]):V.namespaceURI===Fs?ie.namespaceURI===$n?fe==="math":ie.namespaceURI===Dr?fe==="math"&&ga[He]:Boolean(bc[fe]):V.namespaceURI===$n?ie.namespaceURI===Dr&&!ga[He]||ie.namespaceURI===Fs&&!ma[He]?!1:!bc[fe]&&(ab[fe]||!_a[fe]):!1},li=function(V){C(Y.removed,{element:V});try{V.parentNode.removeChild(V)}catch{try{V.outerHTML=Qn}catch{V.remove()}}},Bf=function(V,ie){try{C(Y.removed,{attribute:ie.getAttributeNode(V),from:ie})}catch{C(Y.removed,{attribute:null,from:ie})}if(ie.removeAttribute(V),V==="is"&&!ht[V])if(ii||un)try{li(ie)}catch{}else try{ie.setAttribute(V,"")}catch{}},zf=function(V){var ie,fe;if(xr)V="<remove></remove>"+V;else{var He=G(V,/^[\r\n\t ]+/);fe=He&&He[0]}de==="application/xhtml+xml"&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");var Ft=wn?wn.createHTML(V):V;if(oi===$n)try{ie=new ye().parseFromString(Ft,de)}catch{}if(!ie||!ie.documentElement){ie=xs.createDocument(oi,"template",null);try{ie.documentElement.innerHTML=ue?"":Ft}catch{}}var Tt=ie.body||ie.documentElement;return V&&fe&&Tt.insertBefore(ae.createTextNode(fe),Tt.childNodes[0]||null),oi===$n?ha.call(ie,Mn?"html":"body")[0]:Mn?ie.documentElement:Tt},Vf=function(V){return vc.call(V.ownerDocument||V,V,U.SHOW_ELEMENT|U.SHOW_COMMENT|U.SHOW_TEXT,null,!1)},cb=function(V){return V instanceof le&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof se)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function")},Us=function(V){return t(Ye)==="object"?V instanceof Ye:V&&t(V)==="object"&&typeof V.nodeType=="number"&&typeof V.nodeName=="string"},ci=function(V,ie,fe){!_t[V]||P(_t[V],function(He){He.call(Y,ie,fe,it)})},Wf=function(V){var ie;if(ci("beforeSanitizeElements",V,null),cb(V)||I(/[\u0080-\uFFFF]/,V.nodeName))return li(V),!0;var fe=$e(V.nodeName);if(ci("uponSanitizeElement",V,{tagName:fe,allowedTags:Ze}),V.hasChildNodes()&&!Us(V.firstElementChild)&&(!Us(V.content)||!Us(V.content.firstElementChild))&&I(/<[/\w]/g,V.innerHTML)&&I(/<[/\w]/g,V.textContent)||fe==="select"&&I(/<template/i,V.innerHTML))return li(V),!0;if(!Ze[fe]||En[fe]){if(!En[fe]&&Gf(fe)&&(st.tagNameCheck instanceof RegExp&&I(st.tagNameCheck,fe)||st.tagNameCheck instanceof Function&&st.tagNameCheck(fe)))return!1;if(vt&&!Kt[fe]){var He=tt(V)||V.parentNode,Ft=dt(V)||V.childNodes;if(Ft&&He)for(var Tt=Ft.length,yt=Tt-1;yt>=0;--yt)He.insertBefore(Ee(Ft[yt],!0),et(V))}return li(V),!0}return V instanceof k&&!lb(V)||(fe==="noscript"||fe==="noembed")&&I(/<\/no(script|embed)/i,V.innerHTML)?(li(V),!0):(ni&&V.nodeType===3&&(ie=V.textContent,ie=T(ie,ei," "),ie=T(ie,ln," "),V.textContent!==ie&&(C(Y.removed,{element:V.cloneNode()}),V.textContent=ie)),ci("afterSanitizeElements",V,null),!1)},Hf=function(V,ie,fe){if(Ln&&(ie==="id"||ie==="name")&&(fe in ae||fe in Mr))return!1;if(!(Ki&&!Ds[ie]&&I(ji,ie))){if(!(Ms&&I(ti,ie))){if(!ht[ie]||Ds[ie]){if(!(Gf(V)&&(st.tagNameCheck instanceof RegExp&&I(st.tagNameCheck,V)||st.tagNameCheck instanceof Function&&st.tagNameCheck(V))&&(st.attributeNameCheck instanceof RegExp&&I(st.attributeNameCheck,ie)||st.attributeNameCheck instanceof Function&&st.attributeNameCheck(ie))||ie==="is"&&st.allowCustomizedBuiltInElements&&(st.tagNameCheck instanceof RegExp&&I(st.tagNameCheck,fe)||st.tagNameCheck instanceof Function&&st.tagNameCheck(fe))))return!1}else if(!$s[ie]){if(!I(cn,T(fe,fa,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&V!=="script"&&L(fe,"data:")===0&&si[V])){if(!(Nr&&!I(Ei,T(fe,fa,"")))){if(fe)return!1}}}}}}return!0},Gf=function(V){return V.indexOf("-")>0},jf=function(V){var ie,fe,He,Ft;ci("beforeSanitizeAttributes",V,null);var Tt=V.attributes;if(!!Tt){var yt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ht};for(Ft=Tt.length;Ft--;){ie=Tt[Ft];var va=ie,Rt=va.name,qf=va.namespaceURI;if(fe=Rt==="value"?ie.value:f(ie.value),He=$e(Rt),yt.attrName=He,yt.attrValue=fe,yt.keepAttr=!0,yt.forceKeepAttr=void 0,ci("uponSanitizeAttribute",V,yt),fe=yt.attrValue,!yt.forceKeepAttr&&(Bf(Rt,V),!!yt.keepAttr)){if(I(/\/>/i,fe)){Bf(Rt,V);continue}ni&&(fe=T(fe,ei," "),fe=T(fe,ln," "));var db=$e(V.nodeName);if(!!Hf(db,He,fe))try{qf?V.setAttributeNS(qf,Rt,fe):V.setAttribute(Rt,fe),F(Y.removed)}catch{}}}ci("afterSanitizeAttributes",V,null)}},ub=function ge(V){var ie,fe=Vf(V);for(ci("beforeSanitizeShadowDOM",V,null);ie=fe.nextNode();)ci("uponSanitizeShadowNode",ie,null),!Wf(ie)&&(ie.content instanceof Te&&ge(ie.content),jf(ie));ci("afterSanitizeShadowDOM",V,null)};return Y.sanitize=function(ge,V){var ie,fe,He,Ft,Tt;if(ue=!ge,ue&&(ge="<!-->"),typeof ge!="string"&&!Us(ge)){if(typeof ge.toString!="function")throw q("toString is not a function");if(ge=ge.toString(),typeof ge!="string")throw q("dirty is not a string, aborting")}if(!Y.isSupported){if(t(D.toStaticHTML)==="object"||typeof D.toStaticHTML=="function"){if(typeof ge=="string")return D.toStaticHTML(ge);if(Us(ge))return D.toStaticHTML(ge.outerHTML)}return ge}if(Yi||ai(V),Y.removed=[],typeof ge=="string"&&(ri=!1),ri){if(ge.nodeName){var yt=$e(ge.nodeName);if(!Ze[yt]||En[yt])throw q("root node is forbidden and cannot be sanitized in-place")}}else if(ge instanceof Ye)ie=zf("<!---->"),fe=ie.ownerDocument.importNode(ge,!0),fe.nodeType===1&&fe.nodeName==="BODY"||fe.nodeName==="HTML"?ie=fe:ie.appendChild(fe);else{if(!ii&&!ni&&!Mn&&ge.indexOf("<")===-1)return wn&&Or?wn.createHTML(ge):ge;if(ie=zf(ge),!ie)return ii?null:Or?Qn:""}ie&&xr&&li(ie.firstChild);for(var va=Vf(ri?ge:ie);He=va.nextNode();)He.nodeType===3&&He===Ft||Wf(He)||(He.content instanceof Te&&ub(He.content),jf(He),Ft=He);if(Ft=null,ri)return ge;if(ii){if(un)for(Tt=Pr.call(ie.ownerDocument);ie.firstChild;)Tt.appendChild(ie.firstChild);else Tt=ie;return ht.shadowroot&&(Tt=yc.call(re,Tt,!0)),Tt}var Rt=Mn?ie.outerHTML:ie.innerHTML;return Mn&&Ze["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&I(X,ie.ownerDocument.doctype.name)&&(Rt="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+Rt),ni&&(Rt=T(Rt,ei," "),Rt=T(Rt,ln," ")),wn&&Or?wn.createHTML(Rt):Rt},Y.setConfig=function(ge){ai(ge),Yi=!0},Y.clearConfig=function(){it=null,Yi=!1},Y.isValidAttribute=function(ge,V,ie){it||ai({});var fe=$e(ge),He=$e(V);return Hf(fe,He,ie)},Y.addHook=function(ge,V){typeof V=="function"&&(_t[ge]=_t[ge]||[],C(_t[ge],V))},Y.removeHook=function(ge){if(_t[ge])return F(_t[ge])},Y.removeHooks=function(ge){_t[ge]&&(_t[ge]=[])},Y.removeAllHooks=function(){_t={}},Y}var ce=Z();return ce})});var jg=zs((dA,ml)=>{var Tg,Ig,kg,Ag,Pg,Rg,Ng,xg,Og,fl,_d,Dg,Mg,Lg,cs,$g,Fg,Ug,Bg,zg,Vg,Wg,Hg,Gg,pl;(function(t){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(i){t(n(e,n(i)))}):typeof ml=="object"&&typeof ml.exports=="object"?t(n(e,n(ml.exports))):t(n(e));function n(i,r){return i!==e&&(typeof Object.create=="function"?Object.defineProperty(i,"__esModule",{value:!0}):i.__esModule=!0),function(s,o){return i[s]=r?r(s,o):o}}})(function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(i[s]=r[s])};Tg=function(i,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(i,r);function s(){this.constructor=i}i.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)},Ig=Object.assign||function(i){for(var r,s=1,o=arguments.length;s<o;s++){r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])}return i},kg=function(i,r){var s={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&r.indexOf(o)<0&&(s[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(i);a<o.length;a++)r.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(i,o[a])&&(s[o[a]]=i[o[a]]);return s},Ag=function(i,r,s,o){var a=arguments.length,l=a<3?r:o===null?o=Object.getOwnPropertyDescriptor(r,s):o,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(i,r,s,o);else for(var h=i.length-1;h>=0;h--)(c=i[h])&&(l=(a<3?c(l):a>3?c(r,s,l):c(r,s))||l);return a>3&&l&&Object.defineProperty(r,s,l),l},Pg=function(i,r){return function(s,o){r(s,o,i)}},Rg=function(i,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,r)},Ng=function(i,r,s,o){function a(l){return l instanceof s?l:new s(function(c){c(l)})}return new(s||(s=Promise))(function(l,c){function h(p){try{d(o.next(p))}catch(_){c(_)}}function u(p){try{d(o.throw(p))}catch(_){c(_)}}function d(p){p.done?l(p.value):a(p.value).then(h,u)}d((o=o.apply(i,r||[])).next())})},xg=function(i,r){var s={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},o,a,l,c;return c={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(d){return function(p){return u([d,p])}}function u(d){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(l=d[0]&2?a.return:d[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,d[1])).done)return l;switch(a=0,l&&(d=[d[0]&2,l.value]),d[0]){case 0:case 1:l=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,a=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(l=s.trys,!(l=l.length>0&&l[l.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!l||d[1]>l[0]&&d[1]<l[3])){s.label=d[1];break}if(d[0]===6&&s.label<l[1]){s.label=l[1],l=d;break}if(l&&s.label<l[2]){s.label=l[2],s.ops.push(d);break}l[2]&&s.ops.pop(),s.trys.pop();continue}d=r.call(i,s)}catch(p){d=[6,p],a=0}finally{o=l=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},Og=function(i,r){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(r,s)&&pl(r,i,s)},pl=Object.create?function(i,r,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(r,s);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[s]}}),Object.defineProperty(i,o,a)}:function(i,r,s,o){o===void 0&&(o=s),i[o]=r[s]},fl=function(i){var r=typeof Symbol=="function"&&Symbol.iterator,s=r&&i[r],o=0;if(s)return s.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&o>=i.length&&(i=void 0),{value:i&&i[o++],done:!i}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},_d=function(i,r){var s=typeof Symbol=="function"&&i[Symbol.iterator];if(!s)return i;var o=s.call(i),a,l=[],c;try{for(;(r===void 0||r-- >0)&&!(a=o.next()).done;)l.push(a.value)}catch(h){c={error:h}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(c)throw c.error}}return l},Dg=function(){for(var i=[],r=0;r<arguments.length;r++)i=i.concat(_d(arguments[r]));return i},Mg=function(){for(var i=0,r=0,s=arguments.length;r<s;r++)i+=arguments[r].length;for(var o=Array(i),a=0,r=0;r<s;r++)for(var l=arguments[r],c=0,h=l.length;c<h;c++,a++)o[a]=l[c];return o},Lg=function(i,r,s){if(s||arguments.length===2)for(var o=0,a=r.length,l;o<a;o++)(l||!(o in r))&&(l||(l=Array.prototype.slice.call(r,0,o)),l[o]=r[o]);return i.concat(l||Array.prototype.slice.call(r))},cs=function(i){return this instanceof cs?(this.v=i,this):new cs(i)},$g=function(i,r,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=s.apply(i,r||[]),a,l=[];return a={},c("next"),c("throw"),c("return"),a[Symbol.asyncIterator]=function(){return this},a;function c(g){o[g]&&(a[g]=function(y){return new Promise(function(v,w){l.push([g,y,v,w])>1||h(g,y)})})}function h(g,y){try{u(o[g](y))}catch(v){_(l[0][3],v)}}function u(g){g.value instanceof cs?Promise.resolve(g.value.v).then(d,p):_(l[0][2],g)}function d(g){h("next",g)}function p(g){h("throw",g)}function _(g,y){g(y),l.shift(),l.length&&h(l[0][0],l[0][1])}},Fg=function(i){var r,s;return r={},o("next"),o("throw",function(a){throw a}),o("return"),r[Symbol.iterator]=function(){return this},r;function o(a,l){r[a]=i[a]?function(c){return(s=!s)?{value:cs(i[a](c)),done:a==="return"}:l?l(c):c}:l}},Ug=function(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=i[Symbol.asyncIterator],s;return r?r.call(i):(i=typeof fl=="function"?fl(i):i[Symbol.iterator](),s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s);function o(l){s[l]=i[l]&&function(c){return new Promise(function(h,u){c=i[l](c),a(h,u,c.done,c.value)})}}function a(l,c,h,u){Promise.resolve(u).then(function(d){l({value:d,done:h})},c)}},Bg=function(i,r){return Object.defineProperty?Object.defineProperty(i,"raw",{value:r}):i.raw=r,i};var n=Object.create?function(i,r){Object.defineProperty(i,"default",{enumerable:!0,value:r})}:function(i,r){i.default=r};zg=function(i){if(i&&i.__esModule)return i;var r={};if(i!=null)for(var s in i)s!=="default"&&Object.prototype.hasOwnProperty.call(i,s)&&pl(r,i,s);return n(r,i),r},Vg=function(i){return i&&i.__esModule?i:{default:i}},Wg=function(i,r,s,o){if(s==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?i!==r||!o:!r.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?o:s==="a"?o.call(i):o?o.value:r.get(i)},Hg=function(i,r,s,o,a){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?i!==r||!a:!r.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?a.call(i,s):a?a.value=s:r.set(i,s),s},Gg=function(i,r){if(r===null||typeof r!="object"&&typeof r!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof i=="function"?r===i:i.has(r)},t("__extends",Tg),t("__assign",Ig),t("__rest",kg),t("__decorate",Ag),t("__param",Pg),t("__metadata",Rg),t("__awaiter",Ng),t("__generator",xg),t("__exportStar",Og),t("__createBinding",pl),t("__values",fl),t("__read",_d),t("__spread",Dg),t("__spreadArrays",Mg),t("__spreadArray",Lg),t("__await",cs),t("__asyncGenerator",$g),t("__asyncDelegator",Fg),t("__asyncValues",Ug),t("__makeTemplateObject",Bg),t("__importStar",zg),t("__importDefault",Vg),t("__classPrivateFieldGet",Wg),t("__classPrivateFieldSet",Hg),t("__classPrivateFieldIn",Gg)})});var Sy=zs((wy,cf)=>{(function(t){typeof wy=="object"&&typeof cf<"u"?cf.exports=t():typeof define=="function"&&define.amd?define([],t):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=t()})(function(){return function t(e,n,i){function r(a,l){if(!n[a]){if(!e[a]){var c=typeof Bs=="function"&&Bs;if(!l&&c)return c(a,!0);if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(d){var p=e[a][1][d];return r(p||d)},u,u.exports,t,e,n,i)}return n[a].exports}for(var s=typeof Bs=="function"&&Bs,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){"use strict";var i=t("./utils"),r=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(o){for(var a,l,c,h,u,d,p,_=[],g=0,y=o.length,v=y,w=i.getTypeOf(o)!=="string";g<o.length;)v=y-g,c=w?(a=o[g++],l=g<y?o[g++]:0,g<y?o[g++]:0):(a=o.charCodeAt(g++),l=g<y?o.charCodeAt(g++):0,g<y?o.charCodeAt(g++):0),h=a>>2,u=(3&a)<<4|l>>4,d=1<v?(15&l)<<2|c>>6:64,p=2<v?63&c:64,_.push(s.charAt(h)+s.charAt(u)+s.charAt(d)+s.charAt(p));return _.join("")},n.decode=function(o){var a,l,c,h,u,d,p=0,_=0,g="data:";if(o.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var y,v=3*(o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(o.charAt(o.length-1)===s.charAt(64)&&v--,o.charAt(o.length-2)===s.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=r.uint8array?new Uint8Array(0|v):new Array(0|v);p<o.length;)a=s.indexOf(o.charAt(p++))<<2|(h=s.indexOf(o.charAt(p++)))>>4,l=(15&h)<<4|(u=s.indexOf(o.charAt(p++)))>>2,c=(3&u)<<6|(d=s.indexOf(o.charAt(p++))),y[_++]=a,u!==64&&(y[_++]=l),d!==64&&(y[_++]=c);return y}},{"./support":30,"./utils":32}],2:[function(t,e,n){"use strict";var i=t("./external"),r=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),o=t("./stream/DataLengthProbe");function a(l,c,h,u,d){this.compressedSize=l,this.uncompressedSize=c,this.crc32=h,this.compression=u,this.compressedContent=d}a.prototype={getContentWorker:function(){var l=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),c=this;return l.on("end",function(){if(this.streamInfo.data_length!==c.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),l},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(l,c,h){return l.pipe(new s).pipe(new o("uncompressedSize")).pipe(c.compressWorker(h)).pipe(new o("compressedSize")).withStreamInfo("compression",c)},e.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,n){"use strict";var i=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(r){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,n){"use strict";var i=t("./utils"),r=function(){for(var s,o=[],a=0;a<256;a++){s=a;for(var l=0;l<8;l++)s=1&s?3988292384^s>>>1:s>>>1;o[a]=s}return o}();e.exports=function(s,o){return s!==void 0&&s.length?i.getTypeOf(s)!=="string"?function(a,l,c,h){var u=r,d=h+c;a^=-1;for(var p=h;p<d;p++)a=a>>>8^u[255&(a^l[p])];return-1^a}(0|o,s,s.length,0):function(a,l,c,h){var u=r,d=h+c;a^=-1;for(var p=h;p<d;p++)a=a>>>8^u[255&(a^l.charCodeAt(p))];return-1^a}(0|o,s,s.length,0):0}},{"./utils":32}],5:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,e,n){"use strict";var i=null;i=typeof Promise<"u"?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,n){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=t("pako"),s=t("./utils"),o=t("./stream/GenericWorker"),a=i?"uint8array":"array";function l(c,h){o.call(this,"FlateWorker/"+c),this._pako=null,this._pakoAction=c,this._pakoOptions=h,this.meta={}}n.magic="\b\0",s.inherits(l,o),l.prototype.processChunk=function(c){this.meta=c.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(a,c.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var c=this;this._pako.onData=function(h){c.push({data:h,meta:c.meta})}},n.compressWorker=function(c){return new l("Deflate",c)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,n){"use strict";function i(u,d){var p,_="";for(p=0;p<d;p++)_+=String.fromCharCode(255&u),u>>>=8;return _}function r(u,d,p,_,g,y){var v,w,S=u.file,x=u.compression,P=y!==a.utf8encode,F=s.transformTo("string",y(S.name)),C=s.transformTo("string",a.utf8encode(S.name)),B=S.comment,G=s.transformTo("string",y(B)),T=s.transformTo("string",a.utf8encode(B)),L=C.length!==S.name.length,f=T.length!==B.length,I="",q="",M="",Q=S.dir,b=S.date,W={crc32:0,compressedSize:0,uncompressedSize:0};d&&!p||(W.crc32=u.crc32,W.compressedSize=u.compressedSize,W.uncompressedSize=u.uncompressedSize);var O=0;d&&(O|=8),P||!L&&!f||(O|=2048);var R=0,ee=0;Q&&(R|=16),g==="UNIX"?(ee=798,R|=function(ne,ve){var Ie=ne;return ne||(Ie=ve?16893:33204),(65535&Ie)<<16}(S.unixPermissions,Q)):(ee=20,R|=function(ne){return 63&(ne||0)}(S.dosPermissions)),v=b.getUTCHours(),v<<=6,v|=b.getUTCMinutes(),v<<=5,v|=b.getUTCSeconds()/2,w=b.getUTCFullYear()-1980,w<<=4,w|=b.getUTCMonth()+1,w<<=5,w|=b.getUTCDate(),L&&(q=i(1,1)+i(l(F),4)+C,I+="up"+i(q.length,2)+q),f&&(M=i(1,1)+i(l(G),4)+T,I+="uc"+i(M.length,2)+M);var te="";return te+=`
\0`,te+=i(O,2),te+=x.magic,te+=i(v,2),te+=i(w,2),te+=i(W.crc32,4),te+=i(W.compressedSize,4),te+=i(W.uncompressedSize,4),te+=i(F.length,2),te+=i(I.length,2),{fileRecord:c.LOCAL_FILE_HEADER+te+F+I,dirRecord:c.CENTRAL_FILE_HEADER+i(ee,2)+te+i(G.length,2)+"\0\0\0\0"+i(R,4)+i(_,4)+F+I+G}}var s=t("../utils"),o=t("../stream/GenericWorker"),a=t("../utf8"),l=t("../crc32"),c=t("../signature");function h(u,d,p,_){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=d,this.zipPlatform=p,this.encodeFileName=_,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(h,o),h.prototype.push=function(u){var d=u.meta.percent||0,p=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,o.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:p?(d+100*(p-_-1))/p:100}}))},h.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var d=this.streamFiles&&!u.file.dir;if(d){var p=r(u,d,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(u){this.accumulate=!1;var d=this.streamFiles&&!u.file.dir,p=r(u,d,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),d)this.push({data:function(_){return c.DATA_DESCRIPTOR+i(_.crc32,4)+i(_.compressedSize,4)+i(_.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var u=this.bytesWritten,d=0;d<this.dirRecords.length;d++)this.push({data:this.dirRecords[d],meta:{percent:100}});var p=this.bytesWritten-u,_=function(g,y,v,w,S){var x=s.transformTo("string",S(w));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(y,4)+i(v,4)+i(x.length,2)+x}(this.dirRecords.length,p,u,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(u){this._sources.push(u);var d=this;return u.on("data",function(p){d.processChunk(p)}),u.on("end",function(){d.closedSource(d.previous.streamInfo),d._sources.length?d.prepareNextSource():d.end()}),u.on("error",function(p){d.error(p)}),this},h.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(u){var d=this._sources;if(!o.prototype.error.call(this,u))return!1;for(var p=0;p<d.length;p++)try{d[p].error(u)}catch{}return!0},h.prototype.lock=function(){o.prototype.lock.call(this);for(var u=this._sources,d=0;d<u.length;d++)u[d].lock()},e.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,n){"use strict";var i=t("../compressions"),r=t("./ZipFileWorker");n.generateWorker=function(s,o,a){var l=new r(o.streamFiles,a,o.platform,o.encodeFileName),c=0;try{s.forEach(function(h,u){c++;var d=function(y,v){var w=y||v,S=i[w];if(!S)throw new Error(w+" is not a valid compression method !");return S}(u.options.compression,o.compression),p=u.options.compressionOptions||o.compressionOptions||{},_=u.dir,g=u.date;u._compressWorker(d,p).withStreamInfo("file",{name:h,dir:_,date:g,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(l)}),l.entriesCount=c}catch(h){l.error(h)}return l}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new i;for(var s in this)typeof this[s]!="function"&&(r[s]=this[s]);return r}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.0",i.loadAsync=function(r,s){return new i().loadAsync(r,s)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,n){"use strict";var i=t("./utils"),r=t("./external"),s=t("./utf8"),o=t("./zipEntries"),a=t("./stream/Crc32Probe"),l=t("./nodejsUtils");function c(h){return new r.Promise(function(u,d){var p=h.decompressed.getContentWorker().pipe(new a);p.on("error",function(_){d(_)}).on("end",function(){p.streamInfo.crc32!==h.decompressed.crc32?d(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}e.exports=function(h,u){var d=this;return u=i.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(h)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,u.optimizedBinaryString,u.base64).then(function(p){var _=new o(u);return _.load(p),_}).then(function(p){var _=[r.Promise.resolve(p)],g=p.files;if(u.checkCRC32)for(var y=0;y<g.length;y++)_.push(c(g[y]));return r.Promise.all(_)}).then(function(p){for(var _=p.shift(),g=_.files,y=0;y<g.length;y++){var v=g[y],w=v.fileNameStr,S=i.resolve(v.fileNameStr);d.file(S,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:u.createFolders}),v.dir||(d.file(S).unsafeOriginalName=w)}return _.zipComment.length&&(d.comment=_.zipComment),d})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,n){"use strict";var i=t("../utils"),r=t("../stream/GenericWorker");function s(o,a){r.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(a)}i.inherits(s,r),s.prototype._bindStream=function(o){var a=this;(this._stream=o).pause(),o.on("data",function(l){a.push({data:l,meta:{percent:0}})}).on("error",function(l){a.isPaused?this.generatedError=l:a.error(l)}).on("end",function(){a.isPaused?a._upstreamEnded=!0:a.end()})},s.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,n){"use strict";var i=t("readable-stream").Readable;function r(s,o,a){i.call(this,o),this._helper=s;var l=this;s.on("data",function(c,h){l.push(c)||l._helper.pause(),a&&a(h)}).on("error",function(c){l.emit("error",c)}).on("end",function(){l.push(null)})}t("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},e.exports=r},{"../utils":32,"readable-stream":16}],14:[function(t,e,n){"use strict";e.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,r);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,r)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var r=new Buffer(i);return r.fill(0),r},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,e,n){"use strict";function i(S,x,P){var F,C=s.getTypeOf(x),B=s.extend(P||{},l);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(S=g(S)),B.createFolders&&(F=_(S))&&y.call(this,F,!0);var G=C==="string"&&B.binary===!1&&B.base64===!1;P&&P.binary!==void 0||(B.binary=!G),(x instanceof c&&x.uncompressedSize===0||B.dir||!x||x.length===0)&&(B.base64=!1,B.binary=!0,x="",B.compression="STORE",C="string");var T=null;T=x instanceof c||x instanceof o?x:d.isNode&&d.isStream(x)?new p(S,x):s.prepareContent(S,x,B.binary,B.optimizedBinaryString,B.base64);var L=new h(S,T,B);this.files[S]=L}var r=t("./utf8"),s=t("./utils"),o=t("./stream/GenericWorker"),a=t("./stream/StreamHelper"),l=t("./defaults"),c=t("./compressedObject"),h=t("./zipObject"),u=t("./generate"),d=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),_=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var x=S.lastIndexOf("/");return 0<x?S.substring(0,x):""},g=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},y=function(S,x){return x=x!==void 0?x:l.createFolders,S=g(S),this.files[S]||i.call(this,S,null,{dir:!0,createFolders:x}),this.files[S]};function v(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var x,P,F;for(x in this.files)F=this.files[x],(P=x.slice(this.root.length,x.length))&&x.slice(0,this.root.length)===this.root&&S(P,F)},filter:function(S){var x=[];return this.forEach(function(P,F){S(P,F)&&x.push(F)}),x},file:function(S,x,P){if(arguments.length!==1)return S=this.root+S,i.call(this,S,x,P),this;if(v(S)){var F=S;return this.filter(function(B,G){return!G.dir&&F.test(B)})}var C=this.files[this.root+S];return C&&!C.dir?C:null},folder:function(S){if(!S)return this;if(v(S))return this.filter(function(C,B){return B.dir&&S.test(C)});var x=this.root+S,P=y.call(this,x),F=this.clone();return F.root=P.name,F},remove:function(S){S=this.root+S;var x=this.files[S];if(x||(S.slice(-1)!=="/"&&(S+="/"),x=this.files[S]),x&&!x.dir)delete this.files[S];else for(var P=this.filter(function(C,B){return B.name.slice(0,S.length)===S}),F=0;F<P.length;F++)delete this.files[P[F].name];return this},generate:function(S){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var x,P={};try{if((P=s.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");s.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var F=P.comment||this.comment||"";x=u.generateWorker(this,P,F)}catch(C){(x=new o("error")).error(C)}return new a(x,P.type||"string",P.mimeType)},generateAsync:function(S,x){return this.generateInternalStream(S).accumulate(x)},generateNodeStream:function(S,x){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(x)}};e.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,n){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,n){"use strict";var i=t("./DataReader");function r(s){i.call(this,s);for(var o=0;o<this.data.length;o++)s[o]=255&s[o]}t("../utils").inherits(r,i),r.prototype.byteAt=function(s){return this.data[this.zero+s]},r.prototype.lastIndexOfSignature=function(s){for(var o=s.charCodeAt(0),a=s.charCodeAt(1),l=s.charCodeAt(2),c=s.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===o&&this.data[h+1]===a&&this.data[h+2]===l&&this.data[h+3]===c)return h-this.zero;return-1},r.prototype.readAndCheckSignature=function(s){var o=s.charCodeAt(0),a=s.charCodeAt(1),l=s.charCodeAt(2),c=s.charCodeAt(3),h=this.readData(4);return o===h[0]&&a===h[1]&&l===h[2]&&c===h[3]},r.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=r},{"../utils":32,"./DataReader":18}],18:[function(t,e,n){"use strict";var i=t("../utils");function r(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(s){},readInt:function(s){var o,a=0;for(this.checkOffset(s),o=this.index+s-1;o>=this.index;o--)a=(a<<8)+this.byteAt(o);return this.index+=s,a},readString:function(s){return i.transformTo("string",this.readData(s))},readData:function(s){},lastIndexOfSignature:function(s){},readAndCheckSignature:function(s){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},e.exports=r},{"../utils":32}],19:[function(t,e,n){"use strict";var i=t("./Uint8ArrayReader");function r(s){i.call(this,s)}t("../utils").inherits(r,i),r.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,n){"use strict";var i=t("./DataReader");function r(s){i.call(this,s)}t("../utils").inherits(r,i),r.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},r.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},r.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},r.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=r},{"../utils":32,"./DataReader":18}],21:[function(t,e,n){"use strict";var i=t("./ArrayReader");function r(s){i.call(this,s)}t("../utils").inherits(r,i),r.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},e.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,n){"use strict";var i=t("../utils"),r=t("../support"),s=t("./ArrayReader"),o=t("./StringReader"),a=t("./NodeBufferReader"),l=t("./Uint8ArrayReader");e.exports=function(c){var h=i.getTypeOf(c);return i.checkSupport(h),h!=="string"||r.uint8array?h==="nodebuffer"?new a(c):r.uint8array?new l(i.transformTo("uint8array",c)):new s(i.transformTo("array",c)):new o(c)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,e,n){"use strict";var i=t("./GenericWorker"),r=t("../utils");function s(o){i.call(this,"ConvertWorker to "+o),this.destType=o}r.inherits(s,i),s.prototype.processChunk=function(o){this.push({data:r.transformTo(this.destType,o.data),meta:o.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,n){"use strict";var i=t("./GenericWorker"),r=t("../crc32");function s(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,i),s.prototype.processChunk=function(o){this.streamInfo.crc32=r(o.data,this.streamInfo.crc32||0),this.push(o)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,n){"use strict";var i=t("../utils"),r=t("./GenericWorker");function s(o){r.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}i.inherits(s,r),s.prototype.processChunk=function(o){if(o){var a=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=a+o.data.length}r.prototype.processChunk.call(this,o)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,n){"use strict";var i=t("../utils"),r=t("./GenericWorker");function s(o){r.call(this,"DataWorker");var a=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(l){a.dataIsReady=!0,a.data=l,a.max=l&&l.length||0,a.type=i.getTypeOf(l),a.isPaused||a._tickAndRepeat()},function(l){a.error(l)})}i.inherits(s,r),s.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,a=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,a);break;case"uint8array":o=this.data.subarray(this.index,a);break;case"array":case"nodebuffer":o=this.data.slice(this.index,a)}return this.index=a,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,n){"use strict";function i(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,s){return this._listeners[r].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,s){if(this._listeners[r])for(var o=0;o<this._listeners[r].length;o++)this._listeners[r][o].call(this,s)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var s=this;return r.on("data",function(o){s.processChunk(o)}),r.on("end",function(){s.end()}),r.on("error",function(o){s.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,s){return this.extraStreamInfo[r]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},e.exports=i},{}],29:[function(t,e,n){"use strict";var i=t("../utils"),r=t("./ConvertWorker"),s=t("./GenericWorker"),o=t("../base64"),a=t("../support"),l=t("../external"),c=null;if(a.nodestream)try{c=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(d,p){return new l.Promise(function(_,g){var y=[],v=d._internalType,w=d._outputType,S=d._mimeType;d.on("data",function(x,P){y.push(x),p&&p(P)}).on("error",function(x){y=[],g(x)}).on("end",function(){try{var x=function(P,F,C){switch(P){case"blob":return i.newBlob(i.transformTo("arraybuffer",F),C);case"base64":return o.encode(F);default:return i.transformTo(P,F)}}(w,function(P,F){var C,B=0,G=null,T=0;for(C=0;C<F.length;C++)T+=F[C].length;switch(P){case"string":return F.join("");case"array":return Array.prototype.concat.apply([],F);case"uint8array":for(G=new Uint8Array(T),C=0;C<F.length;C++)G.set(F[C],B),B+=F[C].length;return G;case"nodebuffer":return Buffer.concat(F);default:throw new Error("concat : unsupported type '"+P+"'")}}(v,y),S);_(x)}catch(P){g(P)}y=[]}).resume()})}function u(d,p,_){var g=p;switch(p){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=p,this._mimeType=_,i.checkSupport(g),this._worker=d.pipe(new r(g)),d.lock()}catch(y){this._worker=new s("error"),this._worker.error(y)}}u.prototype={accumulate:function(d){return h(this,d)},on:function(d,p){var _=this;return d==="data"?this._worker.on(d,function(g){p.call(_,g.data,g.meta)}):this._worker.on(d,function(){i.delay(p,arguments,_)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(d){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:this._outputType!=="nodebuffer"},d)}},e.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=r.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,n){"use strict";for(var i=t("./utils"),r=t("./support"),s=t("./nodejsUtils"),o=t("./stream/GenericWorker"),a=new Array(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;a[254]=a[254]=1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function h(){o.call(this,"utf-8 encode")}n.utf8encode=function(u){return r.nodebuffer?s.newBufferFrom(u,"utf-8"):function(d){var p,_,g,y,v,w=d.length,S=0;for(y=0;y<w;y++)(64512&(_=d.charCodeAt(y)))==55296&&y+1<w&&(64512&(g=d.charCodeAt(y+1)))==56320&&(_=65536+(_-55296<<10)+(g-56320),y++),S+=_<128?1:_<2048?2:_<65536?3:4;for(p=r.uint8array?new Uint8Array(S):new Array(S),y=v=0;v<S;y++)(64512&(_=d.charCodeAt(y)))==55296&&y+1<w&&(64512&(g=d.charCodeAt(y+1)))==56320&&(_=65536+(_-55296<<10)+(g-56320),y++),_<128?p[v++]=_:(_<2048?p[v++]=192|_>>>6:(_<65536?p[v++]=224|_>>>12:(p[v++]=240|_>>>18,p[v++]=128|_>>>12&63),p[v++]=128|_>>>6&63),p[v++]=128|63&_);return p}(u)},n.utf8decode=function(u){return r.nodebuffer?i.transformTo("nodebuffer",u).toString("utf-8"):function(d){var p,_,g,y,v=d.length,w=new Array(2*v);for(p=_=0;p<v;)if((g=d[p++])<128)w[_++]=g;else if(4<(y=a[g]))w[_++]=65533,p+=y-1;else{for(g&=y===2?31:y===3?15:7;1<y&&p<v;)g=g<<6|63&d[p++],y--;1<y?w[_++]=65533:g<65536?w[_++]=g:(g-=65536,w[_++]=55296|g>>10&1023,w[_++]=56320|1023&g)}return w.length!==_&&(w.subarray?w=w.subarray(0,_):w.length=_),i.applyFromCharCode(w)}(u=i.transformTo(r.uint8array?"uint8array":"array",u))},i.inherits(c,o),c.prototype.processChunk=function(u){var d=i.transformTo(r.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var p=d;(d=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),d.set(p,this.leftOver.length)}else d=this.leftOver.concat(d);this.leftOver=null}var _=function(y,v){var w;for((v=v||y.length)>y.length&&(v=y.length),w=v-1;0<=w&&(192&y[w])==128;)w--;return w<0||w===0?v:w+a[y[w]]>v?w:v}(d),g=d;_!==d.length&&(r.uint8array?(g=d.subarray(0,_),this.leftOver=d.subarray(_,d.length)):(g=d.slice(0,_),this.leftOver=d.slice(_,d.length))),this.push({data:n.utf8decode(g),meta:u.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,i.inherits(h,o),h.prototype.processChunk=function(u){this.push({data:n.utf8encode(u.data),meta:u.meta})},n.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,n){"use strict";var i=t("./support"),r=t("./base64"),s=t("./nodejsUtils"),o=t("./external");function a(p){return p}function l(p,_){for(var g=0;g<p.length;++g)_[g]=255&p.charCodeAt(g);return _}t("setimmediate"),n.newBlob=function(p,_){n.checkSupport("blob");try{return new Blob([p],{type:_})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(p),g.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(p,_,g){var y=[],v=0,w=p.length;if(w<=g)return String.fromCharCode.apply(null,p);for(;v<w;)_==="array"||_==="nodebuffer"?y.push(String.fromCharCode.apply(null,p.slice(v,Math.min(v+g,w)))):y.push(String.fromCharCode.apply(null,p.subarray(v,Math.min(v+g,w)))),v+=g;return y.join("")},stringifyByChar:function(p){for(var _="",g=0;g<p.length;g++)_+=String.fromCharCode(p[g]);return _},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function h(p){var _=65536,g=n.getTypeOf(p),y=!0;if(g==="uint8array"?y=c.applyCanBeUsed.uint8array:g==="nodebuffer"&&(y=c.applyCanBeUsed.nodebuffer),y)for(;1<_;)try{return c.stringifyByChunk(p,g,_)}catch{_=Math.floor(_/2)}return c.stringifyByChar(p)}function u(p,_){for(var g=0;g<p.length;g++)_[g]=p[g];return _}n.applyFromCharCode=h;var d={};d.string={string:a,array:function(p){return l(p,new Array(p.length))},arraybuffer:function(p){return d.string.uint8array(p).buffer},uint8array:function(p){return l(p,new Uint8Array(p.length))},nodebuffer:function(p){return l(p,s.allocBuffer(p.length))}},d.array={string:h,array:a,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return s.newBufferFrom(p)}},d.arraybuffer={string:function(p){return h(new Uint8Array(p))},array:function(p){return u(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:a,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return s.newBufferFrom(new Uint8Array(p))}},d.uint8array={string:h,array:function(p){return u(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:a,nodebuffer:function(p){return s.newBufferFrom(p)}},d.nodebuffer={string:h,array:function(p){return u(p,new Array(p.length))},arraybuffer:function(p){return d.nodebuffer.uint8array(p).buffer},uint8array:function(p){return u(p,new Uint8Array(p.length))},nodebuffer:a},n.transformTo=function(p,_){if(_=_||"",!p)return _;n.checkSupport(p);var g=n.getTypeOf(_);return d[g][p](_)},n.resolve=function(p){for(var _=p.split("/"),g=[],y=0;y<_.length;y++){var v=_[y];v==="."||v===""&&y!==0&&y!==_.length-1||(v===".."?g.pop():g.push(v))}return g.join("/")},n.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":i.nodebuffer&&s.isBuffer(p)?"nodebuffer":i.uint8array&&p instanceof Uint8Array?"uint8array":i.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(p){if(!i[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(p){var _,g,y="";for(g=0;g<(p||"").length;g++)y+="\\x"+((_=p.charCodeAt(g))<16?"0":"")+_.toString(16).toUpperCase();return y},n.delay=function(p,_,g){setImmediate(function(){p.apply(g||null,_||[])})},n.inherits=function(p,_){function g(){}g.prototype=_.prototype,p.prototype=new g},n.extend=function(){var p,_,g={};for(p=0;p<arguments.length;p++)for(_ in arguments[p])arguments[p].hasOwnProperty(_)&&g[_]===void 0&&(g[_]=arguments[p][_]);return g},n.prepareContent=function(p,_,g,y,v){return o.Promise.resolve(_).then(function(w){return i.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new o.Promise(function(S,x){var P=new FileReader;P.onload=function(F){S(F.target.result)},P.onerror=function(F){x(F.target.error)},P.readAsArrayBuffer(w)}):w}).then(function(w){var S=n.getTypeOf(w);return S?(S==="arraybuffer"?w=n.transformTo("uint8array",w):S==="string"&&(v?w=r.decode(w):g&&y!==!0&&(w=function(x){return l(x,i.uint8array?new Uint8Array(x.length):new Array(x.length))}(w))),w):o.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,e,n){"use strict";var i=t("./reader/readerFor"),r=t("./utils"),s=t("./signature"),o=t("./zipEntry"),a=(t("./utf8"),t("./support"));function l(c){this.files=[],this.loadOptions=c}l.prototype={checkSignature:function(c){if(!this.reader.readAndCheckSignature(c)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(h)+", expected "+r.pretty(c)+")")}},isSignature:function(c,h){var u=this.reader.index;this.reader.setIndex(c);var d=this.reader.readString(4)===h;return this.reader.setIndex(u),d},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var c=this.reader.readData(this.zipCommentLength),h=a.uint8array?"uint8array":"array",u=r.transformTo(h,c);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var c,h,u,d=this.zip64EndOfCentralSize-44;0<d;)c=this.reader.readInt(2),h=this.reader.readInt(4),u=this.reader.readData(h),this.zip64ExtensibleData[c]={id:c,length:h,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var c,h;for(c=0;c<this.files.length;c++)h=this.files[c],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var c;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(c=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(c);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var c=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(c<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(c);var h=c;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(c=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(c),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var d=h-u;if(0<d)this.isSignature(h,s.CENTRAL_FILE_HEADER)||(this.reader.zero=d);else if(d<0)throw new Error("Corrupted zip: missing "+Math.abs(d)+" bytes.")},prepareReader:function(c){this.reader=i(c)},load:function(c){this.prepareReader(c),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,n){"use strict";var i=t("./reader/readerFor"),r=t("./utils"),s=t("./compressedObject"),o=t("./crc32"),a=t("./utf8"),l=t("./compressions"),c=t("./support");function h(u,d){this.options=u,this.loadOptions=d}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var d,p;if(u.skip(22),this.fileNameLength=u.readInt(2),p=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((d=function(_){for(var g in l)if(l.hasOwnProperty(g)&&l[g].magic===_)return l[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,d,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var d=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(d),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(u){if(this.extraFields[1]){var d=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(u){var d,p,_,g=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<g;)d=u.readInt(2),p=u.readInt(2),_=u.readData(p),this.extraFields[d]={id:d,length:p,value:_};u.setIndex(g)},handleUTF8:function(){var u=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var d=this.findExtraFieldUnicodePath();if(d!==null)this.fileNameStr=d;else{var p=r.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var g=r.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var d=i(u.value);return d.readInt(1)!==1||o(this.fileName)!==d.readInt(4)?null:a.utf8decode(d.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var d=i(u.value);return d.readInt(1)!==1||o(this.fileComment)!==d.readInt(4)?null:a.utf8decode(d.readData(u.length-5))}return null}},e.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,n){"use strict";function i(d,p,_){this.name=d,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=p,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var r=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),o=t("./utf8"),a=t("./compressedObject"),l=t("./stream/GenericWorker");i.prototype={internalStream:function(d){var p=null,_="string";try{if(!d)throw new Error("No output type specified.");var g=(_=d.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),p=this._decompressWorker();var y=!this._dataBinary;y&&!g&&(p=p.pipe(new o.Utf8EncodeWorker)),!y&&g&&(p=p.pipe(new o.Utf8DecodeWorker))}catch(v){(p=new l("error")).error(v)}return new r(p,_,"")},async:function(d,p){return this.internalStream(d).accumulate(p)},nodeStream:function(d,p){return this.internalStream(d||"nodebuffer").toNodejsStream(p)},_compressWorker:function(d,p){if(this._data instanceof a&&this._data.compression.magic===d.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(_,d,p)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)i.prototype[c[u]]=h;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,n){(function(i){"use strict";var r,s,o=i.MutationObserver||i.WebKitMutationObserver;if(o){var a=0,l=new o(d),c=i.document.createTextNode("");l.observe(c,{characterData:!0}),r=function(){c.data=a=++a%2}}else if(i.setImmediate||i.MessageChannel===void 0)r="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var p=i.document.createElement("script");p.onreadystatechange=function(){d(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},i.document.documentElement.appendChild(p)}:function(){setTimeout(d,0)};else{var h=new i.MessageChannel;h.port1.onmessage=d,r=function(){h.port2.postMessage(0)}}var u=[];function d(){var p,_;s=!0;for(var g=u.length;g;){for(_=u,u=[],p=-1;++p<g;)_[p]();g=u.length}s=!1}e.exports=function(p){u.push(p)!==1||s||r()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,e,n){"use strict";var i=t("immediate");function r(){}var s={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,g!==r&&p(this,g)}function h(g,y,v){this.promise=g,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function u(g,y,v){i(function(){var w;try{w=y(v)}catch(S){return s.reject(g,S)}w===g?s.reject(g,new TypeError("Cannot resolve promise with itself")):s.resolve(g,w)})}function d(g){var y=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof y=="function")return function(){y.apply(g,arguments)}}function p(g,y){var v=!1;function w(P){v||(v=!0,s.reject(g,P))}function S(P){v||(v=!0,s.resolve(g,P))}var x=_(function(){y(S,w)});x.status==="error"&&w(x.value)}function _(g,y){var v={};try{v.value=g(y),v.status="success"}catch(w){v.status="error",v.value=w}return v}(e.exports=c).prototype.finally=function(g){if(typeof g!="function")return this;var y=this.constructor;return this.then(function(v){return y.resolve(g()).then(function(){return v})},function(v){return y.resolve(g()).then(function(){throw v})})},c.prototype.catch=function(g){return this.then(null,g)},c.prototype.then=function(g,y){if(typeof g!="function"&&this.state===a||typeof y!="function"&&this.state===o)return this;var v=new this.constructor(r);return this.state!==l?u(v,this.state===a?g:y,this.outcome):this.queue.push(new h(v,g,y)),v},h.prototype.callFulfilled=function(g){s.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){u(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){s.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){u(this.promise,this.onRejected,g)},s.resolve=function(g,y){var v=_(d,y);if(v.status==="error")return s.reject(g,v.value);var w=v.value;if(w)p(g,w);else{g.state=a,g.outcome=y;for(var S=-1,x=g.queue.length;++S<x;)g.queue[S].callFulfilled(y)}return g},s.reject=function(g,y){g.state=o,g.outcome=y;for(var v=-1,w=g.queue.length;++v<w;)g.queue[v].callRejected(y);return g},c.resolve=function(g){return g instanceof this?g:s.resolve(new this(r),g)},c.reject=function(g){var y=new this(r);return s.reject(y,g)},c.all=function(g){var y=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,w=!1;if(!v)return this.resolve([]);for(var S=new Array(v),x=0,P=-1,F=new this(r);++P<v;)C(g[P],P);return F;function C(B,G){y.resolve(B).then(function(T){S[G]=T,++x!==v||w||(w=!0,s.resolve(F,S))},function(T){w||(w=!0,s.reject(F,T))})}},c.race=function(g){var y=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,w=!1;if(!v)return this.resolve([]);for(var S=-1,x=new this(r);++S<v;)P=g[S],y.resolve(P).then(function(F){w||(w=!0,s.resolve(x,F))},function(F){w||(w=!0,s.reject(x,F))});var P;return x}},{immediate:36}],38:[function(t,e,n){"use strict";var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,n){"use strict";var i=t("./zlib/deflate"),r=t("./utils/common"),s=t("./utils/strings"),o=t("./zlib/messages"),a=t("./zlib/zstream"),l=Object.prototype.toString,c=0,h=-1,u=0,d=8;function p(g){if(!(this instanceof p))return new p(g);this.options=r.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},g||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var v=i.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(v!==c)throw new Error(o[v]);if(y.header&&i.deflateSetHeader(this.strm,y.header),y.dictionary){var w;if(w=typeof y.dictionary=="string"?s.string2buf(y.dictionary):l.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(v=i.deflateSetDictionary(this.strm,w))!==c)throw new Error(o[v]);this._dict_set=!0}}function _(g,y){var v=new p(y);if(v.push(g,!0),v.err)throw v.msg||o[v.err];return v.result}p.prototype.push=function(g,y){var v,w,S=this.strm,x=this.options.chunkSize;if(this.ended)return!1;w=y===~~y?y:y===!0?4:0,typeof g=="string"?S.input=s.string2buf(g):l.call(g)==="[object ArrayBuffer]"?S.input=new Uint8Array(g):S.input=g,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new r.Buf8(x),S.next_out=0,S.avail_out=x),(v=i.deflate(S,w))!==1&&v!==c)return this.onEnd(v),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(r.shrinkBuf(S.output,S.next_out))):this.onData(r.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&v!==1);return w===4?(v=i.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c):w!==2||(this.onEnd(c),!(S.avail_out=0))},p.prototype.onData=function(g){this.chunks.push(g)},p.prototype.onEnd=function(g){g===c&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},n.Deflate=p,n.deflate=_,n.deflateRaw=function(g,y){return(y=y||{}).raw=!0,_(g,y)},n.gzip=function(g,y){return(y=y||{}).gzip=!0,_(g,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,n){"use strict";var i=t("./zlib/inflate"),r=t("./utils/common"),s=t("./utils/strings"),o=t("./zlib/constants"),a=t("./zlib/messages"),l=t("./zlib/zstream"),c=t("./zlib/gzheader"),h=Object.prototype.toString;function u(p){if(!(this instanceof u))return new u(p);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},p||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||p&&p.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,_.windowBits);if(g!==o.Z_OK)throw new Error(a[g]);this.header=new c,i.inflateGetHeader(this.strm,this.header)}function d(p,_){var g=new u(_);if(g.push(p,!0),g.err)throw g.msg||a[g.err];return g.result}u.prototype.push=function(p,_){var g,y,v,w,S,x,P=this.strm,F=this.options.chunkSize,C=this.options.dictionary,B=!1;if(this.ended)return!1;y=_===~~_?_:_===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof p=="string"?P.input=s.binstring2buf(p):h.call(p)==="[object ArrayBuffer]"?P.input=new Uint8Array(p):P.input=p,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new r.Buf8(F),P.next_out=0,P.avail_out=F),(g=i.inflate(P,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&C&&(x=typeof C=="string"?s.string2buf(C):h.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,g=i.inflateSetDictionary(this.strm,x)),g===o.Z_BUF_ERROR&&B===!0&&(g=o.Z_OK,B=!1),g!==o.Z_STREAM_END&&g!==o.Z_OK)return this.onEnd(g),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&g!==o.Z_STREAM_END&&(P.avail_in!==0||y!==o.Z_FINISH&&y!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=s.utf8border(P.output,P.next_out),w=P.next_out-v,S=s.buf2string(P.output,v),P.next_out=w,P.avail_out=F-w,w&&r.arraySet(P.output,P.output,v,w,0),this.onData(S)):this.onData(r.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(B=!0)}while((0<P.avail_in||P.avail_out===0)&&g!==o.Z_STREAM_END);return g===o.Z_STREAM_END&&(y=o.Z_FINISH),y===o.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===o.Z_OK):y!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(P.avail_out=0))},u.prototype.onData=function(p){this.chunks.push(p)},u.prototype.onEnd=function(p){p===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},n.Inflate=u,n.inflate=d,n.inflateRaw=function(p,_){return(_=_||{}).raw=!0,d(p,_)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,n){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(o){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var l=a.shift();if(l){if(typeof l!="object")throw new TypeError(l+"must be non-object");for(var c in l)l.hasOwnProperty(c)&&(o[c]=l[c])}}return o},n.shrinkBuf=function(o,a){return o.length===a?o:o.subarray?o.subarray(0,a):(o.length=a,o)};var r={arraySet:function(o,a,l,c,h){if(a.subarray&&o.subarray)o.set(a.subarray(l,l+c),h);else for(var u=0;u<c;u++)o[h+u]=a[l+u]},flattenChunks:function(o){var a,l,c,h,u,d;for(a=c=0,l=o.length;a<l;a++)c+=o[a].length;for(d=new Uint8Array(c),a=h=0,l=o.length;a<l;a++)u=o[a],d.set(u,h),h+=u.length;return d}},s={arraySet:function(o,a,l,c,h){for(var u=0;u<c;u++)o[h+u]=a[l+u]},flattenChunks:function(o){return[].concat.apply([],o)}};n.setTyped=function(o){o?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(i)},{}],42:[function(t,e,n){"use strict";var i=t("./common"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var o=new i.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function l(c,h){if(h<65537&&(c.subarray&&s||!c.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(c,h));for(var u="",d=0;d<h;d++)u+=String.fromCharCode(c[d]);return u}o[254]=o[254]=1,n.string2buf=function(c){var h,u,d,p,_,g=c.length,y=0;for(p=0;p<g;p++)(64512&(u=c.charCodeAt(p)))==55296&&p+1<g&&(64512&(d=c.charCodeAt(p+1)))==56320&&(u=65536+(u-55296<<10)+(d-56320),p++),y+=u<128?1:u<2048?2:u<65536?3:4;for(h=new i.Buf8(y),p=_=0;_<y;p++)(64512&(u=c.charCodeAt(p)))==55296&&p+1<g&&(64512&(d=c.charCodeAt(p+1)))==56320&&(u=65536+(u-55296<<10)+(d-56320),p++),u<128?h[_++]=u:(u<2048?h[_++]=192|u>>>6:(u<65536?h[_++]=224|u>>>12:(h[_++]=240|u>>>18,h[_++]=128|u>>>12&63),h[_++]=128|u>>>6&63),h[_++]=128|63&u);return h},n.buf2binstring=function(c){return l(c,c.length)},n.binstring2buf=function(c){for(var h=new i.Buf8(c.length),u=0,d=h.length;u<d;u++)h[u]=c.charCodeAt(u);return h},n.buf2string=function(c,h){var u,d,p,_,g=h||c.length,y=new Array(2*g);for(u=d=0;u<g;)if((p=c[u++])<128)y[d++]=p;else if(4<(_=o[p]))y[d++]=65533,u+=_-1;else{for(p&=_===2?31:_===3?15:7;1<_&&u<g;)p=p<<6|63&c[u++],_--;1<_?y[d++]=65533:p<65536?y[d++]=p:(p-=65536,y[d++]=55296|p>>10&1023,y[d++]=56320|1023&p)}return l(y,d)},n.utf8border=function(c,h){var u;for((h=h||c.length)>c.length&&(h=c.length),u=h-1;0<=u&&(192&c[u])==128;)u--;return u<0||u===0?h:u+o[c[u]]>h?u:h}},{"./common":41}],43:[function(t,e,n){"use strict";e.exports=function(i,r,s,o){for(var a=65535&i|0,l=i>>>16&65535|0,c=0;s!==0;){for(s-=c=2e3<s?2e3:s;l=l+(a=a+r[o++]|0)|0,--c;);a%=65521,l%=65521}return a|l<<16|0}},{}],44:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,n){"use strict";var i=function(){for(var r,s=[],o=0;o<256;o++){r=o;for(var a=0;a<8;a++)r=1&r?3988292384^r>>>1:r>>>1;s[o]=r}return s}();e.exports=function(r,s,o,a){var l=i,c=a+o;r^=-1;for(var h=a;h<c;h++)r=r>>>8^l[255&(r^s[h])];return-1^r}},{}],46:[function(t,e,n){"use strict";var i,r=t("../utils/common"),s=t("./trees"),o=t("./adler32"),a=t("./crc32"),l=t("./messages"),c=0,h=4,u=0,d=-2,p=-1,_=4,g=2,y=8,v=9,w=286,S=30,x=19,P=2*w+1,F=15,C=3,B=258,G=B+C+1,T=42,L=113,f=1,I=2,q=3,M=4;function Q(m,J){return m.msg=l[J],J}function b(m){return(m<<1)-(4<m?9:0)}function W(m){for(var J=m.length;0<=--J;)m[J]=0}function O(m){var J=m.state,j=J.pending;j>m.avail_out&&(j=m.avail_out),j!==0&&(r.arraySet(m.output,J.pending_buf,J.pending_out,j,m.next_out),m.next_out+=j,J.pending_out+=j,m.total_out+=j,m.avail_out-=j,J.pending-=j,J.pending===0&&(J.pending_out=0))}function R(m,J){s._tr_flush_block(m,0<=m.block_start?m.block_start:-1,m.strstart-m.block_start,J),m.block_start=m.strstart,O(m.strm)}function ee(m,J){m.pending_buf[m.pending++]=J}function te(m,J){m.pending_buf[m.pending++]=J>>>8&255,m.pending_buf[m.pending++]=255&J}function ne(m,J){var j,A,E=m.max_chain_length,z=m.strstart,X=m.prev_length,K=m.nice_match,H=m.strstart>m.w_size-G?m.strstart-(m.w_size-G):0,Z=m.window,ce=m.w_mask,D=m.prev,Y=m.strstart+B,re=Z[z+X-1],ae=Z[z+X];m.prev_length>=m.good_match&&(E>>=2),K>m.lookahead&&(K=m.lookahead);do if(Z[(j=J)+X]===ae&&Z[j+X-1]===re&&Z[j]===Z[z]&&Z[++j]===Z[z+1]){z+=2,j++;do;while(Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&Z[++z]===Z[++j]&&z<Y);if(A=B-(Y-z),z=Y-B,X<A){if(m.match_start=J,K<=(X=A))break;re=Z[z+X-1],ae=Z[z+X]}}while((J=D[J&ce])>H&&--E!=0);return X<=m.lookahead?X:m.lookahead}function ve(m){var J,j,A,E,z,X,K,H,Z,ce,D=m.w_size;do{if(E=m.window_size-m.lookahead-m.strstart,m.strstart>=D+(D-G)){for(r.arraySet(m.window,m.window,D,D,0),m.match_start-=D,m.strstart-=D,m.block_start-=D,J=j=m.hash_size;A=m.head[--J],m.head[J]=D<=A?A-D:0,--j;);for(J=j=D;A=m.prev[--J],m.prev[J]=D<=A?A-D:0,--j;);E+=D}if(m.strm.avail_in===0)break;if(X=m.strm,K=m.window,H=m.strstart+m.lookahead,Z=E,ce=void 0,ce=X.avail_in,Z<ce&&(ce=Z),j=ce===0?0:(X.avail_in-=ce,r.arraySet(K,X.input,X.next_in,ce,H),X.state.wrap===1?X.adler=o(X.adler,K,ce,H):X.state.wrap===2&&(X.adler=a(X.adler,K,ce,H)),X.next_in+=ce,X.total_in+=ce,ce),m.lookahead+=j,m.lookahead+m.insert>=C)for(z=m.strstart-m.insert,m.ins_h=m.window[z],m.ins_h=(m.ins_h<<m.hash_shift^m.window[z+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[z+C-1])&m.hash_mask,m.prev[z&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=z,z++,m.insert--,!(m.lookahead+m.insert<C)););}while(m.lookahead<G&&m.strm.avail_in!==0)}function Ie(m,J){for(var j,A;;){if(m.lookahead<G){if(ve(m),m.lookahead<G&&J===c)return f;if(m.lookahead===0)break}if(j=0,m.lookahead>=C&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+C-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),j!==0&&m.strstart-j<=m.w_size-G&&(m.match_length=ne(m,j)),m.match_length>=C)if(A=s._tr_tally(m,m.strstart-m.match_start,m.match_length-C),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=C){for(m.match_length--;m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+C-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart,--m.match_length!=0;);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else A=s._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(A&&(R(m,!1),m.strm.avail_out===0))return f}return m.insert=m.strstart<C-1?m.strstart:C-1,J===h?(R(m,!0),m.strm.avail_out===0?q:M):m.last_lit&&(R(m,!1),m.strm.avail_out===0)?f:I}function _e(m,J){for(var j,A,E;;){if(m.lookahead<G){if(ve(m),m.lookahead<G&&J===c)return f;if(m.lookahead===0)break}if(j=0,m.lookahead>=C&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+C-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=C-1,j!==0&&m.prev_length<m.max_lazy_match&&m.strstart-j<=m.w_size-G&&(m.match_length=ne(m,j),m.match_length<=5&&(m.strategy===1||m.match_length===C&&4096<m.strstart-m.match_start)&&(m.match_length=C-1)),m.prev_length>=C&&m.match_length<=m.prev_length){for(E=m.strstart+m.lookahead-C,A=s._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-C),m.lookahead-=m.prev_length-1,m.prev_length-=2;++m.strstart<=E&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+C-1])&m.hash_mask,j=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),--m.prev_length!=0;);if(m.match_available=0,m.match_length=C-1,m.strstart++,A&&(R(m,!1),m.strm.avail_out===0))return f}else if(m.match_available){if((A=s._tr_tally(m,0,m.window[m.strstart-1]))&&R(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return f}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(A=s._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<C-1?m.strstart:C-1,J===h?(R(m,!0),m.strm.avail_out===0?q:M):m.last_lit&&(R(m,!1),m.strm.avail_out===0)?f:I}function pe(m,J,j,A,E){this.good_length=m,this.max_lazy=J,this.nice_length=j,this.max_chain=A,this.func=E}function Ae(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*P),this.dyn_dtree=new r.Buf16(2*(2*S+1)),this.bl_tree=new r.Buf16(2*(2*x+1)),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(F+1),this.heap=new r.Buf16(2*w+1),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*w+1),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xe(m){var J;return m&&m.state?(m.total_in=m.total_out=0,m.data_type=g,(J=m.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?T:L,m.adler=J.wrap===2?0:1,J.last_flush=c,s._tr_init(J),u):Q(m,d)}function qe(m){var J=xe(m);return J===u&&function(j){j.window_size=2*j.w_size,W(j.head),j.max_lazy_match=i[j.level].max_lazy,j.good_match=i[j.level].good_length,j.nice_match=i[j.level].nice_length,j.max_chain_length=i[j.level].max_chain,j.strstart=0,j.block_start=0,j.lookahead=0,j.insert=0,j.match_length=j.prev_length=C-1,j.match_available=0,j.ins_h=0}(m.state),J}function rt(m,J,j,A,E,z){if(!m)return d;var X=1;if(J===p&&(J=6),A<0?(X=0,A=-A):15<A&&(X=2,A-=16),E<1||v<E||j!==y||A<8||15<A||J<0||9<J||z<0||_<z)return Q(m,d);A===8&&(A=9);var K=new Ae;return(m.state=K).strm=m,K.wrap=X,K.gzhead=null,K.w_bits=A,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=E+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+C-1)/C),K.window=new r.Buf8(2*K.w_size),K.head=new r.Buf16(K.hash_size),K.prev=new r.Buf16(K.w_size),K.lit_bufsize=1<<E+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new r.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=J,K.strategy=z,K.method=j,qe(m)}i=[new pe(0,0,0,0,function(m,J){var j=65535;for(j>m.pending_buf_size-5&&(j=m.pending_buf_size-5);;){if(m.lookahead<=1){if(ve(m),m.lookahead===0&&J===c)return f;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var A=m.block_start+j;if((m.strstart===0||m.strstart>=A)&&(m.lookahead=m.strstart-A,m.strstart=A,R(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-G&&(R(m,!1),m.strm.avail_out===0))return f}return m.insert=0,J===h?(R(m,!0),m.strm.avail_out===0?q:M):(m.strstart>m.block_start&&(R(m,!1),m.strm.avail_out),f)}),new pe(4,4,8,4,Ie),new pe(4,5,16,8,Ie),new pe(4,6,32,32,Ie),new pe(4,4,16,16,_e),new pe(8,16,32,32,_e),new pe(8,16,128,128,_e),new pe(8,32,128,256,_e),new pe(32,128,258,1024,_e),new pe(32,258,258,4096,_e)],n.deflateInit=function(m,J){return rt(m,J,y,15,8,0)},n.deflateInit2=rt,n.deflateReset=qe,n.deflateResetKeep=xe,n.deflateSetHeader=function(m,J){return m&&m.state?m.state.wrap!==2?d:(m.state.gzhead=J,u):d},n.deflate=function(m,J){var j,A,E,z;if(!m||!m.state||5<J||J<0)return m?Q(m,d):d;if(A=m.state,!m.output||!m.input&&m.avail_in!==0||A.status===666&&J!==h)return Q(m,m.avail_out===0?-5:d);if(A.strm=m,j=A.last_flush,A.last_flush=J,A.status===T)if(A.wrap===2)m.adler=0,ee(A,31),ee(A,139),ee(A,8),A.gzhead?(ee(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),ee(A,255&A.gzhead.time),ee(A,A.gzhead.time>>8&255),ee(A,A.gzhead.time>>16&255),ee(A,A.gzhead.time>>24&255),ee(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),ee(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(ee(A,255&A.gzhead.extra.length),ee(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(m.adler=a(m.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(ee(A,0),ee(A,0),ee(A,0),ee(A,0),ee(A,0),ee(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),ee(A,3),A.status=L);else{var X=y+(A.w_bits-8<<4)<<8;X|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(X|=32),X+=31-X%31,A.status=L,te(A,X),A.strstart!==0&&(te(A,m.adler>>>16),te(A,65535&m.adler)),m.adler=1}if(A.status===69)if(A.gzhead.extra){for(E=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>E&&(m.adler=a(m.adler,A.pending_buf,A.pending-E,E)),O(m),E=A.pending,A.pending!==A.pending_buf_size));)ee(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>E&&(m.adler=a(m.adler,A.pending_buf,A.pending-E,E)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(m.adler=a(m.adler,A.pending_buf,A.pending-E,E)),O(m),E=A.pending,A.pending===A.pending_buf_size)){z=1;break}z=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,ee(A,z)}while(z!==0);A.gzhead.hcrc&&A.pending>E&&(m.adler=a(m.adler,A.pending_buf,A.pending-E,E)),z===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){E=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>E&&(m.adler=a(m.adler,A.pending_buf,A.pending-E,E)),O(m),E=A.pending,A.pending===A.pending_buf_size)){z=1;break}z=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,ee(A,z)}while(z!==0);A.gzhead.hcrc&&A.pending>E&&(m.adler=a(m.adler,A.pending_buf,A.pending-E,E)),z===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&O(m),A.pending+2<=A.pending_buf_size&&(ee(A,255&m.adler),ee(A,m.adler>>8&255),m.adler=0,A.status=L)):A.status=L),A.pending!==0){if(O(m),m.avail_out===0)return A.last_flush=-1,u}else if(m.avail_in===0&&b(J)<=b(j)&&J!==h)return Q(m,-5);if(A.status===666&&m.avail_in!==0)return Q(m,-5);if(m.avail_in!==0||A.lookahead!==0||J!==c&&A.status!==666){var K=A.strategy===2?function(H,Z){for(var ce;;){if(H.lookahead===0&&(ve(H),H.lookahead===0)){if(Z===c)return f;break}if(H.match_length=0,ce=s._tr_tally(H,0,H.window[H.strstart]),H.lookahead--,H.strstart++,ce&&(R(H,!1),H.strm.avail_out===0))return f}return H.insert=0,Z===h?(R(H,!0),H.strm.avail_out===0?q:M):H.last_lit&&(R(H,!1),H.strm.avail_out===0)?f:I}(A,J):A.strategy===3?function(H,Z){for(var ce,D,Y,re,ae=H.window;;){if(H.lookahead<=B){if(ve(H),H.lookahead<=B&&Z===c)return f;if(H.lookahead===0)break}if(H.match_length=0,H.lookahead>=C&&0<H.strstart&&(D=ae[Y=H.strstart-1])===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]){re=H.strstart+B;do;while(D===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]&&D===ae[++Y]&&Y<re);H.match_length=B-(re-Y),H.match_length>H.lookahead&&(H.match_length=H.lookahead)}if(H.match_length>=C?(ce=s._tr_tally(H,1,H.match_length-C),H.lookahead-=H.match_length,H.strstart+=H.match_length,H.match_length=0):(ce=s._tr_tally(H,0,H.window[H.strstart]),H.lookahead--,H.strstart++),ce&&(R(H,!1),H.strm.avail_out===0))return f}return H.insert=0,Z===h?(R(H,!0),H.strm.avail_out===0?q:M):H.last_lit&&(R(H,!1),H.strm.avail_out===0)?f:I}(A,J):i[A.level].func(A,J);if(K!==q&&K!==M||(A.status=666),K===f||K===q)return m.avail_out===0&&(A.last_flush=-1),u;if(K===I&&(J===1?s._tr_align(A):J!==5&&(s._tr_stored_block(A,0,0,!1),J===3&&(W(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),O(m),m.avail_out===0))return A.last_flush=-1,u}return J!==h?u:A.wrap<=0?1:(A.wrap===2?(ee(A,255&m.adler),ee(A,m.adler>>8&255),ee(A,m.adler>>16&255),ee(A,m.adler>>24&255),ee(A,255&m.total_in),ee(A,m.total_in>>8&255),ee(A,m.total_in>>16&255),ee(A,m.total_in>>24&255)):(te(A,m.adler>>>16),te(A,65535&m.adler)),O(m),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?u:1)},n.deflateEnd=function(m){var J;return m&&m.state?(J=m.state.status)!==T&&J!==69&&J!==73&&J!==91&&J!==103&&J!==L&&J!==666?Q(m,d):(m.state=null,J===L?Q(m,-3):u):d},n.deflateSetDictionary=function(m,J){var j,A,E,z,X,K,H,Z,ce=J.length;if(!m||!m.state||(z=(j=m.state).wrap)===2||z===1&&j.status!==T||j.lookahead)return d;for(z===1&&(m.adler=o(m.adler,J,ce,0)),j.wrap=0,ce>=j.w_size&&(z===0&&(W(j.head),j.strstart=0,j.block_start=0,j.insert=0),Z=new r.Buf8(j.w_size),r.arraySet(Z,J,ce-j.w_size,j.w_size,0),J=Z,ce=j.w_size),X=m.avail_in,K=m.next_in,H=m.input,m.avail_in=ce,m.next_in=0,m.input=J,ve(j);j.lookahead>=C;){for(A=j.strstart,E=j.lookahead-(C-1);j.ins_h=(j.ins_h<<j.hash_shift^j.window[A+C-1])&j.hash_mask,j.prev[A&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=A,A++,--E;);j.strstart=A,j.lookahead=C-1,ve(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=C-1,j.match_available=0,m.next_in=K,m.input=H,m.avail_in=X,j.wrap=z,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,n){"use strict";e.exports=function(i,r){var s,o,a,l,c,h,u,d,p,_,g,y,v,w,S,x,P,F,C,B,G,T,L,f,I;s=i.state,o=i.next_in,f=i.input,a=o+(i.avail_in-5),l=i.next_out,I=i.output,c=l-(r-i.avail_out),h=l+(i.avail_out-257),u=s.dmax,d=s.wsize,p=s.whave,_=s.wnext,g=s.window,y=s.hold,v=s.bits,w=s.lencode,S=s.distcode,x=(1<<s.lenbits)-1,P=(1<<s.distbits)-1;e:do{v<15&&(y+=f[o++]<<v,v+=8,y+=f[o++]<<v,v+=8),F=w[y&x];t:for(;;){if(y>>>=C=F>>>24,v-=C,(C=F>>>16&255)===0)I[l++]=65535&F;else{if(!(16&C)){if((64&C)==0){F=w[(65535&F)+(y&(1<<C)-1)];continue t}if(32&C){s.mode=12;break e}i.msg="invalid literal/length code",s.mode=30;break e}B=65535&F,(C&=15)&&(v<C&&(y+=f[o++]<<v,v+=8),B+=y&(1<<C)-1,y>>>=C,v-=C),v<15&&(y+=f[o++]<<v,v+=8,y+=f[o++]<<v,v+=8),F=S[y&P];n:for(;;){if(y>>>=C=F>>>24,v-=C,!(16&(C=F>>>16&255))){if((64&C)==0){F=S[(65535&F)+(y&(1<<C)-1)];continue n}i.msg="invalid distance code",s.mode=30;break e}if(G=65535&F,v<(C&=15)&&(y+=f[o++]<<v,(v+=8)<C&&(y+=f[o++]<<v,v+=8)),u<(G+=y&(1<<C)-1)){i.msg="invalid distance too far back",s.mode=30;break e}if(y>>>=C,v-=C,(C=l-c)<G){if(p<(C=G-C)&&s.sane){i.msg="invalid distance too far back",s.mode=30;break e}if(L=g,(T=0)===_){if(T+=d-C,C<B){for(B-=C;I[l++]=g[T++],--C;);T=l-G,L=I}}else if(_<C){if(T+=d+_-C,(C-=_)<B){for(B-=C;I[l++]=g[T++],--C;);if(T=0,_<B){for(B-=C=_;I[l++]=g[T++],--C;);T=l-G,L=I}}}else if(T+=_-C,C<B){for(B-=C;I[l++]=g[T++],--C;);T=l-G,L=I}for(;2<B;)I[l++]=L[T++],I[l++]=L[T++],I[l++]=L[T++],B-=3;B&&(I[l++]=L[T++],1<B&&(I[l++]=L[T++]))}else{for(T=l-G;I[l++]=I[T++],I[l++]=I[T++],I[l++]=I[T++],2<(B-=3););B&&(I[l++]=I[T++],1<B&&(I[l++]=I[T++]))}break}}break}}while(o<a&&l<h);o-=B=v>>3,y&=(1<<(v-=B<<3))-1,i.next_in=o,i.next_out=l,i.avail_in=o<a?a-o+5:5-(o-a),i.avail_out=l<h?h-l+257:257-(l-h),s.hold=y,s.bits=v}},{}],49:[function(t,e,n){"use strict";var i=t("../utils/common"),r=t("./adler32"),s=t("./crc32"),o=t("./inffast"),a=t("./inftrees"),l=1,c=2,h=0,u=-2,d=1,p=852,_=592;function g(T){return(T>>>24&255)+(T>>>8&65280)+((65280&T)<<8)+((255&T)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(T){var L;return T&&T.state?(L=T.state,T.total_in=T.total_out=L.total=0,T.msg="",L.wrap&&(T.adler=1&L.wrap),L.mode=d,L.last=0,L.havedict=0,L.dmax=32768,L.head=null,L.hold=0,L.bits=0,L.lencode=L.lendyn=new i.Buf32(p),L.distcode=L.distdyn=new i.Buf32(_),L.sane=1,L.back=-1,h):u}function w(T){var L;return T&&T.state?((L=T.state).wsize=0,L.whave=0,L.wnext=0,v(T)):u}function S(T,L){var f,I;return T&&T.state?(I=T.state,L<0?(f=0,L=-L):(f=1+(L>>4),L<48&&(L&=15)),L&&(L<8||15<L)?u:(I.window!==null&&I.wbits!==L&&(I.window=null),I.wrap=f,I.wbits=L,w(T))):u}function x(T,L){var f,I;return T?(I=new y,(T.state=I).window=null,(f=S(T,L))!==h&&(T.state=null),f):u}var P,F,C=!0;function B(T){if(C){var L;for(P=new i.Buf32(512),F=new i.Buf32(32),L=0;L<144;)T.lens[L++]=8;for(;L<256;)T.lens[L++]=9;for(;L<280;)T.lens[L++]=7;for(;L<288;)T.lens[L++]=8;for(a(l,T.lens,0,288,P,0,T.work,{bits:9}),L=0;L<32;)T.lens[L++]=5;a(c,T.lens,0,32,F,0,T.work,{bits:5}),C=!1}T.lencode=P,T.lenbits=9,T.distcode=F,T.distbits=5}function G(T,L,f,I){var q,M=T.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new i.Buf8(M.wsize)),I>=M.wsize?(i.arraySet(M.window,L,f-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(I<(q=M.wsize-M.wnext)&&(q=I),i.arraySet(M.window,L,f-I,q,M.wnext),(I-=q)?(i.arraySet(M.window,L,f-I,I,0),M.wnext=I,M.whave=M.wsize):(M.wnext+=q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=q))),0}n.inflateReset=w,n.inflateReset2=S,n.inflateResetKeep=v,n.inflateInit=function(T){return x(T,15)},n.inflateInit2=x,n.inflate=function(T,L){var f,I,q,M,Q,b,W,O,R,ee,te,ne,ve,Ie,_e,pe,Ae,xe,qe,rt,m,J,j,A,E=0,z=new i.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return u;(f=T.state).mode===12&&(f.mode=13),Q=T.next_out,q=T.output,W=T.avail_out,M=T.next_in,I=T.input,b=T.avail_in,O=f.hold,R=f.bits,ee=b,te=W,J=h;e:for(;;)switch(f.mode){case d:if(f.wrap===0){f.mode=13;break}for(;R<16;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(2&f.wrap&&O===35615){z[f.check=0]=255&O,z[1]=O>>>8&255,f.check=s(f.check,z,2,0),R=O=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&O)<<8)+(O>>8))%31){T.msg="incorrect header check",f.mode=30;break}if((15&O)!=8){T.msg="unknown compression method",f.mode=30;break}if(R-=4,m=8+(15&(O>>>=4)),f.wbits===0)f.wbits=m;else if(m>f.wbits){T.msg="invalid window size",f.mode=30;break}f.dmax=1<<m,T.adler=f.check=1,f.mode=512&O?10:12,R=O=0;break;case 2:for(;R<16;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(f.flags=O,(255&f.flags)!=8){T.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){T.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=O>>8&1),512&f.flags&&(z[0]=255&O,z[1]=O>>>8&255,f.check=s(f.check,z,2,0)),R=O=0,f.mode=3;case 3:for(;R<32;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}f.head&&(f.head.time=O),512&f.flags&&(z[0]=255&O,z[1]=O>>>8&255,z[2]=O>>>16&255,z[3]=O>>>24&255,f.check=s(f.check,z,4,0)),R=O=0,f.mode=4;case 4:for(;R<16;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}f.head&&(f.head.xflags=255&O,f.head.os=O>>8),512&f.flags&&(z[0]=255&O,z[1]=O>>>8&255,f.check=s(f.check,z,2,0)),R=O=0,f.mode=5;case 5:if(1024&f.flags){for(;R<16;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}f.length=O,f.head&&(f.head.extra_len=O),512&f.flags&&(z[0]=255&O,z[1]=O>>>8&255,f.check=s(f.check,z,2,0)),R=O=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(b<(ne=f.length)&&(ne=b),ne&&(f.head&&(m=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),i.arraySet(f.head.extra,I,M,ne,m)),512&f.flags&&(f.check=s(f.check,I,ne,M)),b-=ne,M+=ne,f.length-=ne),f.length))break e;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(b===0)break e;for(ne=0;m=I[M+ne++],f.head&&m&&f.length<65536&&(f.head.name+=String.fromCharCode(m)),m&&ne<b;);if(512&f.flags&&(f.check=s(f.check,I,ne,M)),b-=ne,M+=ne,m)break e}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(b===0)break e;for(ne=0;m=I[M+ne++],f.head&&m&&f.length<65536&&(f.head.comment+=String.fromCharCode(m)),m&&ne<b;);if(512&f.flags&&(f.check=s(f.check,I,ne,M)),b-=ne,M+=ne,m)break e}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;R<16;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(O!==(65535&f.check)){T.msg="header crc mismatch",f.mode=30;break}R=O=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),T.adler=f.check=0,f.mode=12;break;case 10:for(;R<32;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}T.adler=f.check=g(O),R=O=0,f.mode=11;case 11:if(f.havedict===0)return T.next_out=Q,T.avail_out=W,T.next_in=M,T.avail_in=b,f.hold=O,f.bits=R,2;T.adler=f.check=1,f.mode=12;case 12:if(L===5||L===6)break e;case 13:if(f.last){O>>>=7&R,R-=7&R,f.mode=27;break}for(;R<3;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}switch(f.last=1&O,R-=1,3&(O>>>=1)){case 0:f.mode=14;break;case 1:if(B(f),f.mode=20,L!==6)break;O>>>=2,R-=2;break e;case 2:f.mode=17;break;case 3:T.msg="invalid block type",f.mode=30}O>>>=2,R-=2;break;case 14:for(O>>>=7&R,R-=7&R;R<32;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if((65535&O)!=(O>>>16^65535)){T.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&O,R=O=0,f.mode=15,L===6)break e;case 15:f.mode=16;case 16:if(ne=f.length){if(b<ne&&(ne=b),W<ne&&(ne=W),ne===0)break e;i.arraySet(q,I,M,ne,Q),b-=ne,M+=ne,W-=ne,Q+=ne,f.length-=ne;break}f.mode=12;break;case 17:for(;R<14;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(f.nlen=257+(31&O),O>>>=5,R-=5,f.ndist=1+(31&O),O>>>=5,R-=5,f.ncode=4+(15&O),O>>>=4,R-=4,286<f.nlen||30<f.ndist){T.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;R<3;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}f.lens[X[f.have++]]=7&O,O>>>=3,R-=3}for(;f.have<19;)f.lens[X[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,j={bits:f.lenbits},J=a(0,f.lens,0,19,f.lencode,0,f.work,j),f.lenbits=j.bits,J){T.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;pe=(E=f.lencode[O&(1<<f.lenbits)-1])>>>16&255,Ae=65535&E,!((_e=E>>>24)<=R);){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(Ae<16)O>>>=_e,R-=_e,f.lens[f.have++]=Ae;else{if(Ae===16){for(A=_e+2;R<A;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(O>>>=_e,R-=_e,f.have===0){T.msg="invalid bit length repeat",f.mode=30;break}m=f.lens[f.have-1],ne=3+(3&O),O>>>=2,R-=2}else if(Ae===17){for(A=_e+3;R<A;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}R-=_e,m=0,ne=3+(7&(O>>>=_e)),O>>>=3,R-=3}else{for(A=_e+7;R<A;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}R-=_e,m=0,ne=11+(127&(O>>>=_e)),O>>>=7,R-=7}if(f.have+ne>f.nlen+f.ndist){T.msg="invalid bit length repeat",f.mode=30;break}for(;ne--;)f.lens[f.have++]=m}}if(f.mode===30)break;if(f.lens[256]===0){T.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,j={bits:f.lenbits},J=a(l,f.lens,0,f.nlen,f.lencode,0,f.work,j),f.lenbits=j.bits,J){T.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,j={bits:f.distbits},J=a(c,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,j),f.distbits=j.bits,J){T.msg="invalid distances set",f.mode=30;break}if(f.mode=20,L===6)break e;case 20:f.mode=21;case 21:if(6<=b&&258<=W){T.next_out=Q,T.avail_out=W,T.next_in=M,T.avail_in=b,f.hold=O,f.bits=R,o(T,te),Q=T.next_out,q=T.output,W=T.avail_out,M=T.next_in,I=T.input,b=T.avail_in,O=f.hold,R=f.bits,f.mode===12&&(f.back=-1);break}for(f.back=0;pe=(E=f.lencode[O&(1<<f.lenbits)-1])>>>16&255,Ae=65535&E,!((_e=E>>>24)<=R);){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(pe&&(240&pe)==0){for(xe=_e,qe=pe,rt=Ae;pe=(E=f.lencode[rt+((O&(1<<xe+qe)-1)>>xe)])>>>16&255,Ae=65535&E,!(xe+(_e=E>>>24)<=R);){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}O>>>=xe,R-=xe,f.back+=xe}if(O>>>=_e,R-=_e,f.back+=_e,f.length=Ae,pe===0){f.mode=26;break}if(32&pe){f.back=-1,f.mode=12;break}if(64&pe){T.msg="invalid literal/length code",f.mode=30;break}f.extra=15&pe,f.mode=22;case 22:if(f.extra){for(A=f.extra;R<A;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}f.length+=O&(1<<f.extra)-1,O>>>=f.extra,R-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;pe=(E=f.distcode[O&(1<<f.distbits)-1])>>>16&255,Ae=65535&E,!((_e=E>>>24)<=R);){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if((240&pe)==0){for(xe=_e,qe=pe,rt=Ae;pe=(E=f.distcode[rt+((O&(1<<xe+qe)-1)>>xe)])>>>16&255,Ae=65535&E,!(xe+(_e=E>>>24)<=R);){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}O>>>=xe,R-=xe,f.back+=xe}if(O>>>=_e,R-=_e,f.back+=_e,64&pe){T.msg="invalid distance code",f.mode=30;break}f.offset=Ae,f.extra=15&pe,f.mode=24;case 24:if(f.extra){for(A=f.extra;R<A;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}f.offset+=O&(1<<f.extra)-1,O>>>=f.extra,R-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){T.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(W===0)break e;if(ne=te-W,f.offset>ne){if((ne=f.offset-ne)>f.whave&&f.sane){T.msg="invalid distance too far back",f.mode=30;break}ve=ne>f.wnext?(ne-=f.wnext,f.wsize-ne):f.wnext-ne,ne>f.length&&(ne=f.length),Ie=f.window}else Ie=q,ve=Q-f.offset,ne=f.length;for(W<ne&&(ne=W),W-=ne,f.length-=ne;q[Q++]=Ie[ve++],--ne;);f.length===0&&(f.mode=21);break;case 26:if(W===0)break e;q[Q++]=f.length,W--,f.mode=21;break;case 27:if(f.wrap){for(;R<32;){if(b===0)break e;b--,O|=I[M++]<<R,R+=8}if(te-=W,T.total_out+=te,f.total+=te,te&&(T.adler=f.check=f.flags?s(f.check,q,te,Q-te):r(f.check,q,te,Q-te)),te=W,(f.flags?O:g(O))!==f.check){T.msg="incorrect data check",f.mode=30;break}R=O=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;R<32;){if(b===0)break e;b--,O+=I[M++]<<R,R+=8}if(O!==(4294967295&f.total)){T.msg="incorrect length check",f.mode=30;break}R=O=0}f.mode=29;case 29:J=1;break e;case 30:J=-3;break e;case 31:return-4;case 32:default:return u}return T.next_out=Q,T.avail_out=W,T.next_in=M,T.avail_in=b,f.hold=O,f.bits=R,(f.wsize||te!==T.avail_out&&f.mode<30&&(f.mode<27||L!==4))&&G(T,T.output,T.next_out,te-T.avail_out)?(f.mode=31,-4):(ee-=T.avail_in,te-=T.avail_out,T.total_in+=ee,T.total_out+=te,f.total+=te,f.wrap&&te&&(T.adler=f.check=f.flags?s(f.check,q,te,T.next_out-te):r(f.check,q,te,T.next_out-te)),T.data_type=f.bits+(f.last?64:0)+(f.mode===12?128:0)+(f.mode===20||f.mode===15?256:0),(ee==0&&te===0||L===4)&&J===h&&(J=-5),J)},n.inflateEnd=function(T){if(!T||!T.state)return u;var L=T.state;return L.window&&(L.window=null),T.state=null,h},n.inflateGetHeader=function(T,L){var f;return T&&T.state?(2&(f=T.state).wrap)==0?u:((f.head=L).done=!1,h):u},n.inflateSetDictionary=function(T,L){var f,I=L.length;return T&&T.state?(f=T.state).wrap!==0&&f.mode!==11?u:f.mode===11&&r(1,L,I,0)!==f.check?-3:G(T,L,I,I)?(f.mode=31,-4):(f.havedict=1,h):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,n){"use strict";var i=t("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(l,c,h,u,d,p,_,g){var y,v,w,S,x,P,F,C,B,G=g.bits,T=0,L=0,f=0,I=0,q=0,M=0,Q=0,b=0,W=0,O=0,R=null,ee=0,te=new i.Buf16(16),ne=new i.Buf16(16),ve=null,Ie=0;for(T=0;T<=15;T++)te[T]=0;for(L=0;L<u;L++)te[c[h+L]]++;for(q=G,I=15;1<=I&&te[I]===0;I--);if(I<q&&(q=I),I===0)return d[p++]=20971520,d[p++]=20971520,g.bits=1,0;for(f=1;f<I&&te[f]===0;f++);for(q<f&&(q=f),T=b=1;T<=15;T++)if(b<<=1,(b-=te[T])<0)return-1;if(0<b&&(l===0||I!==1))return-1;for(ne[1]=0,T=1;T<15;T++)ne[T+1]=ne[T]+te[T];for(L=0;L<u;L++)c[h+L]!==0&&(_[ne[c[h+L]]++]=L);if(P=l===0?(R=ve=_,19):l===1?(R=r,ee-=257,ve=s,Ie-=257,256):(R=o,ve=a,-1),T=f,x=p,Q=L=O=0,w=-1,S=(W=1<<(M=q))-1,l===1&&852<W||l===2&&592<W)return 1;for(;;){for(F=T-Q,B=_[L]<P?(C=0,_[L]):_[L]>P?(C=ve[Ie+_[L]],R[ee+_[L]]):(C=96,0),y=1<<T-Q,f=v=1<<M;d[x+(O>>Q)+(v-=y)]=F<<24|C<<16|B|0,v!==0;);for(y=1<<T-1;O&y;)y>>=1;if(y!==0?(O&=y-1,O+=y):O=0,L++,--te[T]==0){if(T===I)break;T=c[h+_[L]]}if(q<T&&(O&S)!==w){for(Q===0&&(Q=q),x+=f,b=1<<(M=T-Q);M+Q<I&&!((b-=te[M+Q])<=0);)M++,b<<=1;if(W+=1<<M,l===1&&852<W||l===2&&592<W)return 1;d[w=O&S]=q<<24|M<<16|x-p|0}}return O!==0&&(d[x+O]=T-Q<<24|64<<16|0),g.bits=q,0}},{"../utils/common":41}],51:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,n){"use strict";var i=t("../utils/common"),r=0,s=1;function o(E){for(var z=E.length;0<=--z;)E[z]=0}var a=0,l=29,c=256,h=c+1+l,u=30,d=19,p=2*h+1,_=15,g=16,y=7,v=256,w=16,S=17,x=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(h+2));o(G);var T=new Array(2*u);o(T);var L=new Array(512);o(L);var f=new Array(256);o(f);var I=new Array(l);o(I);var q,M,Q,b=new Array(u);function W(E,z,X,K,H){this.static_tree=E,this.extra_bits=z,this.extra_base=X,this.elems=K,this.max_length=H,this.has_stree=E&&E.length}function O(E,z){this.dyn_tree=E,this.max_code=0,this.stat_desc=z}function R(E){return E<256?L[E]:L[256+(E>>>7)]}function ee(E,z){E.pending_buf[E.pending++]=255&z,E.pending_buf[E.pending++]=z>>>8&255}function te(E,z,X){E.bi_valid>g-X?(E.bi_buf|=z<<E.bi_valid&65535,ee(E,E.bi_buf),E.bi_buf=z>>g-E.bi_valid,E.bi_valid+=X-g):(E.bi_buf|=z<<E.bi_valid&65535,E.bi_valid+=X)}function ne(E,z,X){te(E,X[2*z],X[2*z+1])}function ve(E,z){for(var X=0;X|=1&E,E>>>=1,X<<=1,0<--z;);return X>>>1}function Ie(E,z,X){var K,H,Z=new Array(_+1),ce=0;for(K=1;K<=_;K++)Z[K]=ce=ce+X[K-1]<<1;for(H=0;H<=z;H++){var D=E[2*H+1];D!==0&&(E[2*H]=ve(Z[D]++,D))}}function _e(E){var z;for(z=0;z<h;z++)E.dyn_ltree[2*z]=0;for(z=0;z<u;z++)E.dyn_dtree[2*z]=0;for(z=0;z<d;z++)E.bl_tree[2*z]=0;E.dyn_ltree[2*v]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function pe(E){8<E.bi_valid?ee(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function Ae(E,z,X,K){var H=2*z,Z=2*X;return E[H]<E[Z]||E[H]===E[Z]&&K[z]<=K[X]}function xe(E,z,X){for(var K=E.heap[X],H=X<<1;H<=E.heap_len&&(H<E.heap_len&&Ae(z,E.heap[H+1],E.heap[H],E.depth)&&H++,!Ae(z,K,E.heap[H],E.depth));)E.heap[X]=E.heap[H],X=H,H<<=1;E.heap[X]=K}function qe(E,z,X){var K,H,Z,ce,D=0;if(E.last_lit!==0)for(;K=E.pending_buf[E.d_buf+2*D]<<8|E.pending_buf[E.d_buf+2*D+1],H=E.pending_buf[E.l_buf+D],D++,K===0?ne(E,H,z):(ne(E,(Z=f[H])+c+1,z),(ce=P[Z])!==0&&te(E,H-=I[Z],ce),ne(E,Z=R(--K),X),(ce=F[Z])!==0&&te(E,K-=b[Z],ce)),D<E.last_lit;);ne(E,v,z)}function rt(E,z){var X,K,H,Z=z.dyn_tree,ce=z.stat_desc.static_tree,D=z.stat_desc.has_stree,Y=z.stat_desc.elems,re=-1;for(E.heap_len=0,E.heap_max=p,X=0;X<Y;X++)Z[2*X]!==0?(E.heap[++E.heap_len]=re=X,E.depth[X]=0):Z[2*X+1]=0;for(;E.heap_len<2;)Z[2*(H=E.heap[++E.heap_len]=re<2?++re:0)]=1,E.depth[H]=0,E.opt_len--,D&&(E.static_len-=ce[2*H+1]);for(z.max_code=re,X=E.heap_len>>1;1<=X;X--)xe(E,Z,X);for(H=Y;X=E.heap[1],E.heap[1]=E.heap[E.heap_len--],xe(E,Z,1),K=E.heap[1],E.heap[--E.heap_max]=X,E.heap[--E.heap_max]=K,Z[2*H]=Z[2*X]+Z[2*K],E.depth[H]=(E.depth[X]>=E.depth[K]?E.depth[X]:E.depth[K])+1,Z[2*X+1]=Z[2*K+1]=H,E.heap[1]=H++,xe(E,Z,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(ae,Te){var Ke,Ye,k,U,N,se,le=Te.dyn_tree,ye=Te.max_code,Pe=Te.stat_desc.static_tree,Re=Te.stat_desc.has_stree,Ee=Te.stat_desc.extra_bits,et=Te.stat_desc.extra_base,dt=Te.stat_desc.max_length,tt=0;for(U=0;U<=_;U++)ae.bl_count[U]=0;for(le[2*ae.heap[ae.heap_max]+1]=0,Ke=ae.heap_max+1;Ke<p;Ke++)dt<(U=le[2*le[2*(Ye=ae.heap[Ke])+1]+1]+1)&&(U=dt,tt++),le[2*Ye+1]=U,ye<Ye||(ae.bl_count[U]++,N=0,et<=Ye&&(N=Ee[Ye-et]),se=le[2*Ye],ae.opt_len+=se*(U+N),Re&&(ae.static_len+=se*(Pe[2*Ye+1]+N)));if(tt!==0){do{for(U=dt-1;ae.bl_count[U]===0;)U--;ae.bl_count[U]--,ae.bl_count[U+1]+=2,ae.bl_count[dt]--,tt-=2}while(0<tt);for(U=dt;U!==0;U--)for(Ye=ae.bl_count[U];Ye!==0;)ye<(k=ae.heap[--Ke])||(le[2*k+1]!==U&&(ae.opt_len+=(U-le[2*k+1])*le[2*k],le[2*k+1]=U),Ye--)}}(E,z),Ie(Z,re,E.bl_count)}function m(E,z,X){var K,H,Z=-1,ce=z[1],D=0,Y=7,re=4;for(ce===0&&(Y=138,re=3),z[2*(X+1)+1]=65535,K=0;K<=X;K++)H=ce,ce=z[2*(K+1)+1],++D<Y&&H===ce||(D<re?E.bl_tree[2*H]+=D:H!==0?(H!==Z&&E.bl_tree[2*H]++,E.bl_tree[2*w]++):D<=10?E.bl_tree[2*S]++:E.bl_tree[2*x]++,Z=H,re=(D=0)===ce?(Y=138,3):H===ce?(Y=6,3):(Y=7,4))}function J(E,z,X){var K,H,Z=-1,ce=z[1],D=0,Y=7,re=4;for(ce===0&&(Y=138,re=3),K=0;K<=X;K++)if(H=ce,ce=z[2*(K+1)+1],!(++D<Y&&H===ce)){if(D<re)for(;ne(E,H,E.bl_tree),--D!=0;);else H!==0?(H!==Z&&(ne(E,H,E.bl_tree),D--),ne(E,w,E.bl_tree),te(E,D-3,2)):D<=10?(ne(E,S,E.bl_tree),te(E,D-3,3)):(ne(E,x,E.bl_tree),te(E,D-11,7));Z=H,re=(D=0)===ce?(Y=138,3):H===ce?(Y=6,3):(Y=7,4)}}o(b);var j=!1;function A(E,z,X,K){te(E,(a<<1)+(K?1:0),3),function(H,Z,ce,D){pe(H),D&&(ee(H,ce),ee(H,~ce)),i.arraySet(H.pending_buf,H.window,Z,ce,H.pending),H.pending+=ce}(E,z,X,!0)}n._tr_init=function(E){j||(function(){var z,X,K,H,Z,ce=new Array(_+1);for(H=K=0;H<l-1;H++)for(I[H]=K,z=0;z<1<<P[H];z++)f[K++]=H;for(f[K-1]=H,H=Z=0;H<16;H++)for(b[H]=Z,z=0;z<1<<F[H];z++)L[Z++]=H;for(Z>>=7;H<u;H++)for(b[H]=Z<<7,z=0;z<1<<F[H]-7;z++)L[256+Z++]=H;for(X=0;X<=_;X++)ce[X]=0;for(z=0;z<=143;)G[2*z+1]=8,z++,ce[8]++;for(;z<=255;)G[2*z+1]=9,z++,ce[9]++;for(;z<=279;)G[2*z+1]=7,z++,ce[7]++;for(;z<=287;)G[2*z+1]=8,z++,ce[8]++;for(Ie(G,h+1,ce),z=0;z<u;z++)T[2*z+1]=5,T[2*z]=ve(z,5);q=new W(G,P,c+1,h,_),M=new W(T,F,0,u,_),Q=new W(new Array(0),C,0,d,y)}(),j=!0),E.l_desc=new O(E.dyn_ltree,q),E.d_desc=new O(E.dyn_dtree,M),E.bl_desc=new O(E.bl_tree,Q),E.bi_buf=0,E.bi_valid=0,_e(E)},n._tr_stored_block=A,n._tr_flush_block=function(E,z,X,K){var H,Z,ce=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(D){var Y,re=4093624447;for(Y=0;Y<=31;Y++,re>>>=1)if(1&re&&D.dyn_ltree[2*Y]!==0)return r;if(D.dyn_ltree[18]!==0||D.dyn_ltree[20]!==0||D.dyn_ltree[26]!==0)return s;for(Y=32;Y<c;Y++)if(D.dyn_ltree[2*Y]!==0)return s;return r}(E)),rt(E,E.l_desc),rt(E,E.d_desc),ce=function(D){var Y;for(m(D,D.dyn_ltree,D.l_desc.max_code),m(D,D.dyn_dtree,D.d_desc.max_code),rt(D,D.bl_desc),Y=d-1;3<=Y&&D.bl_tree[2*B[Y]+1]===0;Y--);return D.opt_len+=3*(Y+1)+5+5+4,Y}(E),H=E.opt_len+3+7>>>3,(Z=E.static_len+3+7>>>3)<=H&&(H=Z)):H=Z=X+5,X+4<=H&&z!==-1?A(E,z,X,K):E.strategy===4||Z===H?(te(E,2+(K?1:0),3),qe(E,G,T)):(te(E,4+(K?1:0),3),function(D,Y,re,ae){var Te;for(te(D,Y-257,5),te(D,re-1,5),te(D,ae-4,4),Te=0;Te<ae;Te++)te(D,D.bl_tree[2*B[Te]+1],3);J(D,D.dyn_ltree,Y-1),J(D,D.dyn_dtree,re-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,ce+1),qe(E,E.dyn_ltree,E.dyn_dtree)),_e(E),K&&pe(E)},n._tr_tally=function(E,z,X){return E.pending_buf[E.d_buf+2*E.last_lit]=z>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&z,E.pending_buf[E.l_buf+E.last_lit]=255&X,E.last_lit++,z===0?E.dyn_ltree[2*X]++:(E.matches++,z--,E.dyn_ltree[2*(f[X]+c+1)]++,E.dyn_dtree[2*R(z)]++),E.last_lit===E.lit_bufsize-1},n._tr_align=function(E){te(E,2,3),ne(E,v,G),function(z){z.bi_valid===16?(ee(z,z.bi_buf),z.bi_buf=0,z.bi_valid=0):8<=z.bi_valid&&(z.pending_buf[z.pending++]=255&z.bi_buf,z.bi_buf>>=8,z.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,n){(function(i){(function(r,s){"use strict";if(!r.setImmediate){var o,a,l,c,h=1,u={},d=!1,p=r.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(r);_=_&&_.setTimeout?_:r,o={}.toString.call(r.process)==="[object process]"?function(w){process.nextTick(function(){y(w)})}:function(){if(r.postMessage&&!r.importScripts){var w=!0,S=r.onmessage;return r.onmessage=function(){w=!1},r.postMessage("","*"),r.onmessage=S,w}}()?(c="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",v,!1):r.attachEvent("onmessage",v),function(w){r.postMessage(c+w,"*")}):r.MessageChannel?((l=new MessageChannel).port1.onmessage=function(w){y(w.data)},function(w){l.port2.postMessage(w)}):p&&"onreadystatechange"in p.createElement("script")?(a=p.documentElement,function(w){var S=p.createElement("script");S.onreadystatechange=function(){y(w),S.onreadystatechange=null,a.removeChild(S),S=null},a.appendChild(S)}):function(w){setTimeout(y,0,w)},_.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var S=new Array(arguments.length-1),x=0;x<S.length;x++)S[x]=arguments[x+1];var P={callback:w,args:S};return u[h]=P,o(h),h++},_.clearImmediate=g}function g(w){delete u[w]}function y(w){if(d)setTimeout(y,0,w);else{var S=u[w];if(S){d=!0;try{(function(x){var P=x.callback,F=x.args;switch(F.length){case 0:P();break;case 1:P(F[0]);break;case 2:P(F[0],F[1]);break;case 3:P(F[0],F[1],F[2]);break;default:P.apply(s,F)}})(S)}finally{g(w),d=!1}}}}function v(w){w.source===r&&typeof w.data=="string"&&w.data.indexOf(c)===0&&y(+w.data.slice(c.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});var ya=["404","account","account-actions","beta","browser-themes","changelog","coronavirus","feedback-historical","feedback","index-historical","index","login","my-maps","my-palette","premium","privacy-policy-historical","privacy-policy","showcase","terms-historical","terms","tutorial","tutorial-premium","welcome"],Yf=window.location.hostname.replace("www.",""),Ws=["Scotland","Wales","England","Northern_Ireland"],Sc=["world-1815","coronavirus","world-1880","world-1914","world-1938","world-cold-war","oceania-detailed","tamriel","asia-detailed","africa-detailed","americas-detailed","detworld","usa-counties","russia","world","europe-detailed","usa-congressional-districts","canada-census-divisions","france-departments","usa-historical","world-subdivisions","oceania-detailed","indonesia","world-advanced","wargames","turkey","australia-electoral-divisions","canada-federal-ridings","europe-nuts2","europe-nuts3","world-pacific","germany-districts","brazil-municipalities","hearts-of-iron-iv"],Ec=["usa-counties","usa-congressional-districts","usa-hex-cartogram","europe-nuts2","europe-nuts3"],Zf=["rivers","timezones","geographic_lines","lakes","graticules","city_labels","State_borders","sidemap","sidemap2","state_abbr","state_lines","Department_Names","Department_Numbers","Prefecture_Names","Cities","pattern0","pattern1","pattern2","pattern3","pattern4","pattern5"],ui=[["f7fcfd","e5f5f9","ccece6","99d8c9","66c2a4","41ae76","238b45","006d2c","00441b"],["f7fcf0","e0f3db","ccebc5","a8ddb5","7bccc4","4eb3d3","2b8cbe","0868ac","084081"],["ffffd9","edf8b1","c7e9b4","7fcdbb","41b6c4","1d91c0","225ea8","253494","081d58"],["fff7fb","ece7f2","d0d1e6","a6bddb","74a9cf","3690c0","0570b0","045a8d","023858"],["fff7ec","fee8c8","fdd49e","fdbb84","fc8d59","ef6548","d7301f","b30000","7f0000"],["ffffcc","ffeda0","fed976","feb24c","fd8d3c","fc4e2a","e31a1c","bd0026","800026"],["f7fcfd","e0ecf4","bfd3e6","9ebcda","8c96c6","8c6bb1","88419d","810f7c","4d004b"],["ffffff","f0f0f0","d9d9d9","bdbdbd","969696","737373","525252","252525","000000"],["8c510a","bf812d","dfc27d","f6e8c3","f5f5f5","c7eae5","80cdc1","35978f","01665e"],["b2182b","d6604d","f4a582","fddbc7","f7f7f7","d1e5f0","92c5de","4393c3","2166ac"],["d73027","f46d43","fdae61","fee090","ffffbf","e0f3f8","abd9e9","74add1","4575b4"],["762a83","9970ab","c2a5cf","e7d4e8","f7f7f7","d9f0d3","a6dba0","5aae61","1b7837"],["013f3f","008080","70a494","b4c8a8","f6edbd","edbb8a","de8a5a","ca562c","bd3200"],["005251","009392","39b185","9ccb86","e9e29c","eeb479","e88471","cf597e","aa1f4b"],["5f4690","1d6996","38a6a5","0f8554","73af48","edad08","e17c05","cc503e","94346e"],["a6cee3","1f78b4","b2df8a","33a02c","fb9a99","e31a1c","fdbf6f","ff7f00","cab2d6"],["e41a1c","377eb8","4daf4a","984ea3","ff7f00","ffff33","a65628","f781bf","999999"],["8dd3c7","ffffb3","bebada","fb8072","80b1d3","fdb462","b3de69","fccde5","d9d9d9"],["fbb4ae","b3cde3","ccebc5","decbe4","fed9a6","ffffcc","e5d8bd","fddaec","f2f2f2"],["a03500","d9b400","3264c8","72b38e","986ba1","b9a087","4c91bf","cc3333","d1dbdd"]],Jf=[["fffffa","f0f0f0","d9d9d9","bdbdbd","969696","737373","525252","252525","000000"],["00441b","084081","081d58","023858","7f0000","800026","4d004b","013f3f","413a3a"],["e0f3f8","d1e5f0","ffffd9","e5f5f9","fff7ec","ffffcc","e5d8bd","fddaec","ffffff"]],Xf=[["f7fcfd","e5f5f9","ccece6","99d8c9","66c2a4","41ae76","238b45","006d2c","00441b"],["ffffd9","edf8b1","c7e9b4","7fcdbb","41b6c4","1d91c0","225ea8","253494","081d58"],["ffffcc","ffeda0","fed976","feb24c","fd8d3c","fc4e2a","e31a1c","bd0026","800026"],["f7fcfd","e0ecf4","bfd3e6","9ebcda","8c96c6","8c6bb1","88419d","810f7c","4d004b"],["5f4690","1d6996","38a6a5","0f8554","73af48","edad08","e17c05","cc503e","94346e"],["a6cee3","1f78b4","b2df8a","33a02c","fb9a99","e31a1c","fdbf6f","ff7f00","cab2d6"],["e41a1c","377eb8","4daf4a","984ea3","ff7f00","ffff33","a65628","f781bf","999999"],["8dd3c7","ffffb3","bebada","fb8072","80b1d3","fdb462","b3de69","fccde5","d9d9d9"],["a03500","d9b400","3264c8","72b38e","986ba1","b9a087","4c91bf","cc3333","0868ac"],["ffffff","f0f0f0","d9d9d9","bdbdbd","969696","737373","525252","252525","000000"]],Qf=[["bed2ff","97dbf2","bee8ff","d3ffbe","e9ffbe","ffffbe","ffeabe","f5ca7a","cdaa66"],["9c9c9c","e1e1e1","f7fcf0","f7fcfd","f0f0f0","ffeff7","ffffe5","ffffff","000000"],["ccbed2ff","cc97dbf2","ccbee8ff","ccd3ffbe","cce9ffbe","ccffffbe","ccffeabe","ccf5ca7a","cccdaa66"],["cc9c9c9c","cce1e1e1","ccf7fcf0","ccf7fcfd","ccf0f0f0","ccffeff7","ccffffe5","ccffffff","00000000"]],Cc=[["a6cee3","1f78b4","b2df8a","33a02c","fb9a99","e31c2c","fdbf6f","ff7f00","cab2d6"],["fbb4ae","e41a1c","377eb8","4daf4a","984ea3","ff2000","ffff33","a65628","999999"],["8dd3c7","ffffb3","bebada","fb8072","80b1d3","fdb462","b3de69","fccde5","ffa07a"],["b15928","6a3d9a","ffed6f","9e0142","5e4fa2","ffffbf","1a9850","4d4d4d","6baed6"],["71c671","388e8e","7d9ec0","7171c6","8e388e","8e8e38","00c957","cc3333","d1dbdd"],["ffffff","f0f0f0","d9d9d9","bdbdbd","969696","737373","525252","252525","000000"]],ep=[["ffffff","f0f0f0","d9d9d9","bdbdbd","969696","737373","525252","252525","000000"],["00441b","084081","081d58","023858","7f0000","800026","4d004b","013f3f","413a3a"],["e0f3f8","d1e5f0","ffffd9","e5f5f9","fff7ec","ffffcc","e5d8bd","fddaec","d1dbdd"]],tp=['<pattern id="circles3" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff" />    <circle cx="4" cy="4" r="2" fill="#000"/>    </pattern>','<pattern id="diagonal1" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff"/>    <path id="pattern0" d="M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2" stroke="#000" stroke-width="1"/>    </pattern>','<pattern id="diagonal3" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff"/>    <path id="pattern1" d="M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2" stroke="#000" stroke-width="3"/>    </pattern>','<pattern id="vertical1" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff" />    <rect x="3" y="0" width="1" height="10" fill="#000" />    </pattern>','<pattern id="vertical3" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff" />    <rect x="3" y="0" width="3" height="10" fill="#000" />    </pattern>','<pattern id="horizontal1" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff" />    <rect x="0" y="4" width="10" height="1" fill="#000" />    </pattern>','<pattern id="horizontal3" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff" />    <rect x="0" y="4" width="10" height="3" fill="#000" />    </pattern>','<pattern id="crosshatch" width="8" height="8" patternUnits="userSpaceOnUse">    <rect width="8" height="8" fill="#fff"/>    <path id="pattern2" d="M0 0L8 8ZM8 0L0 8Z" stroke-width="0.5" stroke="#aaa"/>    </pattern>','<pattern id="subtlepatch" width="5" height="5" patternUnits="userSpaceOnUse">    <rect width="5" height="5" fill="#fff" />    <rect x="2" y="2" width="1" height="1" fill="#000" />    </pattern>','<pattern id="checkers" width="8" height="8" patternUnits="userSpaceOnUse">    <rect width="8" height="8" fill="#fff"/>    <path id="pattern3" fill="#000" fill-rule="evenodd" d="M0 0h4v4H0V0zm4 4h4v4H4V4z"/>    </pattern>','<pattern id="raindrops" width="10" height="10" patternUnits="userSpaceOnUse">    <rect width="10" height="10" fill="#fff"/>    <path id="pattern4" fill="#000" d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/>    </pattern>','<pattern id="texture" width="4" height="4" patternUnits="userSpaceOnUse">    <rect width="4" height="4" fill="#fff"/>    <path id="pattern5" fill="#000" d="M1 3h1v1H1V3zm2-2h1v1H3V1z"></path>    </pattern>'],np={Arial:"Arial, 'DejaVu Sans', 'Liberation Sans', Freesans, sans-serif","Century Gothic":"'Century Gothic', futura, 'URW Gothic L', Verdana, sans-serif",Consolas:"Consolas, 'Lucida Console', 'DejaVu Sans Mono', monospace",Georgia:"Constantina, Georgia, 'Nimbus Roman No9 L', serif",Helvetica:"Helvetica, Arial, 'DejaVu Sans', 'Liberation Sans', Freesans, sans-serif",Impact:"Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif",Lucida:"'Lucida Sans Unicode','Lucida Grande', 'Lucida Sans', 'DejaVu Sans Condensed', sans-serif"},ba={Arial:{category:"sans-serif",variants:"400,400i,600,600i"},"Century Gothic":{category:"sans-serif",variants:"400,400i,600,600i"},Consolas:{category:"serif",variants:"400,400i,600,600i"},Georgia:{category:"serif",variants:"400,400i,600,600i"},Helvetica:{category:"sans-serif",variants:"400,400i,600,600i"},Impact:{category:"sans-serif",variants:"400,400i,600,600i"},Verdana:{category:"sans-serif",variants:"400,400i,600,600i"}},Tc={FYROM:"North_Macedonia",Guadelupe__NM:"Guadalupe__NM",Grand_Treverse__MI:"Grand_Traverse__MI",Orandge__FL:"Orange__FL",Monacco:"Monaco",McKinely__NM:"McKinley__NM",Shannon__SD:"Oglala_Lakota__SD",Lichtenstein:"Liechtenstein",Luxemburg:"Luxembourg",Palestinian_Territories:"Palestinian_Territories",Gasconage__MO:"Gasconade__MO",Fairbanks_North_Stark__AK:"Fairbanks_North_Star__AK",La_Salle__LA:"LaSalle__LA",Wade_Hampton__AK:"Kusilvak__AK",Albermarle__VA:"Albemarle__VA",Donough__IL:"McDonough__IL",Onodaga__NY:"Onondaga__NY",Grand__SD:"Grant__SD",MAtera:"Matera",Moldavia:"Moldova",Tynisia:"Tunisia",Czech_Republic:"Czechia",Mayote:"Mayotte",Federated_States_of_Micronisia:"Federated_States_of_Micronesia",Maga_Buryatdan_RU:"Magadan_RU",Zinguldak_TR:"Zonguldak_TR",Zinguldak:"Zonguldak",San_Franciso__CA:"San_Francisco__CA",Mitchcell__IA:"Mitchell__IA",Kingsburg__SD:"Kingsbury__SD",Swaziland:"Eswatini",Lake_FL:"Lake__FL",Summit_UT:"Summit__UT",Lyon_NV:"Lyon__NV",Chittenden_VT:"Chittenden__VT",Astana_KZ:"Nursultan_KZ",England_UK:"Leicestershire_UK",Hasaka:"Hasaka_SY",Tyva_Republic:"Tuva_Republic","Northern Areas_PK":"Gilgit_Baltistan_PK",F_C_T__PK:"Islamabad_Capital_Territory",F_A_T_A__PK:"Khyber_Pakhtunkhwa_PK",Finstr\u00F6m_FI:"\xC5land_Islands_FI",Southern_Finland_FI:"Kymenlaakso_FI","Eastern Finland_FI":"Northern_Savonia_FI",Halton_UK:"Wirral_UK",Moat_Caitlin:"Moat_Cailin",Snakewoods:"Snakewood",Harlaw:"Ten Towers",Iron_Oaks:"Ironoaks",Strong_Song:"Strongsong","Matanuska-Susitna__AK":"Matanuska_Susitna__AK","Yukon-Koyukuk__AK":"Yukon_Koyukuk__AK","Valdez-Cordova__AK":"Copper_River__AK","Valdez-Cordova__AK":"Chugach__AK",Valdez_Cordova__AK:"Copper_River__AK",Valdez_Cordova__AK:"Chugach__AK","Miami-Dade__FL":"Miami_Dade__FL",MiamiDade__FL:"Miami_Dade__FL",BerwickuponTweed:"Berwick-upon-Tweed",Na_hEileanan_an_Iar:"Na_h-Eileanan_an_Iar",AldridgeBrownhills:"Aldridge-Brownhills",Montseratt:"Montserrat",USA_Massachussetts:"USA_Massachusetts",Osterode_am_Harz:"G\xF6ttingen",Great_Britain:"United_Kingdom",Dadra_and_Nagar_Haveli_IN:"Dadra_and_Nagar_Haveli_and_Daman_and_Diu_IN",Daman_and_Diu_IN:"Dadra_and_Nagar_Haveli_and_Daman_and_Diu_IN",Dadra_and_Nagar_Haveli:"Dadra_and_Nagar_Haveli_and_Daman_and_Diu",Daman_and_Diu:"Dadra_and_Nagar_Haveli_and_Daman_and_Diu",PA1:"PA01",PA2:"PA02",PA3:"PA03",PA4:"PA04",PA5:"PA05",PA6:"PA06",PA7:"PA07",PA8:"PA08",PA9:"PA09",Kazhakstan:"Kazakhstan",Kuna_Yala_PA:"Guna_Yala_PA",Cape_Verde:"Cabo_Verde",Northfolk:"Norfolk",Wallis_and_Fortuna_WF:"Wallis_and_Futuna_WF",Butan:"Bhutan",Beemster:"Purmerend",Appingedam:"Eemsdelta",Delfzijl:"Eemsdelta",Loppersum:"Eemsdelta",Boxmeer:"Land_van_Cuijk",Cuijk:"Land_van_Cuijk",Sint_Anthonis:"Land_van_Cuijk",Mill_en_Sint_Hubert:"Land_van_Cuijk",Grave:"Land_van_Cuijk",Landerd:"Maashorst",Uden:"Maashorst",Heerhugowaard:"Dijk_en_Waard",Langedijk:"Dijk_en_Waard",Nuenen_c_a_:"Nuenen_Gerwen_en_Nederwetten",Weesp:"Amsterdam",Arderbil_IR:"Ardabil_IR",Kordestan_IR:"Kurdistan_IR",Esfahan_IR:"Isfahan_IR",West_Azarbaijan_IR:"West_Azerbaijan_IR",East_Azarbaijan_IR:"East_Azerbaijan_IR",FYROM:"North_Macedonia",Monacco:"Monaco",Lichtenstein:"Liechtenstein",Luxemburg:"Luxembourg",Palestinian_Territories:"Palestinian_Territories",MAtera:"Matera",Moldavia:"Moldova",Tynisia:"Tunisia",Czech_Republic:"Czechia",Mayote:"Mayotte",Federated_States_of_Micronisia:"Federated_States_of_Micronesia",Swaziland:"Eswatini",Gambia__The:"The_Gambia",Kingdom_of_Brazil:"Empire_of_Brazil",Saint_Barth__lemy:"Saint_Barth\xE9lemy",Ayion_Oros_GR:"Agion_Oros_GR",Arkhangel_sk_RU:"Arkhangel\u2019sk_RU","Ivano-Frankivs_k_UA":"Ivano-Frankivsk_UA",Khmel_nyts_kyy_UA:"Khmelnytskyi_UA",L_viv_UA:"L\u2019viv_UA",Dnipropetrovs_k_UA:"Dnipropetrovsk_UA",Donets_k_UA:"Donetsk_UA",Luhans_k_UA:"Luhansk_UA",Sja\u00E6lland_DK:"Sj\xE6lland_DK",Orebro_SE:"\xD6rebro_SE","Noardeast-Fryslan":"Noardeast-Frysl\xE2n","Sudwest-Fryslan":"Sudwest-Frysl\xE2n",Helstorm_Region:"Helstrom_Region",Stros_M_kai_Archipellago:"Stros_M\u2019kai_Archipelago","Caras-Severin_RO":"Cara\u0219-Severin_RO",Mehedinti_RO:"Mehedin\u021Bi_RO",Salaj_RO:"S\u0103laj_RO",Maramures_RO:"Maramure\u0219_RO","Bistrita-Nasaud_RO":"Bistri\u021Ba-N\u0103s\u0103ud_RO",Mures_RO:"Mure\u0219_RO",Brasov_RO:"Bra\u0219ov_RO",Arges_RO:"Arge\u0219_RO",D\u00E2mbovita_RO:"D\xE2mbovi\u021Ba_RO",Buzau_RO:"Buz\u0103u_RO",Braila_RO:"Br\u0103ila_RO",Ialomita_RO:"Ialomi\u021Ba_RO",Constanta_RO:"Constan\u021Ba_RO",Galati_RO:"Gala\u021Bi_RO",Bacau_RO:"Bac\u0103u_RO",Neamt_RO:"Neam\u021B_RO",Iasi_RO:"Ia\u0219i_RO",Botosani_RO:"Boto\u0219ani_RO",Ocnita_MD:"Ocni\u021Ba_MD",Donduseni_MD:"Dondu\u0219eni_MD",Edinet_MD:"Edine\u021B_MD",R\u00EEscani_MD:"R\xEE\u0219cani_MD",Balti_MD:"B\u0103l\u021Bi_MD",Falesti_MD:"F\u0103le\u0219ti_MD",Floresti_MD:"Flore\u0219ti_MD",Telenesti_MD:"Telene\u0219ti_MD",Calarasi_MD:"C\u0103l\u0103ra\u0219i_MD",Soldanesti_MD:"\u0218old\u0103ne\u0219ti_MD",Straseni_MD:"Str\u0103\u0219eni_MD",Chisinau_MD:"Chi\u0219in\u0103u_MD",H\u00EEncesti_MD:"H\xEEnce\u0219ti_MD",Cimislia_MD:"Cimi\u0219lia_MD",Causeni_MD:"C\u0103u\u0219eni_MD",Stefan_Voda_MD:"\u0218tefan_Vod\u0103_MD",Dubasari_MD:"Dub\u0103sari_OT",Dubasari_City_MD:"Dub\u0103sari_City_OT",Bender_MD:"Slobozia_OT",C\u0103inari_MD:"C\u0103u\u0219eni_MD",Transnistria_OT:"R\xEEbni\u021Ba_OT",Transnistria_MD:"Dub\u0103sari_City_OT",Camenca_MD:"Camenca_OT",Grigoriopol_MD:"Grigoriopol_OT",Calarasi_RO:"C\u0103l\u0103ra\u0219i_RO"},ip={AB:"Alberta",BC:"British Columbia",MB:"Manitoba",NB:"New Brunswick",NL:"Newfoundland and Labrador",NT:"Northwest Territories",NS:"Nova Scotia",NU:"Nunavut",ON:"Ontario",PE:"Prince Edward Island",QC:"Quebec",SK:"Saskatchewan",YT:"Yukon Territory",AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},rp={AQ:"Antarctica",AO:"Angola",BF:"Burkina Faso",BI:"Burundi",BJ:"Benin",BW:"Botswana",CD:"Democratic Republic of the Congo",CF:"Central African Republic",CG:"Congo",CI:"C\xF4te d'Ivoire",CM:"Cameroon",CV:"Cape Verde",DJ:"Djibouti",DZ:"Algeria",EG:"Egypt",EH:"Western Sahara",EL:"Greece",ER:"Eritrea",ET:"Ethiopia",GA:"Gabon",GH:"Ghana",GM:"Gambia",GN:"Guinea",GQ:"Equatorial Guinea",GS:"South Georgia and the South Sandwich Islands",GW:"Guinea-Bissau",KE:"Kenya",KM:"Comoros",LR:"Liberia",LS:"Lesotho",LY:"Libya",MA:"Morocco",MG:"Madagascar",ML:"Mali",MR:"Mauritania",MS:"Montserrat",MU:"Mauritius",MW:"Malawi",MZ:"Mozambique",NA:"Namibia",NE:"Niger",NG:"Nigeria",RW:"Rwanda",SC:"Seychelles",SD:"Sudan",SH:"Saint Helena",SL:"Sierra Leone",SN:"Senegal",SO:"Somalia",SS:"South Sudan",ST:"Sao Tome and Principe",SZ:"Eswatini",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TN:"Tunisia",TO:"Tonga",TZ:"United Republic of Tanzania",UG:"Uganda",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe",AG:"Antigua and Barbuda",AI:"Anguilla",AR:"Argentina",AW:"Aruba",BB:"Barbados",BL:"Saint Barth\xE9lemy",BM:"Bermuda",BO:"Bolivia",BR:"Brazil",BS:"Bahamas",BZ:"Belize",BQ:"Bonaire",CA:"Canada",CL:"Chile",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CW:"Curacao",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",FK:"Falkland Islands",GD:"Grenada",GF:"French Guiana",GL:"Greenland",GP:"Guadeloupe",GT:"Guatemala",GU:"Guam",GY:"Guyana",HN:"Honduras",HT:"Haiti",JM:"Jamaica",KN:"St Kitts and Nevis",KY:"Cayman Islands",LC:"St Lucia",MF:"St Martin",MQ:"Martinique",MX:"Mexico",NI:"Nicaragua",PA:"Panama",PE:"Peru",PM:"St Pierre and Miquelon",PR:"Puerto Rico",PY:"Paraguay",SR:"Suriname",SV:"El Salvador",SX:"Sint Maarten",TC:"Turks and Caicos Islands",TT:"Trinidad and Tobago",US:"United States",UY:"Uruguay",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"British Virgin Islands",VI:"U.S. Virgin Islands",AE:"United Arab Emirates",AF:"Afghanistan",AM:"Armenia",AZ:"Azerbaijan",BD:"Bangladesh",BH:"Bahrain",BN:"Brunei Darussalam",BT:"Bhutan",CN:"China",GE:"Georgia",HK:"Hong Kong",ID:"Indonesia",IL:"Israel",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran",JO:"Jordan",JP:"Japan",KG:"Kyrgyzstan",KH:"Cambodia",KP:"North Korea",KR:"Republic of Korea",KW:"Kuwait",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LK:"Sri Lanka",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MV:"Maldives",MY:"Malaysia",NP:"Nepal",OM:"Oman",PH:"Philippines",PK:"Pakistan",PS:"Palestine",QA:"Qatar",SA:"Saudi Arabia",SG:"Singapore",SY:"Syrian Arab Republic",TH:"Thailand",TJ:"Tajikistan",TL:"Timor-Leste",TM:"Turkmenistan",TR:"Turkey",TW:"Taiwan",UZ:"Uzbekistan",VN:"Vietnam",YE:"Yemen",AD:"Andorra",AL:"Albania",AT:"Austria",BA:"Bosnia and Herzegovina",BE:"Belgium",BG:"Bulgaria",BY:"Belarus",CH:"Switzerland",CY:"Cyprus",CZ:"Czechia",DE:"Germany",DK:"Denmark",EE:"Estonia",ES:"Spain",FI:"Finland",FO:"Faroe Islands",FR:"France",GR:"Greece",HR:"Croatia",HU:"Hungary",IE:"Ireland",IS:"Iceland",IT:"Italy",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MK:"North Macedonia",MT:"Malta",NL:"Netherlands",NO:"Norway",PL:"Poland",PT:"Portugal",RO:"Romania",RS:"Serbia",RU:"Russia",SE:"Sweden",SI:"Slovenia",SM:"San Marino",SK:"Slovakia",UA:"Ukraine",UK:"United Kingdom",VA:"Vatican",XK:"Kosovo",AU:"Australia",AS:"American Samoa",CK:"Cook Islands",FJ:"Fiji",FM:"Micronesia, Federated States of",HM:"Heard Island and McDonald Islands",KI:"Kiribati",MH:"Marshall Islands",MP:"Northern Mariana Islands",NR:"Nauru",NC:"New Caledonia",NF:"Norfolk Island",NZ:"New Zealand",NU:"Niue",PF:"French Polynesia",PG:"Papua New Guinea",PN:"Pitcairn Islands",PW:"Palau",SB:"Solomon Islands",TK:"Tokelau",TV:"Tuvalu",UM:"United States Minor Outlying Islands",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",OT:"Other, autonomous, etc."},sp={AC:"Acre",AL:"Alagoas",AP:"Amap\xE1",AM:"Amazonas",BA:"Bahia",CE:"Cear\xE1",DF:"Distrito Federal",ES:"Esp\xEDrito Santo",GO:"Goi\xE1s",MA:"Maranh\xE3o",MT:"MatoGrosso",MS:"MatoGrosso do Sul",MG:"Minas Gerais",PA:"Par\xE1",PB:"Para\xEDba",PR:"Paran\xE1",PE:"Pernambuco",PI:"Piau\xED",RJ:"Rio de Janeiro",RN:"Rio Grande do Norte",RS:"Rio Grande do Sul",RO:"Rond\xF4nia",RR:"Roraima",SC:"Santa Catarina",SP:"S\xE3o Paulo",SE:"Sergipe",TO:"Tocantins"},op={shapes:{legendPosition:"top_left",canvasW:4800,canvasH:4795},africa:{legendPosition:"bottom_left",canvasW:4800,canvasH:4795},"africa-detailed":{legendPosition:"bottom_left",canvasW:6300,canvasH:7e3},"americas-detailed":{legendPosition:"bottom_left",canvasW:6600,canvasH:6502},americas:{legendPosition:"bottom_left",canvasW:4752,canvasH:6203},argentina:{legendPosition:"bottom_right",canvasW:3720,canvasH:6174},"asia-detailed":{legendPosition:"bottom_left",canvasW:6930,canvasH:5291},asia:{legendPosition:"bottom_left",canvasW:5e3,canvasH:3975},"australia-electoral-divisions":{legendPosition:"top_right",canvasW:6600,canvasH:4502},australia:{legendPosition:"bottom_left",canvasW:6e3,canvasH:5556},belgium:{legendPosition:"bottom_left",canvasW:5200,canvasH:4380},brazil:{legendPosition:"bottom_left",canvasW:5e3,canvasH:4716},"brazil-municipalities":{legendPosition:"bottom_left",canvasW:5500,canvasH:5262},"canada-census-divisions":{legendPosition:"top_right",canvasW:6900,canvasH:3575},"canada-federal-ridings":{legendPosition:"top_right",canvasW:6600,canvasH:5500},canada:{legendPosition:"top_right",canvasW:4115,canvasH:3556},caribbean:{legendPosition:"top_right",canvasW:6e3,canvasH:3600},china:{legendPosition:"bottom_right",canvasW:5e3,canvasH:3520},detworld:{legendPosition:"bottom_left",canvasW:7192,canvasH:3318},"europe-detailed":{legendPosition:"top_left",canvasW:6480,canvasH:7480},"europe-nuts2":{legendPosition:"top_left",canvasW:6e3,canvasH:4650},"europe-nuts3":{legendPosition:"top_left",canvasW:6e3,canvasH:4650},europe:{legendPosition:"top_left",canvasW:4592,canvasH:3196},"france-departments":{legendPosition:"top_left",canvasW:6300,canvasH:6220},france:{legendPosition:"bottom_left",canvasW:4465,canvasH:3450},"germany-districts":{legendPosition:"bottom_right",canvasW:6300,canvasH:7e3},germany:{legendPosition:"bottom_right",canvasW:5825,canvasH:6465},greece:{legendPosition:"bottom_left",canvasW:3750,canvasH:3310},"hearts-of-iron-iv":{legendPosition:"bottom_left",canvasW:5400,canvasH:2055},india:{legendPosition:"top_right",canvasW:3818,canvasH:4600},indonesia:{legendPosition:"bottom_left",canvasW:4634,canvasH:2e3},italy:{legendPosition:"top_right",canvasW:5300,canvasH:6785},japan:{legendPosition:"top_left",canvasW:4560,canvasH:4688},mexico:{legendPosition:"top_right",canvasW:4340,canvasH:2800},"middle-east":{legendPosition:"bottom_left",canvasW:4e3,canvasH:4102},netherlands:{legendPosition:"top_left",canvasW:4290,canvasH:3809},"oceania-detailed":{legendPosition:"bottom_right",canvasW:6024,canvasH:4098},poland:{legendPosition:"bottom_left",canvasW:5268,canvasH:4542},portugal:{legendPosition:"top_left",canvasW:4468,canvasH:4500},russia:{legendPosition:"top_left",canvasW:6576,canvasH:3990},spain:{legendPosition:"bottom_left",canvasW:6415,canvasH:4215},sweden:{legendPosition:"bottom_right",canvasW:3900,canvasH:6690},tamriel:{legendPosition:"bottom_right",canvasW:6576,canvasH:4416},turkey:{legendPosition:"bottom_left",canvasW:6576,canvasH:3162},"uk-election":{legendPosition:"bottom_left",canvasW:5080,canvasH:4980},"uk-historic":{legendPosition:"top_left",canvasW:4765,canvasH:6400},"uk-postcodes":{legendPosition:"bottom_left",canvasW:4195,canvasH:6080},uk:{legendPosition:"top_left",canvasW:4765,canvasH:6618},ukraine:{legendPosition:"bottom_left",canvasW:6e3,canvasH:3614},"usa-and-canada":{legendPosition:"bottom_left",canvasW:4700,canvasH:4515},"usa-hex-cartogram":{legendPosition:"bottom_right",canvasW:4290,canvasH:3114},"usa-hex-cartogram-2016":{legendPosition:"bottom_right",canvasW:4290,canvasH:3114},"usa-congressional-districts":{legendPosition:"bottom_right",canvasW:6840,canvasH:3783},"usa-congressional-districts-117":{legendPosition:"bottom_right",canvasW:6840,canvasH:3783},"usa-counties":{legendPosition:"bottom_right",canvasW:6900,canvasH:4275},usa:{legendPosition:"bottom_right",canvasW:5285.5,canvasH:3762},westeros:{legendPosition:"top_right",canvasW:3854,canvasH:7400},world:{legendPosition:"bottom_left",canvasW:6460,canvasH:3403},"world-pacific":{legendPosition:"bottom_left",canvasW:6460,canvasH:3389},wargames:{legendPosition:"bottom_left",canvasW:7e3,canvasH:3465},coronavirus:{img2x:200,img2y:2275,img3x:5500,img3y:3350,legendFactor:0,originalSVGH:494,canvasW:6460,canvasH:3480},"world-advanced":{legendPosition:"bottom_left",canvasW:7e3,canvasH:4192},"world-advanced-eck4":{legendPosition:"bottom_left",canvasW:7e3,canvasH:3526.25},"world-advanced-mill":{legendPosition:"bottom_left",canvasW:7e3,canvasH:4786.25},"world-advanced-gall":{legendPosition:"bottom_left",canvasW:7e3,canvasH:5101.25},"world-advanced-robin":{legendPosition:"bottom_left",canvasW:7e3,canvasH:3526.25},"world-advanced-vandg":{legendPosition:"bottom_left",canvasW:7e3,canvasH:5993.75},"world-advanced-times":{legendPosition:"bottom_left",canvasW:7e3,canvasH:4865},"world-advanced-merc":{legendPosition:"bottom_left",canvasW:7e3,canvasH:6352.5},"world-advanced-eqc":{legendPosition:"bottom_left",canvasW:7e3,canvasH:3386.25},"world-subdivisions":{legendPosition:"bottom_left",canvasW:7030,canvasH:3542},"europe-world-war-1":{legendPosition:"top_left",canvasW:4170,canvasH:3245},"europe-world-war-2":{legendPosition:"top_left",canvasW:4170,canvasH:3245},"usa-historical":{legendPosition:"bottom_right",canvasW:6460,canvasH:3995},"world-1815":{legendPosition:"bottom_left",canvasW:7752,canvasH:3840},"world-1880":{legendPosition:"bottom_left",canvasW:7752,canvasH:3840},"world-1914":{legendPosition:"bottom_left",canvasW:7752,canvasH:3840},"world-1938":{legendPosition:"bottom_left",canvasW:7752,canvasH:3840},"world-cold-war":{legendPosition:"bottom_left",canvasW:7752,canvasH:3498}},wc=window.location.pathname.split("/"),Fe=wc[wc.length-1].split(".")[0],Ic=op[Fe];function ap(){window.CONFIGS=op,window.LOC=wc,window.PAGE=Fe,window.conf=Ic}var Zi="default";function lp(t){if(/^#[0-9A-F]{6}$/i.test(t))return t;t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);function e(n){return("0"+parseInt(n).toString(16)).slice(-2)}return"#"+e(t[1])+e(t[2])+e(t[3])}function yb(t){if(/^#/.test(t)&&(t=t.slice(1)),t.length!==3&&t.length!==6&&t.length!==8)throw new Error("Invaild hex String");var e=t.split("");e.length===3&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]);var n=parseInt([e[0],e[1]].join(""),16),i=parseInt([e[4],e[5]].join(""),16),r=parseInt([e[2],e[3]].join(""),16);return[n,i,r]}function cp(t,e=""){let n=$("#error-report-area"),i=$("#copy-error-report-btn"),r=`${PAGE}
 ${window.navigator.userAgent} 

`;r+=`${e}

`,r+=`${t.stack}
`,n.html(r),$("#errorModal").modal("show"),i.on("click",()=>{n.select(),document.execCommand("copy"),i.html("Copied! \u2705"),setTimeout(()=>{i.html("Copy")},2e3)})}function up(t){let e=[];return t.includes("rgb")?e=t.replace(/[^\d,.]/g,"").split(","):e=yb(t),Math.round((e[0]*.2126+e[1]*.7152+e[2]*.0722)/255*100)}var bb=function(t){return new Promise((e,n)=>{let i=document.createElement("script");i.src=t,i.async=!0,i.onload=e,i.onerror=n,document.head.appendChild(i)})},Sa=(()=>{let t=[];return async function(e){return t.includes(e)||(t.push(e),await bb(e)),!0}})(),wb=function(t){return new Promise((e,n)=>{let i=document.createElement("link");i.rel="stylesheet",i.href=t,i.onload=e,i.onerror=n,document.head.appendChild(i)})},dp=(()=>{let t=[];return async function(e){return t.includes(e)||(t=[e],await wb(e)),!0}})();function Ac(t,e){let n;if(window.location.hostname==="localhost"?n=`http://${window.location.host}/${LOC[1]}/${t}.html`:n=`https://${window.location.hostname}/${t}.html`,e){let i=new URLSearchParams(e);return n+"?"+i.toString()}return n}function Ji(){return new Proxy(new URLSearchParams(window.location.search),{get:(e,n)=>e.get(n)})}function hp(t){let n=fp(t).split("_"),r=["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(n[1])-1].substring(0,3);return`${n[0]} ${r} ${n[2]}, ${n[3]}:${n[4]}`}function fp(t){let e=t===void 0?new Date:new Date(t);return[e.getDate(),e.getMonth()+1,e.getFullYear(),e.getHours(),e.getMinutes(),e.getSeconds()].map(n=>Eb(n)).join("_")}function pp(t){return t.includes("Untitled")&&t.split("__").length===3?"Untitled":t}function Pc(t){let e=t.match(/#(?:[0-9a-f]{3}){1,2}/);if(e)return{color:e[0],CSSBgProperty:{"background-color":e[0]}};let n=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(n)return{color:n[0],CSSBgProperty:{"background-color":n[0]}};let i=t.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d)\.(\d)\)/);if(i)return{color:i[0],CSSBgProperty:{"background-color":i[0]}};let r=["circles3","diagonal1","diagonal3","vertical1","vertical3","horizontal1","horizontal3","crosshatch","subtlepatch","checkers","raindrops","texture"];for(let s of r){let o=new RegExp(s+"\\_\\S{6}\\_\\S{6}","g"),a=t.match(o);if(a)return{color:a[0],CSSBgProperty:{"background-image":Fn(a[0]),"background-repeat":"repeat"}}}return!1}function di(t){return t=t.split(" ").map(function(e){return parseFloat(e)}),{x:t[0],y:t[1],w:t[2],h:t[3]}}function Lr(t){let e=$('<div class="alert alert-danger alert-dismissible" id="uploaded-file-alert" role="alert">                      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>                      <span class="alert-message">'+t+"</span>                    </div>");$(".upload-file-form").append(e),$("#upload-txt-drop-area").removeClass("disabled")}function mp(t){try{var e=JSON.parse(t);if(e&&typeof e=="object")return $("#uploadModal").modal("hide"),$("#upload-txt-drop-area").removeClass("disabled"),e}catch{Lr("Not a valid config file for MapChart. Please make sure you are uploading the correct file. Else contact me through the Feedback page.")}return!1}function hn(t){if(PAGE=="wargames"){let e=t.split("_");return e[e.length-2]}else if(PAGE.indexOf("nuts")!==-1){if(/\d/.test(t))return t.substring(0,2)}else return PAGE=="usa-congressional-districts"?t.substring(0,2):t.slice(-2)}function Ea(){let t=new Set;return Be().each(function(){t.add(hn(this.id))}),t}function Ca(t){return PAGE==="brazil-municipalities"?sp[t]:!PAGE.includes("usa")&&!PAGE.includes("canada")?rp[t]:ip[t]}function Gs(t){let e=t.getAttribute("transform");if(e==="none"||e===null)return{scale:1,x:0,y:0};if(e.indexOf("matrix")!==-1){let n=e.match(/matrix.*\((.+)\)/)[1].split(" ");return{scale:parseFloat(n[0]),x:parseFloat(n[4]),y:parseFloat(n[5])}}else if(e.indexOf("scale")!==-1){let n=e.match(/scale.*\((.+)\)/)[1];return{scale:parseFloat(n),x:0,y:0}}else if(e.indexOf("translate")!==-1){let n=e.match(/translate.*\((.+)\)/)[1].split(",");return{scale:1,x:parseFloat(n[0]),y:parseFloat(n[1])}}}function lt(t,e,n={},i=""){let r;if($("#"+e).length>0)r=$("#"+e);else{let s=document.createElementNS("http://www.w3.org/2000/svg",t);s.setAttribute("id",e),r=$(s)}return n&&r.attr(n),i&&r.text(i),r}function Rc(t,e){return t.match(RegExp(".{1,"+e+"}(\\s|$)","g"))}function gp(t){return"Lorem Ipsum is simply dummy text of the printing and typesetting industry.".substring(0,t+1)}function Fn(t){let e=$("#"+t),n=e.html().replace(/\s\s+/g," "),i=e.attr("width"),r=e.attr("height"),s=`<svg xmlns="http://www.w3.org/2000/svg" width="${i}" height="${r}">${n}</svg>`;return`url("data:image/svg+xml;base64,${btoa(s)}")`}function Nc(t){let e=t.namespaceURI,n=t.querySelector("defs")||t.insertBefore(document.createElementNS(e,"defs"),t.firstChild);for(let i of tp){let r=$.parseHTML(`<svg>${i}</svg>`)[0].firstChild;$(n).append(r)}}function Yt(t){if(t.endsWith("_line")||PAGE==="usa-counties"&&t.indexOf("_")===-1)return!1;if(PAGE==="ukraine"){let n=$("#"+t).parent().attr("id");if(n==="ukr1"&&$("#transparent-oblasts").is(":checked")||n==="ukr2"&&$("#transparent-raions").is(":checked"))return!1}return!Zf.includes(t)}function Be(){return $("#map path").filter(function(){return Yt(this.id)})}function _p(t){let e=t.split(","),n=e[0].match(/:(.*?);/)[1],i=atob(e[1]),r=i.length,s=new Uint8Array(r);for(;r--;)s[r]=i.charCodeAt(r);return new Blob([s],{type:n})}function vp(t){var e;try{e=window[t];var n="__storage_test__";return e.setItem(n,n),e.removeItem(n),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}}function js(){for(let t in localStorage)if(localStorage.hasOwnProperty(t)&&t.match(`mc-as-${PAGE}`))return t;return!1}function xc(t){let e=t.split("-").pop();var n=new Date(parseInt(e)),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=n.getFullYear(),s=i[n.getMonth()],o=n.getDate(),a=n.getHours(),l=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),c=n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds(),h=o+" "+s+" "+r+" "+a+":"+l+":"+c;return h}function Hs(t){let e="#tools input, #tools select, #map-title, .legend-remove-row-btn",n=t=="disable",i=t=="disable"?.65:1;$(e).attr("disabled",n),$("#clear, #downup").prop("disabled",n).css("color","#fff"),$('[id$="picker"], .legend-box').spectrum(t),$("#tools label, .sp-preview-inner, .legend-box").css("opacity",i)}function qs(t){let e=t==="simple"||t==="simple-reversed",n=t==="simple-reversed",i=$("#colorpicker-drag-handle"),r=$("#map-container"),s=$("#tools"),o=$(".special-option");if(Zi==="default"&&e){if($("#tools p, #tools img, #tools .step, #img-title .page-logo-img").hide(),Sc.includes(PAGE)?($(".more-options, .fillpicker-area, #map-title-area, #advanced-legend, #legend-area, .buttons-area").addClass("simplify-ui"),i.hide(),s.detach().prependTo("#map-row").removeClass("row").addClass("col-md-3 simplify-ui"),$("#tools>div").removeClass("col-md-4 col-sm-12 col-xs-12"),r.removeClass("col-md-12").addClass("col-md-9"),$("#advanced-legend-btn, #advanced-legend").detach().prependTo("#legend"),$("#div-gpt-ad-mapchartnet37915").length>0&&($("#buttons .ad-cont").remove(),r.append($('<div class="col-md-12 ad-cont-white">            <div class="lbl">Advertisements</div>            <div id="div-gpt-ad-mapchartnet38609"> </div></div>'))),$("#div-gpt-ad-historicalmapchartnet39870").length>0&&($("#buttons .ad-cont").remove(),r.append($('<div class="col-md-12 ad-cont-white">            <div class="lbl">Advertisements</div>            <div id="div-gpt-ad-historicalmapchartnet39759"> </div></div>')))):($(".page-heading, .more-options, .fillpicker-area, #map-title-area, #advanced-legend, #legend-area, .buttons-area").addClass("simplify-ui"),s.removeClass("col-md-4").addClass("col-md-3 simplify-ui"),r.removeClass("col-md-8").addClass("col-md-9"),$(".page-heading").removeClass("col-md-8 col-sm-8 col-xs-8").addClass("col-md-12 col-sm-12 col-xs-12"),$("#advanced-legend-btn, #advanced-legend").detach().prependTo("#legend")),$('label[for="legend-rows-same-color-setting"]').detach().insertBefore("#legend-rows-same-color-setting"),n&&s.detach().appendTo("#map-row"),$("#special-options-btn").length>0){let a=$('<details id="special-options">').insertBefore("#legend-area");a.append($("#special-options-btn").addClass("simplify-ui")),a.append($('<div class="well">')),o.detach().appendTo("#special-options .well")}}else(Zi=="simple"||Zi=="simple-reversed")&&!e?($("#tools p, #tools img, #tools .step, #img-title .page-logo-img").show(),Sc.includes(PAGE)?($(".more-options, .fillpicker-area, #map-title-area, #advanced-legend, #legend-area, .buttons-area").removeClass("simplify-ui"),i.show(),s.detach().appendTo("main").removeClass("col-md-3 simplify-ui").addClass("row"),$("#tools>div").addClass("col-md-4 col-sm-12 col-xs-12"),r.removeClass("col-md-9").addClass("col-md-12"),$("#advanced-legend-btn").detach().appendTo("#map-title-area"),$("#advanced-legend").detach().insertAfter("#legend-area .row:first"),$("#div-gpt-ad-mapchartnet38609").length>0&&($("#map-container .ad-cont-white").remove(),$("#buttons").append($('<div class="col-md-12 ad-cont">            <div class="lbl">Advertisements</div>            <div id="div-gpt-ad-mapchartnet37915"> </div></div>'))),$("#div-gpt-ad-historicalmapchartnet39759").length>0&&($("#map-container .ad-cont-white").remove(),$("#buttons").append($('<div class="col-md-12 ad-cont">            <div class="lbl">Advertisements</div>            <div id="div-gpt-ad-historicalmapchartnet39870"> </div></div>')))):($(".page-heading, .more-options, .fillpicker-area, #map-title-area, #advanced-legend, #legend-area, .buttons-area").removeClass("simplify-ui"),s.addClass("col-md-4").removeClass("col-md-3 simplify-ui"),r.addClass("col-md-8").removeClass("col-md-9"),$(".page-heading").addClass("col-md-8 col-sm-8 col-xs-8").removeClass("col-md-12 col-sm-12 col-xs-12"),$("#advanced-legend-btn").detach().appendTo("#map-title-area"),$("#advanced-legend").detach().insertAfter("#legend-area .row:first"),n?s.detach().appendTo("#map-row"):s.detach().prependTo("#map-row")),$('label[for="legend-rows-same-color-setting"]').detach().insertAfter("#legend-rows-same-color-setting"),$("#special-options-btn").length>0&&($("#special-options-btn").detach().appendTo("#special-options-btn-wrapper").removeClass("simplify-ui"),o.detach().insertAfter("#special-options-btn-wrapper"),$("#special-options").remove())):Zi=="simple"&&t=="simple-reversed"?s.detach().appendTo("#map-row"):Zi=="simple-reversed"&&t=="simple"&&s.detach().prependTo("#map-row");$("#"+t+"-layout-setting-btn").parent().addClass("is-active"),$("#"+Zi+"-layout-setting-btn").parent().removeClass("is-active"),Zi=t,localStorage.setItem(`mc-layout-${PAGE}`,t)}function Ks(t){t==="disable"?(mapchart.eyeDropping=!1,mapchart.eyeDroppingForId="",Hs("enable"),$("body, #map path").removeClass("cursor-eye-dropper"),$("#rsr").css("border","none"),$("#info-tooltip").removeClass("eye-dropping").css("background-color","white"),$("#status-bar").hide()):(mapchart.eyeDropping=!0,Hs("disable"),$("body, #map path").addClass("cursor-eye-dropper"),$("#rsr").css("border","2px dashed #485c80"),$("#info-tooltip").addClass("eye-dropping"),$("#status-bar").html("Click on a country/state on the map to copy its color. Click anywhere else to cancel."),$("#status-bar").css("background-color","#485c80").show())}function yp(){let t,e,n,i;({x:t,y:e,w:n,h:i}=di($("#map").attr("viewBox")));let r=$("input#VBxSlider").slider({min:-n,max:n,value:t,tooltip:"always",step:1,tooltip_position:"top"}),s=$("input#VBySlider").slider({min:-i,max:i,value:e,tooltip:"always",step:1,tooltip_position:"top"}),o=$("input#VBwSlider").slider({min:0,max:n*5,value:n,tooltip:"always",step:1,tooltip_position:"top"}),a=$("input#VBhSlider").slider({min:0,max:i*5,value:i,tooltip:"always",step:1,tooltip_position:"top"});r.on("change",function(){wa(document.getElementById("map"),{x:r.slider("getValue")})}),s.on("change",function(){wa(document.getElementById("map"),{y:s.slider("getValue")})}),o.on("change",function(){wa(document.getElementById("map"),{w:o.slider("getValue")})}),a.on("change",function(){wa(document.getElementById("map"),{h:a.slider("getValue")})})}function bp(){let t=$("input#countyNamesXSlider").slider({min:-2e3,max:2e3,value:0,tooltip:"always",step:1,tooltip_position:"top"}),e=$("input#countyNamesYSlider").slider({min:-2e3,max:2e3,value:0,tooltip:"always",step:1,tooltip_position:"top"}),n=$("input#countyNamesZoomSlider").slider({min:-5,max:5,value:1,tooltip:"always",step:.005,tooltip_position:"top"});t.on("change",function(){kc({x:t.slider("getValue")})}),e.on("change",function(){kc({y:e.slider("getValue")})}),n.on("change",function(){kc({zoom:n.slider("getValue")})})}function Ta(t,e){t=t.replaceAll("-","_"),(e==""||e===void 0)&&(e="Untitled"),e=e.substring(0,16);let n=fp(),i=`${t.replaceAll("-","_")}__${e}__${n}`;return i=Cb(i),i}function wa(t,e){let n,i,r,s;({x:n,y:i,w:r,h:s}=di(t.getAttribute("viewBox"))),e.x&&(n=e.x),e.y&&(i=e.y),e.w&&(r=e.w,s=e.w),e.h&&(r=e.h,s=e.h),t.setAttribute("viewBox",[n,i,r,s].join(" "))}function kc(t){let e,n,i,r=$("#county_labels"),o=r.attr("transform").match(/matrix.*\((.+)\)/)[1].split(", ");e=o[4],n=o[5],i=o[0],t.x&&(e=t.x),t.y&&(n=t.y),t.zoom&&(i=t.zoom),r.attr("transform",`matrix(${i}, 0, 0, ${i}, ${e}, ${n})`)}function Ia(t){return typeof jQuery<"u"?jQuery("<div/>").text(t).html():t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function wp(){if(window.UA=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase(),window.IS_MACOS=navigator.platform.toUpperCase().indexOf("MAC")>=0,window.IS_IOS=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),window.IS_IPAD_OS=navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),window.IS_ANDROID=UA&&UA.indexOf("android")>0,window.IS_FIREFOX=typeof InstallTrigger<"u",window.IS_IE_OR_EDGE=document.documentMode||/Edge/.test(navigator.userAgent)||/Edg/.test(navigator.userAgent),window.IS_SAFARI=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&navigator.userAgent.indexOf("CriOS")==-1&&navigator.userAgent.indexOf("FxiOS")==-1,window.IS_CHROME_OS=/\bCrOS\b/.test(navigator.userAgent),(IS_ANDROID||IS_IOS||IS_IPAD_OS)&&$("#app-alert").html('<strong> Please use the free mobile app for iOS or Android if you are on a mobile device.</strong> Get it <a class="alert-link" href="https://app.mapchart.net" target="_blank" rel="noopener">here</a>.'),(IS_IOS||IS_IPAD_OS)&&(conf.canvasW/=2,conf.canvasH/=2),IS_MACOS&&($(".color-single-shortcut").html("Option-Shift-click"),$(".control-move-shortcut").html("Command and move"),$(".control-shortcut").html("Command"),$(".control-shift-shortcut").html("Command-Shift"),$(".undo-shortcut").html("Command-Z"),$(".redo-shortcut").html("Command-Y")),/CriOS/i.test(navigator.userAgent)&&IS_IOS&&$("#app-alert").html('<strong> Chrome on iOS is not fully supported. Please use Safari browser or the free MapChart mobile app.</strong> Get it <a class="alert-link" href="https://app.mapchart.net" target="_blank" rel="noopener">here</a>.').css("background","#d04a4a"),!localStorage.getItem("mc-as-noStatusBar")){let e=js();if(e){let n=xc(e);$("#status-bar").html("<span><strong>Autosave found!</strong><br> To resume your autosave from "+n+`, use the <strong>Save/Upload Map Configuration dialog</strong>.</span> <a role="button" href="#" class="status-bar-notice">Don't show this again</a> `).css("background-color","#485c80").show().delay(1e4).fadeOut(),$("#status-bar .status-bar-notice").on("click",function(){localStorage.setItem("mc-as-noStatusBar",!0),$("#status-bar").hide()})}}localStorage.getItem("mc-as-noBetaAlert")||$("#app-alert").show(),$("#app-alert .app-alert-notice").on("click",function(){localStorage.setItem("mc-as-noBetaAlert",!0),$("#app-alert").hide()});let t=localStorage.getItem(`mc-layout-${PAGE}`);t=="simple"||t=="simple-reversed"?qs(t):$("#default-layout-setting-btn").parent().addClass("is-active"),jQuery.fn.outerHTML=function(){return jQuery("<div />").append(this.eq(0).clone()).html()},jQuery.fn.setFill=function(e){return jQuery(this).attr("fill",e).css("fill",e)},jQuery.fn.getFill=function(){let e=jQuery(this).attr("fill")||lp(jQuery(this).css("fill"));return e.indexOf("url")!==-1?(e=e.match(/\(#([^)]+)\)/)[1],e.split("_").length===4?e.split("_").splice(0,3).join("_"):e):e},jQuery.fn.setStroke=function(e){return jQuery(this).attr("stroke",e).css("stroke",e)},jQuery.fn.getStroke=function(){return jQuery(this).attr("stroke")||lp(jQuery(this).css("stroke"))},jQuery.fn.setStrokeWidth=function(e){return jQuery(this).attr("stroke-width",e).css("stroke-width",e)},jQuery.fn.getStrokeWidth=function(){return parseFloat(jQuery(this).attr("stroke-width")||jQuery(this).css("stroke-width"))},$(function(){$(".loader").fadeOut("fast")}),window.location.host.indexOf("localhost")===-1&&window.addEventListener("beforeunload",function(e){if(!!Sb()){var n="It looks like you have been editing something. If you leave before saving, your changes will be lost.";return(e||window.event).returnValue=n,n}})}function Sb(){return $("#legend-table tr").length>1}function Eb(t){return t<10?String(t).padStart(2,"0"):String(t)}function Cb(t){return t.replaceAll(/[!@#$%^&?<>*]"/ig,"_")}var Oc={};function Ue(t){var e=t.toString(),n=["circles3","diagonal1","diagonal3","vertical1","vertical3","horizontal1","horizontal3","crosshatch","subtlepatch","checkers","raindrops","texture"];return new RegExp(n.join("|")).test(e)}function Sp(t){if(Ue(t))return"#"+t.split("_")[1]}function Ep(t,e,n){return`${t}_${e.replace("#","")}_${n.replace("#","")}`}function Zt(t){let e=t.split("_");return{pType:e[0],bg:"#"+e[1],top:"#"+e[2]}}function hi(t){return`url(#${t})`}function $r(t){return t===void 0?["<div class='u-not-logged-in'> <p><strong>Beta users only</strong></p><p> Currently available only for beta testing.</p></div>"]:t.length===0?["<span> No colors found in My Palette </span>"]:t.reduce((e,n,i)=>{let r=Math.floor(i/9);return e[r]||(e[r]=[]),e[r].push(n),e},[]).map(function(e,n){return ka(e,"sp-palette-row sp-palette-row-"+n,!0)})}function ka(t,e,n){for(var i=[],r=0;r<t.length;r++){var s=t[r];if(s)if(Ue(s)&&n){var o=Zt(s),a=tinycolor(o.bg);let _=a.toHsl().l<.5?"sp-thumb-el sp-has-pattern sp-thumb-dark":"sp-thumb-el sp-has-pattern sp-thumb-light";Un(o.pType,o.bg,o.top);var l=Fn(s),c=$("<span></span>");c.prop("title",s).attr("data-color",s).addClass(_).append($("<span></span>").addClass("sp-thumb-inner").css({"background-repeat":"repeat","background-image":l})),i.push(c.prop("outerHTML"))}else{var h=tinycolor(s);let _=h.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";var u=h.toString("hex"),d="background-color:"+h.toRgbString();i.push('<span title="'+u+'" data-color="'+h.toRgbString()+'" class="'+_+'"><span class="sp-thumb-inner" style="'+d+';" ></span></span>')}else{var p="sp-clear-display";i.push($("<div></div>").append($('<span data-color="" style="background-color:transparent;" class="'+p+'"></span>').attr("title","No Color Selected")).html())}}return"<div class='sp-cf "+e+"'>"+i.join("")+"</div>"}function Aa(t,e){if(!Oc[t]){let n=["oceania-detailed","tamriel","asia-detailed","africa-detailed","americas-detailed","usa-counties","europe-detailed","usa-congressional-districts","canada-census-divisions","world-subdivisions","oceania-detailed","indonesia","wargames","australia-electoral-divisions","canada-federal-ridings","europe-nuts2","europe-nuts3"],r={},s=0;e.each(function(){let a=this.getBBox(),l=this.id,c=a.width*a.height;if(c===0){let h=document.getElementById("map"),u=this.cloneNode(!0);u.style.display="inline",h.appendChild(u),a=u.getBBox(),c=a.width*a.height,h.removeChild(u)}s=Math.max(c,s),r[l]=c});let o=10;for(let a in r){let l=r[a],c=Math.ceil(l/s*o)/o+.2;n.includes(PAGE)&&(c/=4),c=Math.max(c,.15),Oc[a]=c}}return Oc[t]}function Pa(t,e){let n=t+"_"+e.toString(),i=$("#"+t).clone();i.attr({id:n,patternTransform:`scale(${e})`});let r=$("#map defs");return r.find("#"+n).length===0&&r.append(i),n}function Fr(t){let e=t.split("_");return e.length===4?e.slice(0,3).join("_"):t}function Un(t,e,n){t=t||$("#selected-pattern").val(),e=e||$("#bgPatternPicker").spectrum("get").toString(),n=n||$("#topPatternPicker").spectrum("get").toString();let i=Ep(t,e,n),r=i+"_preview",s=$("#"+t).clone().prop({id:i});s.children()[0].setAttribute("fill",e),["diagonal1","diagonal3","crosshatch"].indexOf(t)===-1?s.children()[1].setAttribute("fill",n):s.children()[1].setAttribute("stroke",n);let o=$("#map defs, #sample-svg defs");o.find("#"+i).length===0&&o.append(s);let a=$("#"+i).clone().prop({id:r});$("#previewPatternSVG defs").append(a),$("#previewPatternSVG .previewPatternRect").attr("fill",hi(r))}function Cp(t){let e=Ys(),n=$(t).spectrum("get");$(t).spectrum("set",e),$(t).spectrum("addColorToSelectionPalette",e),t.id!=="fillpicker"&&$(t).spectrum("triggerChange",e,n)}function Ys(){let t=$("#selected-pattern").val(),e=$("#bgPatternPicker").spectrum("get").toString(),n=$("#topPatternPicker").spectrum("get").toString();return Ep(t,e,n)}var mt="#d1dbdd",Wr=Fe.includes("usa")||Fe.includes("canada")?"#000000":"#6a0707";var Ve={},Jt=[],Uc={},fi,Ib=100,Ur=15,kb={backgroundpicker:"background",borderpicker:"borders",legendbgpicker:"legend background",legendfontcolorpicker:"legend font",defaultcolorpicker:"default",labelscolorpicker:"labels"},Xe=[],Br=[],Bc="medium",Oa=ya.includes(Fe)||Fe===""?"":Ic.legendPosition,Zs="show",zc="#00000000",pi,Na="#000000",Tp="#ffffff",zr=Fe==="usa-hex-cartogram"?"#ffffff":"#000000",Dc="medium",Bn=!0,Ra=!!["tamriel","westeros","usa","usa-hex-cartogram"].includes(Fe),Mc=!0,Lc=!1,$c=!1,Fc=!1,Vr=!0,Da=!0,xa=1;function Nt(t){return Jt.includes(t)}function Xi(){return Ve}function Ip(){Uc=nt()}function Ma(){return Uc}function wt(){let t=Fa(),e=document.getElementById("map"),n=$(e),i=document.getElementById("wrapper"),r=$(i),s=lt("svg","legend-svg",{width:"100%",height:"100%",style:"overflow:visible;"});if(s.data("ui-draggable")||Ab(s),Zs!=="hide"){s.removeAttr("visibility");let o=lt("g","legend-g-svg",{fill:Na});o.css(Op(pi)),o.empty();let a=20,l=20,c=$("#map-title").val(),h={"font-size":t.titleFontSize,"font-weight":"bolder"},u=lt("text","legend-title-svg",h),d=Rc(c,t.rowMaxChars*xa);if(d!==null)for(let q=0;q<d.length;q++){let M;q===0?(M=lt("tspan","legend-title-tspan-svg"+q,{x:a,y:l,dy:0},d[q]),l+=t.firstRowHeight):(M=lt("tspan","legend-title-tspan-svg"+q,{x:a,dy:t.extraRowHeight},d[q]),l+=t.extraRowHeight),u.append(M)}else l=10;o.append(u);let p=l,_=[],g=[];if(Zs=="show"){let q=$("#legend-table-body tr[id^=legend-row]");for(let M of q){let Q=$(M),b=Q.attr("id").replace("legend-row-",""),W;Ue(b)?W=hi(b):W="#"+b;let O=Q.find(".legend-input").val(),R={fill:W,stroke:"#000000","stroke-width":.5,width:t.rectSize,height:t.rectSize,y:l},ee=lt("rect","legend-rect-svg-"+b,R),te="legend-row-svg-"+b,ne=lt("text",te,{"font-size":t.legendFontSize});if(d=Rc(O,t.rowMaxChars),$("#"+te).empty(),d===null||d[0].trim().length===0){let ve=lt("tspan",te+"-tspan-svg0",{y:l+t.rowTopPadding,dy:0,visibility:"hidden",fill:"#000000"},".");l+=t.firstRowHeight,ne.append(ve)}else for(let ve=0;ve<d.length;ve++){let Ie,_e=Da?Na:Ue(W)?Sp(W):W;ve===0?(Ie=lt("tspan",te+"-tspan-svg"+ve,{y:l+t.rowTopPadding,dy:0,fill:_e},d[ve]),l+=t.firstRowHeight):(Ie=lt("tspan",te+"-tspan-svg"+ve,{dy:t.extraRowHeight,fill:_e},d[ve]),l+=t.extraRowHeight),ne.append(Ie)}_.push(ee),g.push(ne)}}let y=l-p,v,w;for(let q=0;q<_.length;q++){let M=_[q],Q=g[q],b=g[q].find("tspan"),W=parseInt(M.attr("y"));if(M.attr("x",a),b.attr("x",a+t.rowLeftMargin),xa===2&&W-p>y/2){if(v===void 0){let O=0;for(let R=0;R<q;R++)O=Math.max(O,g[R][0].getBBox().width);v=a+t.rowLeftMargin+O+t.columnGap}if(M.attr("x",v),b.attr("x",v+t.rowLeftMargin),w===void 0)w=p;else{let O=g[q-1][0].getBBox();w=O.y+O.height+t.firstRowHeight-parseInt(M.attr("height"))}M.attr("y",w),b.eq(0).attr("y",w+t.rowTopPadding)}o.append(M),o.append(Q)}s.append(o),r.append(s);let S=document.getElementById("legend-g-svg").getBBox(),x=S.width+t.bgPadding*2,P=S.height+t.bgPadding,F=lt("rect","legend-bg-rect-svg",{x:0,y:0,rx:7,ry:7,width:x,height:P,fill:zc}),C=Pb(x,P,3);o.prepend(F),o.append(C);let B=`scale(${t.legendScale})`;o.attr("transform",B);let G=parseFloat(s.attr("x")),T=parseFloat(s.attr("y"));!G&&!T?La(Oa):s.attr({x:G,y:T});let L=parseFloat(n.attr("height")),f=T+P*t.legendScale-L,I=L+f+t.bgPadding;I>t.originalViewBox.h?(n.attr("height",I),r.attr("height",I)):(n.attr("height",t.originalViewBox.h),r.attr("height",t.originalViewBox.h))}else s&&s.attr("visibility","hidden"),n.attr("height",t.originalViewBox.h),r.attr("height",t.originalViewBox.h)}function nt(t=!1){let e={groups:{},title:document.getElementById("map-title").value,hidden:Jt,background:Tp,borders:zr,legendFont:pi,legendFontColor:Na,legendBgColor:zc,areBordersShown:Bn,defaultColor:mt,labelsColor:Wr,strokeWidth:Dc,areLabelsShown:Ra};if($("#show-state-borders").length&&(e.areStateBordersShown=Mc),$("#show-usa-states").length&&(e.usaStatesShown=Lc),$("#show-canada-states").length&&(e.canadaStatesShown=$c),$("#show-territories").length&&(e.usTerritoriesShown=$("#show-territories").is(":checked")),$("#show-fas").length&&(e.usFasShown=$("#show-fas").is(":checked")),$("#split-uk").length&&(e.splitUK=Fc),e.legendPosition=Oa,e.legendPosition=="custom"&&(e.legendX=parseFloat($("#legend-svg").attr("x")).toFixed(2),e.legendY=parseFloat($("#legend-svg").attr("y")).toFixed(2)),e.legendSize=Bc,e.legendSize=="custom"){let r=document.getElementById("legend-g-svg");e.legendScale=Gs(r).scale}e.legendStatus=Zs,e.scalingPatterns=Vr,e.legendRowsSameColor=Da,e.legendColumnCount=xa;let n=$("#legend-table-body tr[id^=legend-row]");for(let r of n){let s=$(r),o=s.attr("id").replace("legend-row-",""),a=Ue(o)?o:"#"+o,l=s.find(".legend-input").val(),c=Ve[a].paths;e.groups[a]={label:l,paths:c}}let i=JSON.stringify(e);if(t)if(vp("localStorage"))try{for(let s in localStorage)localStorage.hasOwnProperty(s)&&s.match(`mc-as-${Fe}`)&&localStorage.removeItem(s);let r=`mc-as-${Fe}-${Date.now()}`;localStorage.setItem(r,i)}catch{let s=[];for(let l in localStorage)localStorage.hasOwnProperty(l)&&l.match("mc-as")&&s.push(l);s.sort(function(c,h){return parseInt(c.split("-").pop())-parseInt(h.split("-").pop())});let o=i.length;for(;o>0;){let l=s.shift();o-=localStorage.getItem(l),localStorage.removeItem(l)}let a=`mc-as-${Fe}-${Date.now()}`;localStorage.setItem(a,i)}else $("#status-bar").html("<strong>Could not autosave. Please check your browser settings.</strong>.").css("background-color","red").show().delay(1e4).fadeOut();return i}function zn(t){let e={};if(typeof t=="string"?e=mp(t):e=t,Ve={},!e)return;document.getElementById("map-title").value=e.title,e.hasOwnProperty("usaStatesShown")&&(Yc(e.usaStatesShown),$("#show-usa-states").prop("checked",e.usaStatesShown)),e.hasOwnProperty("canadaStatesShown")&&(Zc(e.canadaStatesShown),$("#show-canada-states").prop("checked",e.canadaStatesShown)),e.hasOwnProperty("splitUK")&&(Jc(e.splitUK),$("#split-uk").prop("checked",e.splitUK)),(Fe=="usa"||Fe=="usa-and-canada")&&(e.hasOwnProperty("usTerritoriesShown")?(toggleUSTerritories(e.usTerritoriesShown),$("#show-territories").prop("checked",e.usTerritoriesShown)):(toggleUSTerritories(!1),$("#show-territories").prop("checked",!1))),Fe=="usa"&&(e.hasOwnProperty("usFasShown")?(toggleUSFas(e.usFasShown),$("#show-fas").prop("checked",e.usFasShown)):(toggleUSFas(!1),$("#show-fas").prop("checked",!1)));let n=Be(),i=[];if(Jt=e.hidden?[...e.hidden]:[],e.hasOwnProperty("areBordersShown")&&($("#no-borders").prop("checked",e.areBordersShown),Bn=e.areBordersShown),e.borders&&($("#borderpicker").spectrum("set",e.borders),zr=e.borders),n.each(function(){let r=$(this).attr("id");if(i.push(r),Bn)$(this).setStroke(zr);else{let s=$(this).getFill();Ue(s)&&(s=Zt(s).bg),$(this).setStroke(s)}Jt.includes(r)?bt(r):Ut(r)}),$("#legend-table-body").empty(),e.background&&($("#backgroundpicker").spectrum("set",e.background),Qs(e.background)),e.legendFontColor&&($("#legendfontcolorpicker").spectrum("set",e.legendFontColor),Xs(e.legendFontColor)),e.legendBgColor&&($("#legendbgpicker").spectrum("set",e.legendBgColor),Js(e.legendBgColor)),e.defaultColor&&($("#defaultcolorpicker").spectrum("set",e.defaultColor),eo(e.defaultColor)),e.labelsColor&&($("#labelscolorpicker").spectrum("set",e.labelsColor),to(e.labelsColor)),e.legendFont){let r=["Lucida","Tahoma"].includes(e.legendFont)?"Helvetica":e.legendFont;$("#legend-font").val(r).trigger("change"),Gc(r)}e.legendSize&&($("#legend-size").val(e.legendSize),Hc(e.legendSize)),e.legendPosition&&($("#legend-position").val(e.legendPosition),La(e.legendPosition)),e.legendColumnCount&&($("#legend-columns").val(e.legendColumnCount),Kc(e.legendColumnCount)),e.hasOwnProperty("scalingPatterns")&&($(".scale-patterns-setting").prop("checked",!e.scalingPatterns),Vr=e.scalingPatterns),e.hasOwnProperty("legendRowsSameColor")&&($("#legend-rows-same-color-setting").prop("checked",!e.legendRowsSameColor),$("#legendfontcolorpicker").spectrum(e.legendRowsSameColor?"enable":"disable"),$(".legend-font-color-container .sp-preview-inner").css("opacity",e.legendRowsSameColor?1:.65),Da=e.legendRowsSameColor),e.strokeWidth&&($("#stroke-width-setting").val(e.strokeWidth),Xc(e.strokeWidth)),e.hasOwnProperty("areLabelsShown")&&(jc(e.areLabelsShown),$("#show-names").prop("checked",e.areLabelsShown)),e.hasOwnProperty("areStateBordersShown")&&(qc(e.areStateBordersShown),$("#show-state-borders").prop("checked",e.areStateBordersShown));for(let r in e.groups){let s=e.groups[r].paths,o=s.length,a="#legend-row-"+r.replace("#","")+" .legend-input";if(Ue(r)){let l=Zt(r);Un(l.pType,l.bg,l.top)}$("#fillpicker").spectrum("addColorToSelectionPalette",r);for(let l=0;l<o;l++){let c=s[l];Tc[c]&&(c=Tc[c]),i.includes(c)?It(r,c):console.error(`Could not restore: ${c} on the map. Please contact me and I can check it out!`)}$(a).val(e.groups[r].label)}return e.legendPosition==="custom"&&$("#legend-svg").attr({x:e.legendX,y:e.legendY}),e.legendSize==="custom"&&$("#legend-g-svg").attr("transform",`scale(${e.legendScale})`),e.legendStatus?($("#legend-status").val(e.legendStatus),Wc(e.legendStatus)):wt(),Fe==="usa-hex-cartogram"&&updateVotes(),nt(!0)}function kp(){let t=Fa(),e=document.getElementById("wrapper"),n=$(e),i,r=$("#backgroundpicker").spectrum("get").toHsl().l>.5?"#000":"#fff",s=8*t.originalLegendScale,o=lt("text","credit-text-svg",{"font-family":"Century Gothic,Segoe UI,Lucida Grande","font-size":s,"font-weight":"bold",fill:r}),a=lt("tspan","credit-tspan-svg",{x:200,y:200,dy:0},`Created with ${window.isTestingLocally?"mapchart.net":Yf}`);n.append(o.append(a)),i=o[0].getBBox().width;let l=parseFloat($("#legend-svg").attr("x")),c;!l||l<t.originalViewBox.w/2?c=t.originalViewBox.w-i-t.bgPadding:c=t.originalViewBox.w/15;let h=parseFloat(n.attr("height"))-o[0].getBBox().height;a.attr({x:c,y:h})}async function Ap(){if(Zs!=="hide"&&!Object.keys(ba).includes(pi)&&$("#legend-svg").length>0){let t=pi.split(":")[0].replace(/ /g,"+"),e=pi.split(":")[1],n=`https://fonts.googleapis.com/css?family=${t}:${e}`,i=document.querySelector("#legend-svg"),r=i.querySelector("defs")||i.insertBefore(document.createElementNS("http://www.w3.org/2000/svg","defs"),i.firstChild);try{let o=await(await fetch(n)).text(),l=o.match(/https:\/\/[^)]+/g).map(function(c){return new Promise(function(h,u){fetch(c).then(function(d){return d.blob()}).then(function(d){let p=new FileReader;p.addEventListener("load",function(){let _=this.result;o=o.replace(c,this.result),h([c,this.result])}),p.readAsDataURL(d)}).catch(u)})});await Promise.all(l).then(function(){let c=lt("style","legend-svg-style",{},o);$(r).append(c)})}catch(s){console.log("fetching font files failed: ",s)}}}function Ab(t){t.draggable({start:function(e,n){if(fi=nt(),IS_FIREFOX){let i=parseFloat(this.getAttribute("x")),r=parseFloat(this.getAttribute("y")),s=this.getScreenCTM(),o=(e.clientX-s.e)/s.a-i,a=(e.clientY-s.f)/s.d-r;this.setAttribute("data-offsetx",o),this.setAttribute("data-offsety",a)}},drag:function(e,n){if(!(mapchart.zoomTool&&mapchart.zoomTool.isActive)){let i=parseFloat(this.getAttribute("x")),r=parseFloat(this.getAttribute("y")),s=document.getElementById("wrapper"),o=s.getBoundingClientRect(),a=di(s.getAttribute("viewBox")),l=o.width>a.w?a.w/o.width:1,c=this.getBBox(),h,u;if(IS_FIREFOX){let d=this.getAttribute("data-offsetx"),p=this.getAttribute("data-offsety"),_=this.getScreenCTM();h=(e.clientX-_.e)/_.a-d,u=(e.clientY-_.f)/_.d-p}else h=i+(n.offset.left-n.helper.position().left)*l,u=r+(n.offset.top-n.helper.position().top)*l;h<0&&(h=0),u<0&&(u=0),h>a.w-c.width&&(h=a.w-c.width),this.setAttribute("x",h),this.setAttribute("y",u)}},stop:function(){$("#legend-position").val()!=="custom"&&($("#legend-position").val("custom"),Oa="custom");let e=nt();be("CUSTOM_LEGEND_POSITION",{prevConfig:fi,config:e},function(){wt()}),fi=e},cancel:"#legend-handle-g"})}function Vc(t,e=400){let n;$(t).focus(function(i){fi=nt()}),$(t).keyup(function(i){window.clearTimeout(n),n=window.setTimeout(()=>{let r=i.target.value,s=nt();be("LEGEND_INPUT_CHANGE",{prevConfig:fi,config:s},function(){wt()}),fi=s},e)}),$(t).on("keydown",function(i){let r=90,s=89;if((i.keyCode==r||i.keyCode==s)&&(i.ctrlKey||i.metaKey))return i.preventDefault(),!1})}function Pb(t,e,n){let i=n+n/2,r=`translate(${t-i*3},${e})`,s=lt("g","legend-handle-g",{transform:r});s.empty();let o=lt("rect","legend-handle-bg",{x:0,y:-i*2,width:n*3+i,height:n*3+i,fill:"#00000000"});s.append(o);let a=[0,i,i,i*2,i*2,i*2],l=[0,0,-i,0,-i,-i*2];for(let c=0;c<6;c++){let h={x:a[c],y:l[c],fill:"#babdb6",width:n,height:n},u=lt("rect","legend-handle-rect"+c,h);s.append(u)}return s.mousedown(function(){fi=nt(),window.addEventListener("mousemove",Pp),window.addEventListener("mouseup",Rp)}),s}function Pp(t){if(!(mapchart.zoomTool&&mapchart.zoomTool.isActive)){let e=document.getElementById("legend-g-svg"),i=document.getElementById("legend-handle-g").getBoundingClientRect(),r=e.getBoundingClientRect(),s=t.clientX+i.width-(r.x+r.width),o=t.clientY+i.height-(r.y+r.height);if(s>0&&o>0){let a=Gs(e).scale*1.01;e.setAttribute("transform","scale("+a+")")}else if(s<0&&o<0){let a=Gs(e).scale*.99;e.setAttribute("transform","scale("+a+")")}}}function Rp(t){$("#legend-size").val()!=="custom"&&($("#legend-size").val("custom"),Bc="custom");let e=nt();be("CUSTOM_LEGEND_SIZE",{prevConfig:fi,config:e},function(){wt()}),fi=e,window.removeEventListener("mousemove",Pp),window.removeEventListener("mouseup",Rp)}function It(t,e){let n=$("#"+e),i=n.getFill();if(i!==t){if(Jt.includes(e)){Ut(e);let r=n.getStrokeWidth();n.setStrokeWidth(r*2)}if(Ue(t)){if(Vr){let r=Aa(e,Be()),s=Pa(t,r);n.setFill(hi(s))}else n.setFill(hi(t));Bn||n.setStroke(Zt(t).bg)}else n.setFill(t),Bn||n.setStroke(t);t in Ve?(Ve[t].count++,Ve[t].paths.push(e)):(Ve[t]={count:1,paths:[e]},Nb(t)),Qc(i,e)}}function Rb(t){console.log(Ve),be("REMOVE_COLOR",{affectedPaths:[...Ve[t].paths],prevColor:t},function(){Ve[t].paths.forEach(function(e){$("#"+e).setFill(mt),$("#no-borders").is(":checked")||$("#"+e).setStroke(mt)}),Fp(t)})}function Ti(t){let e=$("#"+t),n=e.getFill();n!==mt&&(e.setFill(mt),$("#no-borders").is(":checked")||e.setStroke(mt),Qc(n,t))}function Ut(t){let e=$("#"+t),n={fill:mt,stroke:Bn?zr:mt};e.css(n).attr(n),$("#show-names").is(":checked")&&e.parent().is("g")&&e.siblings('text, [id$="line"]').show();let i=Jt.indexOf(t);i!==-1&&Jt.splice(i,1)}function bt(t){let e=$("#"+t),n=e.getFill(),i={fill:"none",stroke:"none","pointer-events":"visible"};e.css(i).attr(i),e.parent().is("g")&&e.siblings('text, [id$="line"]').hide(),Jt.includes(t)||Jt.push(t),Qc(n,t)}function Np(t){let e=$("#"+t).getFill(),n=Zt(e);be("COLOR",{affectedPaths:[t],color:n.bg},function(){It(n.bg,t)})}function xp(t){let e=$("#legend-table-body>tr>td>div[data-paint]").clone(),n=[],i=$("#"+t);for(let r=0,s=e.length;r<s;r++){let o=$(e[r]),a=i.getFill();o.addClass("used-paint-box"),o.on("click",function(){let l=$(this).attr("data-paint");be("COLOR",{affectedPaths:[t],color:l},function(){It(l,t)}),i.contextMenu("hide")}),n.push(o)}$(".existing-paints").html(n)}function Wc(t){t==="title"?($("#legend-table").css("opacity",.3),$("#map-title").attr("disabled",!1)):t==="hide"?($("#legend-table").css("opacity",.3),$("#map-title").attr("disabled",!0)):($("#legend-table").css("opacity",1),$("#map-title").attr("disabled",!1)),Zs=t,wt()}function Hc(t){let e=document.getElementById("legend-g-svg");if(e){let n=Fa(),i;switch(t){case"small":i=n.originalLegendScale*.75;break;case"medium":i=n.originalLegendScale;break;case"large":i=n.originalLegendScale*1.25;break;case"larger":i=n.originalLegendScale*1.5;break}t!=="custom"&&e.setAttribute("transform","scale("+i+")"),Bc=t}}function La(t){let e,n,i,r=Fa(),s=$("#wrapper"),o=r.legendScale,a=lt("text","dummy-text-svg",{visibility:"hidden","font-family":np[pi],"font-size":r.titleFontSize,"font-weight":"bold",transform:`scale(${o})`}),l=lt("tspan","dummy-tspan-svg",{x:200,y:200,dy:0},gp(r.rowMaxChars));switch(s.append(a.append(l)),i=a[0].getBBox().width+r.bgPadding*2,a.remove(),t){case"bottom_left":e=r.originalViewBox.w/15,n=r.originalViewBox.h*.6;break;case"bottom_right":e=r.originalViewBox.w-i*r.legendScale,n=r.originalViewBox.h*.6;break;case"top_left":e=r.originalViewBox.w/15,n=r.originalViewBox.h/15;break;case"top_right":e=r.originalViewBox.w-i*r.legendScale,n=r.originalViewBox.h/15;break}$("#legend-svg").attr({x:e,y:n}),Oa=t}function Js(t){zc=t,$("#legend-bg-rect-svg").setFill(t)}function Xs(t){Na=t,$("#legend-g-svg").setFill(t),$("#legend-g-svg tspan").setFill(t)}function Gc(t){pi=t;let e=Op(pi);$("#legend-g-svg").attr(e).css(e),$("#legend-table-body, #map-title").css(e)}function jc(t){Ra=t,["usa-counties","tamriel","westeros","oceania-detailed"].includes(Fe)?Ra?$("#Department_Names").show():$("#Department_Names").hide():Ra?Be().each(function(){Nt(this.id)||$(this).siblings().show()}):($('text[id$="_label"]').hide(),(Fe==="usa"||Fe==="usa-hex-cartogram"||Fe==="usa-and-canada")&&$('path[id$="_line"]').hide(),Fe==="india"&&$('text[id*="_label"]').hide())}function qc(t){Mc=t,Mc?$("#State_borders").show():$("#State_borders").hide()}function Op(t){t===void 0&&(t=IS_MACOS?"Helvetica":"Century Gothic",pi=t);let e=t.split(":");return{"font-family":`'${e[0]}'`,"font-weight":e[1]===void 0?"400":e[1].replace("i",""),"font-style":e[1]===void 0||!e[1].includes("i")?"normal":"italic"}}function Kc(t){xa=t,wt()}function $a(t){zr=t,Bn&&Be().each(function(){Jt.includes(this.id)||$(this).setStroke(t)}),Ec.includes(Fe)&&$("#State_borders").setStroke(t)}function Qs(t){Tp=t,$("#wrapper").css("background-color",t);let e=$("#sidemap, #sidemap2, #state_lines");up(t)>50?e.setStroke("#010101"):e.setStroke("#efefef")}function eo(t){Be().each(function(){let e=$(this);!Jt.includes(this.id)&&e.getFill()===mt&&e.setFill(t)}),mt=t}function to(t){$('#map text[id$="_label"]>tspan').setFill(t),$("#Department_Names").length===1&&$("#Department_Names").setFill(t),Ec.includes(Fe)&&($("#state_abbr").setFill(t),$("#state_lines").setStroke(t)),Wr=t}function Dp(t){Bn=t,t?Be().each(function(){Jt.includes(this.id)||$(this).setStroke(zr)}):Be().each(function(){if(!Jt.includes(this.id)){let e=$(this).getFill();Ue(e)&&(e=Zt(e).bg),$(this).setStroke(e)}})}function Yc(t){Lc=t,Lc?($("#US_States").children().each(function(){Ut(this.id),$(this).show()}),bt("United_States"),$("#United_States").hide()):($("#US_States").children().each(function(){bt(this.id),$(this).hide()}),$("#United_States").show(),Ut("United_States"))}function Zc(t){$c=t,$c?($("#Canada_States").children().each(function(){Ut(this.id),$(this).show()}),bt("Canada"),$("#Canada").hide()):($("#Canada_States").children().each(function(){bt(this.id),$(this).hide()}),$("#Canada").show(),Ut("Canada"))}function Jc(t){if(Fc=t,Fc){for(let e of Ws)$("#"+e).show(),Ut(e);$("#United_Kingdom").hide(),bt("United_Kingdom")}else{for(let e of Ws)$("#"+e).hide(),bt(e);$("#United_Kingdom").show(),Ut("United_Kingdom")}}function Xc(t){let e=["thinner","thin","medium","thick","thicker"],n=Math.pow(2,e.indexOf(t)-e.indexOf(Dc));n!==1&&(Be().each(function(){let i=$(this),r=i.getStrokeWidth(),s=n>0?r*n:r/Math.abs(n);i.setStrokeWidth(s)}),Dc=t)}function Mp(t){$(".scale-patterns-setting").prop("checked",!t),Vr=t,Be().each(function(){let e=$(this),n=e.getFill();if(Ue(n))if(Vr){let i=Aa(this.id,Be()),r=Pa(n,i);e.setFill(hi(r))}else e.setFill(hi(Fr(n)))})}function Lp(t){Da=t,$("#legendfontcolorpicker").spectrum(t?"enable":"disable"),$(".legend-font-color-container .sp-preview-inner").css("opacity",t?1:.65),wt()}function be(t,e,n){let i=e.prevConfig?e.prevConfig:nt();n();let r=e.config?e.config:nt();switch(Xe.length==Ib&&Xe.shift(),e.affectedPaths&&(e.affectedPaths.length>3?e.affectedPathsLabel=e.affectedPaths.slice(0,3).map(function(s){return s.replace(/_/g," ")})+" and more":e.affectedPathsLabel=e.affectedPaths.map(function(s){return s.replace(/_/g," ")})),e.colorpicker&&(e.colorpickerLabel=kb[e.colorpicker]),t){case"COLOR":Xe.push({action:{affectedPaths:e.affectedPaths,label:`Redo coloring ${e.affectedPathsLabel} with ${e.color}`,config:r},inverse:{affectedPaths:e.affectedPaths,label:`Undo coloring ${e.affectedPathsLabel} with ${e.color}`,config:i}});break;case"REMOVE_COLOR":Xe.push({action:{affectedPaths:e.affectedPaths,label:`Redo removing color from ${e.affectedPathsLabel}`,config:r},inverse:{affectedPaths:e.affectedPaths,label:`Undo removing color from ${e.affectedPathsLabel}`,config:i}});break;case"SHOW":Xe.push({action:{affectedPaths:e.affectedPaths,label:`Redo showing ${e.affectedPathsLabel}`,config:r},inverse:{affectedPaths:e.affectedPaths,label:`Undo showing ${e.affectedPathsLabel}`,config:i}});break;case"HIDE":Xe.push({action:{affectedPaths:e.affectedPaths,label:`Redo hiding ${e.affectedPathsLabel}`,config:r},inverse:{affectedPaths:e.affectedPaths,label:`Undo hiding ${e.affectedPathsLabel}`,config:i}});break;case"COLORPICKER_CHANGE":Xe.push({action:{label:`Redo setting ${e.colorpickerLabel} color to ${e.color}`,config:r},inverse:{label:`Undo setting ${e.colorpickerLabel} color to ${e.color}`,config:i}});break;case"LEGEND_OPTION_CHANGE":Xe.push({action:{label:`Redo setting ${e.option.replace(/[-_]/gi," ")} to ${e.value.replace(/[-_]/gi," ")}`,config:r},inverse:{label:`Undo setting ${e.option.replace(/[-_]/gi," ")} to ${e.value.replace(/[-_]/gi," ")}`,config:i}});break;case"CLEAR_ALL":Xe.push({action:{config:Uc,label:"Redo clearing map"},inverse:{config:i,label:"Undo clearing map"}});break;case"UPLOAD_CONFIG":Xe.push({action:{config:r,label:"Redo uploading map configuration"},inverse:{config:i,label:"Undo uploading map configuration"}});break;case"UPLOAD_CLOUD_CONFIG":Xe.push({action:{config:r,label:`Redo loading map configuration: ${e.configName}`},inverse:{config:i,label:`Undo loading map configuration: ${e.configName}`}});break;case"RESTORE_AUTOSAVE":Xe.push({action:{config:r,label:"Redo restoring autosave"},inverse:{config:i,label:"Undo restoring autosave"}});break;case"COLOR_MULTIPLE":Xe.push({action:{config:r,label:`Redo coloring ${e.affectedGroup}`},inverse:{config:i,label:`Undo coloring ${e.affectedGroup}`}});break;case"ISOLATE_MULTIPLE":Xe.push({action:{config:r,label:`Redo isolating ${e.affectedGroup}`},inverse:{config:i,label:`Undo isolating ${e.affectedGroup}`}});break;case"SHOW_ALL":Xe.push({action:{config:r,label:"Redo showing all"},inverse:{config:i,label:"Undo showing all"}});break;case"REARRANGE_LEGEND":Xe.push({action:{config:r,label:"Redo rearranging legend"},inverse:{config:i,label:"Undo rearranging legend"}});break;case"LEGEND_INPUT_CHANGE":Xe.push({action:{config:r,label:"Redo typing in legend"},inverse:{config:i,label:"Undo typing in legend"}});break;case"CUSTOM_LEGEND_SIZE":Xe.push({action:{config:r,label:"Redo changing legend size"},inverse:{config:i,label:"Undo changing legend size"}});break;case"CUSTOM_LEGEND_POSITION":Xe.push({action:{config:r,label:"Redo changing legend position"},inverse:{config:i,label:"Undo changing legend position"}});break;case"MAP_SETTING_CHANGE":Xe.push({action:{config:r,label:`Redo changing ${e.option.replace(/[-_]/gi," ")}`},inverse:{config:i,label:`Undo changing ${e.option.replace(/[-_]/gi," ")}`}});break}Br=[],$p()}function $p(){$("#undo-history, #redo-history").html("<ul></ul>");let t=Xe.slice(-Ur).reverse().map(function(n){return n.inverse.label}),e=Br.slice(-Ur).reverse().map(function(n){return n.action.label});if(t.length==0)$("#undo-action").prop("disabled",!0);else{$("#undo-action").prop("disabled",!1);for(let n of t){let i=Pc(n),r;i?(n=n.replace(i.color,`<div class='undo-redo-color-box' title='${i.color}'> </div>`),r=$("<li>"+n+"</li>"),r.find("div").css(i.CSSBgProperty)):r=$("<li>"+n+"</li>"),$("#undo-history>ul").append(r)}Xe.length>Ur&&$("#undo-history>ul").append(`<li> and ${Xe.length-Ur} more actions...</li>`)}if(e.length==0)$("#redo-action").prop("disabled",!0);else{$("#redo-action").prop("disabled",!1);for(let n of e){let i=Pc(n),r;i?(n=n.replace(i.color,`<div class='undo-redo-color-box' title='${i.color}'> </div>`),r=$("<li>"+n+"</li>"),r.find("div").css(i.CSSBgProperty)):r=$("<li>"+n+"</li>"),$("#redo-history>ul").append(r)}Br.length>Ur&&$("#redo-history>ul").append(`<li> and ${Br.length-Ur} more actions...</li>`)}}function Hr(t){let e=t=="undo"?Xe.pop():Br.pop();if(e){let i=(t=="undo"?e.inverse:e.action).config;zn(i)}else throw new Error("Already at oldest change");t=="undo"?Br.push(e):Xe.push(e),$p()}function Nb(t){let e,n;Ue(t)?(n=`legend-row-${t}`,e={"background-image":Fn(t),"background-repeat":"repeat"}):(n="legend-row-"+t.replace("#",""),e={"background-color":t});let i=`<tr id="${n}"><td> <div class="legend-box"> </div> </td><td> <input type="text" class="form-control legend-input" style="height:20px; width:100%;"> </input> </td><td style="text-align:center"> <button class="btn btn-icon-drop btn-error-color btn-xs legend-remove-row-btn" type="button" tabindex="-1"><i class="fa fa-times"></i></button></td></tr>`;$("#legend-table-body").append(i);let r="#"+n+" .legend-box";$(r).css(e).attr("data-paint",t),xb(r),wt(),Vc("#"+n+" .legend-input"),$("#"+n+" .legend-remove-row-btn").on("click",function(){let s=$(this).parent().siblings().find(".legend-box").attr("data-paint");Rb(s)}),Object.keys(Ve).length===50&&$("#legend-area").prepend('<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Warning!</strong> Having more than 50 legend entries may crash your browser when previewing your map. <strong>Please consider hiding the legend or showing only its title.</strong></div>'),nt(!0)}function Qc(t,e){if(Ue(t)&&(t=Fr(t)),t in Ve){Ve[t].count--;let n=Ve[t].paths.indexOf(e);Ve[t].paths.splice(n,1),Ve[t].count===0&&Fp(t)}}function Fp(t){delete Ve[t],$("#legend-row-"+t.replace("#","")).remove(),wt(),nt(!0)}function xb(t){let e=$(t).data("paint");$(t).spectrum({color:e,showInput:!0,showPalette:!0,palette:ui,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,includePatternsInPalette:!0,containerClassName:`${e.replace("#","")}-container`,preferredFormat:"hex",change:function(n,i){let r=i.toString(),s=$(this),o=s.parent().parent();if(Ue(n)){let a=Fn(n);$(this).css({"background-repeat":"repeat","background-image":a})}else $(this).css({"background-color":n,"background-image":"none"});$("#fillpicker").spectrum("set",n),be("COLOR",{affectedPaths:[...Ve[r].paths],color:n},function(){let a=Ve[r].paths;if(a.forEach(function(l){let c=$("#"+l);if(Ue(n)){if(Vr){let h=Aa(l,Be()),u=Pa(n,h);c.setFill(hi(u))}else c.setFill(hi(n));Bn||c.setStroke(Zt(n).bg)}else c.setFill(n),Bn||c.setStroke(n)}),n in Ve){let l=Ve[n].paths;Ve[n].count+=Ve[r].count,Ve[n].paths=a.concat(l),o.remove()}else Ve[n]={count:Ve[r].count,paths:a},o.attr("id","legend-row-"+n.toString().replace("#","")),s.attr("data-paint",n);delete Ve[r],wt()})},beforeShow:function(){$(this).spectrum("setSelectionPalette",Object.keys(Ve))},show:function(){for(let n in Ve)$(`.${e.replace("#","")}-container .sp-palette-container span.sp-thumb-el[title="${n}"]`).addClass("sp-thumb-active")}}),$(t).on("contextmenu",function(n){n.preventDefault(),$("#fillpicker").spectrum("set",$(n.target).attr("data-paint"))})}function Fa(){let t={},e=$("#map"),i=$("#wrapper").width(),r=di(e.attr("viewBox")),s=e.attr("data-originalVB")?di(e.attr("data-originalVB")):r;t.originalViewBox=s,t.originalLegendScale=i>s.w?s.w/i:1;let o=document.getElementById("legend-g-svg");return o?t.legendScale=Gs(o).scale:t.legendScale=t.originalLegendScale,t.titleFontSize=13,t.legendFontSize=12,t.firstRowHeight=20,t.extraRowHeight=16,t.rowTopPadding=10,t.rectSize=14,t.rowLeftMargin=24,t.rowMaxChars=28,t.bgPadding=20,t.columnGap=20,t}var Up=$("#color-single"),eu=$("#color-single-list"),Ua=$("#isolate-single"),Gr=$("#isolate-single-list"),tu=$("#revert-isolate-single"),jr=$("#isolate-alert"),Ba=$("#isolate-single-clear-others-setting"),nu=$("#isolate-many"),Bp=$("#list-to-isolate"),iu=$("#revert-isolate-many"),za=$("#isolate-many-clear-others-setting"),Db=$("#color-many"),zp=$("#list-to-color"),ru=$("#color-many-alert");function Vp(){Zp(eu),eu.on("change",function(){this.value!=="default"&&Up.prop("disabled",!1)}),Up.on("click",function(){let t=eu.val(),e=$("#fillpicker").spectrum("get").toString();be("COLOR_MULTIPLE",{affectedGroup:t},function(){Be().each(function(){hn(this.id)===t&&It(e,this.id)})})})}function Wp(){Zp(Gr),Gr.on("change",function(){this.value!=="default"&&Ua.prop("disabled",!1)}),Ua.on("click",function(){let t=Gr.val();t&&(be("ISOLATE_MULTIPLE",{affectedGroup:t},function(){Kp([t])}),Ua.prop("disabled",!0),Gr.prop("disabled",!0),tu.prop("disabled",!1),(PAGE==="usa-counties"||PAGE==="usa-congressional-districts")&&Xp(),Ba.attr("disabled",!0),jr.hide())}),tu.on("click",function(){be("SHOW_ALL",{},function(){Yp(!1)}),tu.prop("disabled",!0),Gr.prop("disabled",!1),jr.hide(),Gr.val("default"),Ua.prop("disabled",!0),Ba.attr("disabled",!1),PAGE==="usa-counties"&&$("#show-names").prop("disabled",!0),$("#show-state-borders, #show-highways, #show-state-abbrs").prop("disabled",!1)})}function Hp(){let t=new Set;Be().each(function(){t.add(hn(this.id))}),zp.attr("placeholder",Jp(PAGE)),Db.on("click",function(){ru.html("");let e=zp.val().toUpperCase().split(",");e=$.map(e,$.trim);let n="";for(let i=0,r=e.length;i<r;i++)t.has(e[i])||(n+=e[i]+", ");if(n.length>0)n=n.slice(0,-2),ru.append(`<p><em>${n}</em> are not valid. Please input valid, comma-separated values.`).show();else{let i=$("#fillpicker").spectrum("get").toString();be("COLOR_MULTIPLE",{affectedGroup:e},function(){Be().each(function(){e.includes(hn(this.id))&&It(i,this.id)})}),ru.hide()}})}function Gp(){let t=new Set;Be().each(function(){t.add(hn(this.id))}),Bp.attr("placeholder",Jp(PAGE)),nu.on("click",function(){jr.html("");let e=Bp.val().toUpperCase().split(",");e=$.map(e,$.trim);let n="";for(let i=0,r=e.length;i<r;i++)t.has(e[i])||(n+=e[i]+", ");n.length>0?(n=n.slice(0,-2),jr.append(`<p><em>${n}</em> are not valid. Please input valid, comma-separated values.`).show()):(be("ISOLATE_MULTIPLE",{affectedGroup:e},function(){Kp(e)}),(PAGE==="usa-counties"||PAGE==="usa-congressional-districts")&&Xp(),nu.prop("disabled",!0),iu.prop("disabled",!1),za.attr("disabled",!0),jr.hide())}),iu.on("click",function(){be("SHOW_ALL",{},function(){Yp(!0)}),nu.prop("disabled",!1),iu.prop("disabled",!0),za.attr("disabled",!1),jr.hide()})}function jp(){let t=[];Be().each(function(e){let n=this.id,i,r,s=n.slice(-2);s==s.toUpperCase()&&s!=s.toLowerCase()&&PAGE.indexOf("nuts")===-1?(i=n.substring(0,n.length-2),r=i.replace(/_/g," ")+" ("+s+")"):(i=n,r=i.replace(/_/g," ")),t.push({id:e,text:r,original:n})}),$(".search-entity").select2({data:t,placeholder:"Search for a subdivision..."}),$(".search-entity").on("select2:select",function(e){let n=e.params.data.original;$(this).data("selectedEntity",n)}),$("#color-from-search").on("click",function(){let e=$(".search-entity").data("selectedEntity"),n=$("#fillpicker").spectrum("get").toString();be("COLOR",{affectedPaths:[e],color:n},function(){It(n,e)})}),$("#uncolor-from-search").on("click",function(){let e=$(".search-entity").data("selectedEntity"),n=$("#"+e).getFill();be("REMOVE_COLOR",{affectedPaths:[e],prevColor:n},function(){Ti(e)})})}function qp(){$("#color-region").on("click",function(){let t=$("#color-region-list").val(),e=$("#fillpicker").spectrum("get").toString();be("COLOR_MULTIPLE",{affectedGroup:t},function(){regions[t]&&regions[t].forEach(function(n){$("#"+n).length&&It(e,n)})})})}async function Kp(t){let e=$("#map"),n=parseFloat(e.attr("width")),i=parseFloat(e.attr("height")),r=Math.min(n,i),s=parseFloat(e.attr("data-originalStrokeWidth")),o,a,l,c,h=0,u=0,d=n,p=i,_=[];PAGE==="usa-counties"&&t.length===1&&await Mb(t[0]);let g=t.length>1?za.prop("checked"):Ba.prop("checked");Be().each(function(){t.includes(hn(this.id))?({x:o,y:a,width:l,height:c}=this.getBBox(),o<d&&(d=o),a<p&&(p=a),o+l>h&&(h=o+l),a+c>u&&(u=a+c),_.push(this)):g?bt(this.id):$("#"+this.id).hide()});let y=h-d,v=u-p,w=Math.min(r,Math.max(y,v));w*=1.1;let S,x,P;n>i?(S=d-(w*(n/i)-y)/2,x=p-(w-v)/2,P=s*(1-Math.abs((w-n)/n))):(S=d-(w-y)/2,x=p-(w*(i/n)-v)/2,P=s*(1-Math.abs((w-i)/i))),P=Math.max(P,.1),e.attr("data-originalVB",e.attr("viewBox"));let F=`${S} ${x} ${w} ${w}`;gsap.to(e[0],{duration:1,attr:{viewBox:F}});for(let C of _)C.setAttribute("stroke-width",P),C.style.strokeWidth=P;window.isTestingLocally&&($("input#VBxSlider").slider("setValue",S),$("input#VBySlider").slider("setValue",x),$("input#VBwSlider").slider("setValue",w),$("input#VBhSlider").slider("setValue",w))}async function Mb(t){let e="svg/counties/"+t+".txt?v='1.5'";$.ajax({url:e,dataType:"text",success:function(n){var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("fill",Wr),i.setAttribute("id","Department_Names"),i.setAttribute("d",n),i.setAttribute("stroke","none"),$("#map")[0].appendChild(i),$("#show-names").prop("checked")||(i.style.display="none")}})}function Yp(t){let e=$("#map");PAGE==="usa-counties"&&$("#Department_Names").remove();let n=parseFloat(e.attr("data-originalStrokeWidth")),i=t?za.prop("checked"):Ba.prop("checked");Be().each(function(){let r=$("#"+this.id);!i&&r.css("display")==="none"?r.show():i&&Nt(this.id)?Ut(this.id):(this.setAttribute("stroke-width",n),this.style.strokeWidth=n)}),$("#State_borders").show(),gsap.to(e[0],{duration:1,attr:{viewBox:e.attr("data-originalVB")}})}function Zp(t){let e=Ea();for(let n of[...e].sort())if(n!==void 0){let i=$("<option>"),r=Ca(n);i.val(n).html(`${n} - ${r}`),t.append(i)}}function Jp(t){let e="";return t.includes("usa")?e="Example: CA, FL, NY":t.includes("canada")?e="Example: ON, MB, QC":t.includes("europe")?e="Example: DE, IT, FR":t.includes("americas")?e="Example: US, CA, MX":t.includes("africa")?e="Example: EG, LY, KE":t.includes("asia")?e="Example: JP, CN, KR":t.includes("oceania")?e="Example: AU, PG, NZ":t.includes("brazil")?e="Example: BA, RJ, MG":e="Example: US, CN, RU",e}function Xp(){$("#show-state-borders, #show-highways, #show-state-abbrs").prop("checked",!1).trigger("change"),$("#show-state-borders, #show-highways, #show-state-abbrs").prop("disabled",!0),$("#show-names").prop("disabled",!1)}var ou={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var oe=function(t,e){if(!t)throw Qi(e)},Qi=function(t){return new Error("Firebase Database ("+ou.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};var em=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},$b=function(t){let e=[],n=0,i=0;for(;n<t.length;){let r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Kr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){let s=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,h=s>>2,u=(s&3)<<4|a>>4,d=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(d=64)),i.push(n[h],n[u],n[d],n[p])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(em(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$b(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){let s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;let c=r<t.length?n[t.charAt(r)]:64;++r;let u=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||c==null||u==null)throw Error();let d=s<<2|a>>4;if(i.push(d),c!==64){let p=a<<4&240|c>>2;if(i.push(p),u!==64){let _=c<<6&192|u;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},lu=function(t){let e=em(t);return Kr.encodeByteArray(e,!0)},cu=function(t){return lu(t).replace(/\./g,"")},Va=function(t){try{return Kr.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function tm(t){return nm(void 0,t)}function nm(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(let n in e)!e.hasOwnProperty(n)||!Fb(n)||(t[n]=nm(t[n],e[n]));return t}function Fb(t){return t!=="__proto__"}var Bt=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}};function St(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function no(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(St())}function im(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ha(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rm(){let t=St();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Vn(){return ou.NODE_CLIENT===!0||ou.NODE_ADMIN===!0}function io(){return typeof indexedDB=="object"}function sm(){return new Promise((t,e)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function om(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Ub="FirebaseError",fn=class extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=Ub,Object.setPrototypeOf(this,fn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cn.prototype.create)}},Cn=class{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){let i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?Bb(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new fn(r,a,i)}};function Bb(t,e){return t.replace(zb,(n,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var zb=/\{\$([^}]+)}/g;function qr(t){return JSON.parse(t)}function ft(t){return JSON.stringify(t)}var am=function(t){let e={},n={},i={},r="";try{let s=t.split(".");e=qr(Va(s[0])||""),n=qr(Va(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}};var lm=function(t){let e=am(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},cm=function(t){let e=am(t).claims;return typeof e=="object"&&e.admin===!0};function Tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function er(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function ro(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function so(t,e,n){let i={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function Yr(t,e){if(t===e)return!0;let n=Object.keys(t),i=Object.keys(e);for(let r of n){if(!i.includes(r))return!1;let s=t[r],o=e[r];if(Qp(s)&&Qp(o)){if(!Yr(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!n.includes(r))return!1;return!0}function Qp(t){return t!==null&&typeof t=="object"}function Ii(t){let e=[];for(let[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Zr(t){let e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){let[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function Jr(t){let e=t.indexOf("?");if(!e)return"";let n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var Wa=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);let i=this.W_;if(typeof e=="string")for(let u=0;u<16;u++)i[u]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let u=0;u<16;u++)i[u]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let u=16;u<80;u++){let d=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let u=0;u<80;u++){u<40?u<20?(c=a^s&(o^a),h=1518500249):(c=s^o^a,h=1859775393):u<60?(c=s&o|a&(s|o),h=2400959708):(c=s^o^a,h=3395469782);let d=(r<<5|r>>>27)+c+l+h+i[u]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);let i=n-this.blockSize,r=0,s=this.buf_,o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){let e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}};function um(t,e){let n=new au(t,e);return n.subscribe.bind(n)}var au=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let r;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");Vb(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:i},r.next===void 0&&(r.next=su),r.error===void 0&&(r.error=su),r.complete===void 0&&(r.complete=su);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Vb(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function su(){}function oo(t,e){return`${t} failed: ${e} argument `}var dm=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){let s=r-55296;i++,oe(i<t.length,"Surrogate pair missing trail surrogate.");let o=t.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},ao=function(t){let e=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};var Wb=1e3,Hb=2,Gb=4*60*60*1e3,jb=.5;function hm(t,e=Wb,n=Hb){let i=e*Math.pow(n,t),r=Math.round(jb*i*(Math.random()-.5)*2);return Math.min(Gb,i+r)}function Oe(t){return t&&t._delegate?t._delegate:t}var Et=class{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var tr="[DEFAULT]";var uu=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let i=new Bt;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Kb(e))try{this.getOrInitializeService({instanceIdentifier:tr})}catch{}for(let[n,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=tr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tr){return this.instances.has(e)}getOptions(e=tr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;let r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let i=this.onInitCallbacks.get(n);if(!!i)for(let r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qb(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=tr){return this.component?this.component.multipleInstances?e:tr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function qb(t){return t===tr?void 0:t}function Kb(t){return t.instantiationMode==="EAGER"}var Ga=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new uu(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var Yb=[],Le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Le||(Le={}));var Zb={debug:Le.DEBUG,verbose:Le.VERBOSE,info:Le.INFO,warn:Le.WARN,error:Le.ERROR,silent:Le.SILENT},Jb=Le.INFO,Xb={[Le.DEBUG]:"log",[Le.VERBOSE]:"log",[Le.INFO]:"info",[Le.WARN]:"warn",[Le.ERROR]:"error"},Qb=(t,e,...n)=>{if(e<t.logLevel)return;let i=new Date().toISOString(),r=Xb[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},pn=class{constructor(e){this.name=e,this._logLevel=Jb,this._logHandler=Qb,this._userLogHandler=null,Yb.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Zb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Le.DEBUG,...e),this._logHandler(this,Le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Le.VERBOSE,...e),this._logHandler(this,Le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Le.INFO,...e),this._logHandler(this,Le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Le.WARN,...e),this._logHandler(this,Le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Le.ERROR,...e),this._logHandler(this,Le.ERROR,...e)}};var e0=(t,e)=>e.some(n=>t instanceof n),fm,pm;function t0(){return fm||(fm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function n0(){return pm||(pm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var mm=new WeakMap,hu=new WeakMap,gm=new WeakMap,du=new WeakMap,pu=new WeakMap;function i0(t){let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Wn(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&mm.set(n,t)}).catch(()=>{}),pu.set(e,t),e}function r0(t){if(hu.has(t))return;let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});hu.set(t,e)}var fu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return hu.get(t);if(e==="objectStoreNames")return t.objectStoreNames||gm.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function _m(t){fu=t(fu)}function s0(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let i=t.call(ja(this),e,...n);return gm.set(i,e.sort?e.sort():[e]),Wn(i)}:n0().includes(t)?function(...e){return t.apply(ja(this),e),Wn(mm.get(this))}:function(...e){return Wn(t.apply(ja(this),e))}}function o0(t){return typeof t=="function"?s0(t):(t instanceof IDBTransaction&&r0(t),e0(t,t0())?new Proxy(t,fu):t)}function Wn(t){if(t instanceof IDBRequest)return i0(t);if(du.has(t))return du.get(t);let e=o0(t);return e!==t&&(du.set(t,e),pu.set(e,t)),e}var ja=t=>pu.get(t);function ym(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(t,e),a=Wn(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Wn(o.result),l.oldVersion,l.newVersion,Wn(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}var a0=["get","getKey","getAll","getAllKeys","count"],l0=["put","add","delete","clear"],mu=new Map;function vm(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(mu.get(e))return mu.get(e);let n=e.replace(/FromIndex$/,""),i=e!==n,r=l0.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||a0.includes(n)))return;let s=async function(o,...a){let l=this.transaction(o,r?"readwrite":"readonly"),c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&l.done]))[0]};return mu.set(e,s),s}_m(t=>({...t,get:(e,n,i)=>vm(e,n)||t.get(e,n,i),has:(e,n)=>!!vm(e,n)||t.has(e,n)}));var _u=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(c0(n)){let i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}};function c0(t){let e=t.getComponent();return e?.type==="VERSION"}var vu="@firebase/app",bm="0.7.24";var Eu=new pn("@firebase/app"),u0="@firebase/app-compat",d0="@firebase/analytics-compat",h0="@firebase/analytics",f0="@firebase/app-check-compat",p0="@firebase/app-check",m0="@firebase/auth",g0="@firebase/auth-compat",_0="@firebase/database",v0="@firebase/database-compat",y0="@firebase/functions",b0="@firebase/functions-compat",w0="@firebase/installations",S0="@firebase/installations-compat",E0="@firebase/messaging",C0="@firebase/messaging-compat",T0="@firebase/performance",I0="@firebase/performance-compat",k0="@firebase/remote-config",A0="@firebase/remote-config-compat",P0="@firebase/storage",R0="@firebase/storage-compat",N0="@firebase/firestore",x0="@firebase/firestore-compat",O0="firebase",D0="9.8.1";var Cm="[DEFAULT]",M0={[vu]:"fire-core",[u0]:"fire-core-compat",[h0]:"fire-analytics",[d0]:"fire-analytics-compat",[p0]:"fire-app-check",[f0]:"fire-app-check-compat",[m0]:"fire-auth",[g0]:"fire-auth-compat",[_0]:"fire-rtdb",[v0]:"fire-rtdb-compat",[y0]:"fire-fn",[b0]:"fire-fn-compat",[w0]:"fire-iid",[S0]:"fire-iid-compat",[E0]:"fire-fcm",[C0]:"fire-fcm-compat",[T0]:"fire-perf",[I0]:"fire-perf-compat",[k0]:"fire-rc",[A0]:"fire-rc-compat",[P0]:"fire-gcs",[R0]:"fire-gcs-compat",[N0]:"fire-fst",[x0]:"fire-fst-compat","fire-js":"fire-js",[O0]:"fire-js-all"};var qa=new Map,yu=new Map;function L0(t,e){try{t.container.addComponent(e)}catch(n){Eu.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Xt(t){let e=t.name;if(yu.has(e))return Eu.debug(`There were multiple attempts to register component ${e}.`),!1;yu.set(e,t);for(let n of qa.values())L0(n,t);return!0}function Hn(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}var $0={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},nr=new Cn("app","Firebase",$0);var bu=class{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Et("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nr.create("app-deleted",{appName:this._name})}};var mi=D0;function Tm(t,e={}){typeof e!="object"&&(e={name:e});let n=Object.assign({name:Cm,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw nr.create("bad-app-name",{appName:String(i)});let r=qa.get(i);if(r){if(Yr(t,r.options)&&Yr(n,r.config))return r;throw nr.create("duplicate-app",{appName:i})}let s=new Ga(i);for(let a of yu.values())s.addComponent(a);let o=new bu(t,n,s);return qa.set(i,o),o}function ki(t=Cm){let e=qa.get(t);if(!e)throw nr.create("no-app",{appName:t});return e}function kt(t,e,n){var i;let r=(i=M0[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Eu.warn(a.join(" "));return}Xt(new Et(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var F0="firebase-heartbeat-database",U0=1,lo="firebase-heartbeat-store",gu=null;function Im(){return gu||(gu=ym(F0,U0,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(lo)}}}).catch(t=>{throw nr.create("storage-open",{originalErrorMessage:t.message})})),gu}async function B0(t){try{return(await Im()).transaction(lo).objectStore(lo).get(km(t))}catch(e){throw nr.create("storage-get",{originalErrorMessage:e.message})}}async function wm(t,e){try{let i=(await Im()).transaction(lo,"readwrite");return await i.objectStore(lo).put(e,km(t)),i.done}catch(n){throw nr.create("storage-set",{originalErrorMessage:n.message})}}function km(t){return`${t.name}!${t.options.appId}`}var z0=1024,V0=30*24*60*60*1e3,wu=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Su(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){let n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Sm();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{let s=new Date(r.date).valueOf();return Date.now()-s<=V0}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Sm(),{heartbeatsToSend:n,unsentEntries:i}=W0(this._heartbeatsCache.heartbeats),r=cu(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}};function Sm(){return new Date().toISOString().substring(0,10)}function W0(t,e=z0){let n=[],i=t.slice();for(let r of t){let s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Em(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Em(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}var Su=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return io()?sm().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await B0(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){let r=await this.read();return wm(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){let r=await this.read();return wm(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function Em(t){return cu(JSON.stringify({version:2,heartbeats:t})).length}function H0(t){Xt(new Et("platform-logger",e=>new _u(e),"PRIVATE")),Xt(new Et("heartbeat",e=>new wu(e),"PRIVATE")),kt(vu,bm,t),kt(vu,bm,"esm2017"),kt("fire-js","")}H0("");var zt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};zt.UNAUTHENTICATED=new zt(null),zt.GOOGLE_CREDENTIALS=new zt("google-credentials-uid"),zt.FIRST_PARTY=new zt("first-party-uid"),zt.MOCK_USER=new zt("mock-user");var os="9.8.0";var Xr=new pn("@firebase/firestore");function Ka(t,...e){if(Xr.logLevel<=Le.DEBUG){let n=e.map(nd);Xr.debug(`Firestore (${os}): ${t}`,...n)}}function td(t,...e){if(Xr.logLevel<=Le.ERROR){let n=e.map(nd);Xr.error(`Firestore (${os}): ${t}`,...n)}}function j0(t,...e){if(Xr.logLevel<=Le.WARN){let n=e.map(nd);Xr.warn(`Firestore (${os}): ${t}`,...n)}}function nd(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}var e}function _n(t="Unexpected state"){let e=`FIRESTORE (${os}) INTERNAL ASSERTION FAILED: `+t;throw td(e),new Error(e)}function Wt(t,e){t||_n()}function Lm(t,e){return t}var Am="ok",q0="cancelled",co="unknown",Ge="invalid-argument",K0="deadline-exceeded",Y0="not-found";var Z0="permission-denied",Tu="unauthenticated",J0="resource-exhausted",Qr="failed-precondition",X0="aborted",Q0="out-of-range",ew="unimplemented",tw="internal",nw="unavailable";var ke=class extends fn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Iu=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},ku=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(zt.UNAUTHENTICATED))}shutdown(){}};var Au=class{constructor(e){this.auth=null,e.onInit(n=>{this.auth=n})}getToken(){return this.auth?this.auth.getToken().then(e=>e?(Wt(typeof e.accessToken=="string"),new Iu(e.accessToken,new zt(this.auth.getUid()))):null):Promise.resolve(null)}invalidateToken(){}start(e,n){}shutdown(){}},Pu=class{constructor(e,n,i){this.type="FirstParty",this.user=zt.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);let r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),i&&this.headers.set("X-Goog-Iam-Authorization-Token",i)}},Ru=class{constructor(e,n,i){this.t=e,this.i=n,this.o=i}getToken(){return Promise.resolve(new Pu(this.t,this.i,this.o))}start(e,n){e.enqueueRetryable(()=>n(zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Nu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},xu=class{constructor(e){this.u=e,this.appCheck=null,e.onInit(n=>{this.appCheck=n})}getToken(){return this.appCheck?this.appCheck.getToken().then(e=>e?(Wt(typeof e.token=="string"),new Nu(e.token)):null):Promise.resolve(null)}invalidateToken(){}start(e,n){}shutdown(){}};var Ou=class{constructor(e,n,i,r,s,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}},Pi=class{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Pi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Pi&&e.projectId===this.projectId&&e.database===this.database}};var ir=class{constructor(e,n,i){n===void 0?n=0:n>e.length&&_n(),i===void 0?i=e.length-n:i>e.length-n&&_n(),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ir.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof ir?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let i=Math.min(e.length,n.length);for(let r=0;r<i;r++){let s=e.get(r),o=n.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},gt=class extends ir{construct(e,n,i){return new gt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let n=[];for(let i of e){if(i.indexOf("//")>=0)throw new ke(Ge,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new gt(n)}static emptyPath(){return new gt([])}},iw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,mn=class extends ir{construct(e,n,i){return new mn(e,n,i)}static isValidIdentifier(e){return iw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new mn(["__name__"])}static fromServerFormat(e){let n=[],i="",r=0,s=()=>{if(i.length===0)throw new ke(Ge,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""},o=!1;for(;r<e.length;){let a=e[r];if(a==="\\"){if(r+1===e.length)throw new ke(Ge,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ke(Ge,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new ke(Ge,"Unterminated ` in path: "+e);return new mn(n)}static emptyPath(){return new mn([])}};var en=class{constructor(e){this.path=e}static fromPath(e){return new en(gt.fromString(e))}static fromName(e){return new en(gt.fromString(e).popFirst(5))}static empty(){return new en(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new en(new gt(e.slice()))}};function rw(t,e,n){if(!n)throw new ke(Ge,`Function ${t}() cannot be called with an empty ${e}.`)}function Pm(t){if(!en.isDocumentKey(t))throw new ke(Ge,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function id(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_n()}function rd(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ke(Ge,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=id(t);throw new ke(Ge,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Ya(t){return t===0&&1/t==-1/0}var sw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};var Rm,Me;function Nm(t){if(t===void 0)return td("RPC_ERROR","HTTP error has no status"),co;switch(t){case 200:return Am;case 400:return Qr;case 401:return Tu;case 403:return Z0;case 404:return Y0;case 409:return X0;case 416:return Q0;case 429:return J0;case 499:return q0;case 500:return co;case 501:return ew;case 503:return nw;case 504:return K0;default:return t>=200&&t<300?Am:t>=400&&t<500?Qr:t>=500&&t<600?tw:co}}(Me=Rm||(Rm={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";var Du=class extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let n=e.ssl?"https":"http";this.h=n+"://"+e.host,this.l="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}m(e,n,i,r,s){let o=this.p(e,n);Ka("RestConnection","Sending: ",o,i);let a={};return this.g(a,r,s),this.v(e,o,a,i).then(l=>(Ka("RestConnection","Received: ",l),l),l=>{throw j0("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",i),l})}T(e,n,i,r,s){return this.m(e,n,i,r,s)}g(e,n,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+os,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}p(e,n){let i=sw[e];return`${this.h}/v1/${n}:${i}`}}{constructor(e,n){super(e),this.A=n}I(e,n){throw new Error("Not supported by FetchConnection")}async v(e,n,i,r){let s=JSON.stringify(r),o;try{o=await this.A(n,{method:"POST",headers:i,body:s})}catch(a){throw new ke(Nm(a.status),"Request failed with error: "+a.statusText)}if(!o.ok)throw new ke(Nm(o.status),"Request failed with error: "+o.statusText);return o.json()}};function ow(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}var Mu=class{static R(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=ow(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=e.charAt(r[s]%e.length))}return i}};function fo(t,e){return t<e?-1:t>e?1:0}function $m(t,e,n){return t.length===e.length&&t.every((i,r)=>n(i,e[r]))}var xt=class{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ke(Ge,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ke(Ge,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ke(Ge,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(Ge,"Timestamp seconds out of range: "+e)}static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*n));return new xt(n,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?fo(this.nanoseconds,e.nanoseconds):fo(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var gn=class{constructor(e){this.timestamp=e}static fromTimestamp(e){return new gn(e)}static min(){return new gn(new xt(0,0))}static max(){return new gn(new xt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};function xm(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function vo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}var es=class{constructor(e){this.fields=e,e.sort(mn.comparator)}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return $m(this.fields,e.fields,(n,i)=>n.isEqual(i))}};var kn=class{constructor(e){this.binaryString=e}static fromBase64String(e){let n=atob(e);return new kn(n)}static fromUint8Array(e){let n=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new kn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){let n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fo(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};kn.EMPTY_BYTE_STRING=new kn("");var aw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function po(t){if(Wt(!!t),typeof t=="string"){let e=0,n=aw.exec(t);if(Wt(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Qt(t.seconds),nanos:Qt(t.nanos)}}function Qt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Lu(t){return typeof t=="string"?kn.fromBase64String(t):kn.fromUint8Array(t)}function Fm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Um(t){let e=t.mapValue.fields.__previous_value__;return Fm(e)?Um(e):e}function $u(t){let e=po(t.mapValue.fields.__local_write_time__.timestampValue);return new xt(e.seconds,e.nanos)}function Fu(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fm(t)?4:function(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}(t)?9007199254740991:10:_n()}function Uu(t,e){if(t===e)return!0;let n=Fu(t);if(n!==Fu(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $u(t).isEqual($u(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;let s=po(i.timestampValue),o=po(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,r){return Lu(i.bytesValue).isEqual(Lu(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,r){return Qt(i.geoPointValue.latitude)===Qt(r.geoPointValue.latitude)&&Qt(i.geoPointValue.longitude)===Qt(r.geoPointValue.longitude)}(t,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return Qt(i.integerValue)===Qt(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){let s=Qt(i.doubleValue),o=Qt(r.doubleValue);return s===o?Ya(s)===Ya(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return $m(t.arrayValue.values||[],e.arrayValue.values||[],Uu);case 10:return function(i,r){let s=i.mapValue.fields||{},o=r.mapValue.fields||{};if(xm(s)!==xm(o))return!1;for(let a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!Uu(s[a],o[a])))return!1;return!0}(t,e);default:return _n()}}function Cu(t){return!!t&&"mapValue"in t}function uo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return vo(t.mapValue.fields,(n,i)=>e.mapValue.fields[n]=uo(i)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=uo(t.arrayValue.values[n]);return e}return Object.assign({},t)}var Vt=class{constructor(e){this.value=e}static empty(){return new Vt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!Cu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=uo(n)}setAll(e){let n=mn.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let l=this.getFieldsMap(n);this.applyChanges(l,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=uo(o):r.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(e){let n=this.field(e.popLast());Cu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Uu(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=n.mapValue.fields[e.get(i)];Cu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,i){vo(n,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new Vt(uo(this.value))}};var In=class{constructor(e,n,i,r,s,o){this.key=e,this.documentType=n,this.version=i,this.readTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new In(e,0,gn.min(),gn.min(),Vt.empty(),0)}static newFoundDocument(e,n,i){return new In(e,1,n,gn.min(),i,0)}static newNoDocument(e,n){return new In(e,2,n,gn.min(),Vt.empty(),0)}static newUnknownDocument(e,n){return new In(e,3,n,gn.min(),Vt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Bu=class{constructor(e,n=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.$=null,this.S=null,this.startAt,this.endAt}};function lw(t,e){return function(n){return typeof n=="number"&&Number.isInteger(n)&&!Ya(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(e)?function(n){return{integerValue:""+n}}(e):function(n,i){if(n.F){if(isNaN(i))return{doubleValue:"NaN"};if(i===1/0)return{doubleValue:"Infinity"};if(i===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ya(i)?"-0":i}}(t,e)}var ts=class{constructor(){this._=void 0}},zu=class extends ts{},Za=class extends ts{constructor(e){super(),this.elements=e}},Ja=class extends ts{constructor(e){super(),this.elements=e}},Vu=class extends ts{constructor(e,n){super(),this.q=e,this.O=n}};var Xa=class{constructor(e,n){this.field=e,this.transform=n}},Ai=class{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ai}static exists(e){return new Ai(void 0,e)}static updateTime(e){return new Ai(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}},ns=class{},Qa=class extends ns{constructor(e,n,i,r=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}},mo=class extends ns{constructor(e,n,i,r,s=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}},Wu=class extends ns{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}},Hu=class extends ns{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}};var Kk=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Yk=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Gu=class{constructor(e,n){this.databaseId=e,this.F=n}};function ju(t,e){return t.F?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cw(t,e){return t.F?e.toBase64():e.toUint8Array()}function uw(t,e){return ju(t,e.toTimestamp())}function Om(t){return Wt(!!t),gn.fromTimestamp(function(e){let n=po(e);return new xt(n.seconds,n.nanos)}(t))}function Bm(t,e){return function(n){return new gt(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function el(t,e){return Bm(t.databaseId,e.path)}function Dm(t,e){let n=function(r){let s=gt.fromString(r);return Wt(Vm(s)),s}(e);if(n.get(1)!==t.databaseId.projectId)throw new ke(Ge,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ke(Ge,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new en((Wt((i=n).length>4&&i.get(4)==="documents"),i.popFirst(5)));var i}function zm(t){return new gt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Mm(t,e,n){return{name:el(t,e),fields:n.value.mapValue.fields}}function dw(t,e){return"found"in e?function(n,i){Wt(!!i.found),i.found.name,i.found.updateTime;let r=Dm(n,i.found.name),s=Om(i.found.updateTime),o=new Vt({mapValue:{fields:i.found.fields}});return In.newFoundDocument(r,s,o)}(t,e):"missing"in e?function(n,i){Wt(!!i.missing),Wt(!!i.readTime);let r=Dm(n,i.missing),s=Om(i.readTime);return In.newNoDocument(r,s)}(t,e):_n()}function hw(t,e){let n;if(e instanceof Qa)n={update:Mm(t,e.key,e.value)};else if(e instanceof Wu)n={delete:el(t,e.key)};else if(e instanceof mo)n={update:Mm(t,e.key,e.data),updateMask:fw(e.fieldMask)};else{if(!(e instanceof Hu))return _n();n={verify:el(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(i=>function(r,s){let o=s.transform;if(o instanceof zu)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Za)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ja)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Vu)return{fieldPath:s.field.canonicalString(),increment:o.O};throw _n()}(0,i))),e.precondition.isNone||(n.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:uw(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:_n()}(t,e.precondition)),n}function fw(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Vm(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function sd(t){return new Gu(t,!0)}var qu=class extends class{}{constructor(e,n,i,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.K=i,this.q=r,this.J=!1}X(){if(this.J)throw new ke(Qr,"The client has already been terminated.")}m(e,n,i){return this.X(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.K.m(e,n,i,r,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Tu&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new ke(co,r.toString())})}T(e,n,i){return this.X(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.K.T(e,n,i,r,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Tu&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new ke(co,r.toString())})}terminate(){this.J=!0}};async function Wm(t,e){let n=Lm(t),i=zm(n.q)+"/documents",r={writes:e.map(s=>hw(n.q,s))};await n.m("Commit",i,r)}async function pw(t,e){let n=Lm(t),i=zm(n.q)+"/documents",r={documents:e.map(l=>el(n.q,l))},s=await n.T("BatchGetDocuments",i,r),o=new Map;s.forEach(l=>{let c=dw(n.q,l);o.set(c.key.toString(),c)});let a=[];return e.forEach(l=>{let c=o.get(l.toString());Wt(!!c),a.push(c)}),a}var ho=new Map;function od(t){if(t._terminated)throw new ke(Qr,"The client has already been terminated.");if(!ho.has(t)){Ka("ComponentProvider","Initializing Datastore");let s=function(l){return new Du(l,fetch.bind(null))}((e=t._databaseId,n=t.app.options.appId||"",i=t._persistenceKey,r=t._freezeSettings(),new Ou(e,n,i,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams))),o=sd(t._databaseId),a=function(l,c,h,u){return new qu(l,c,h,u)}(t._authCredentials,t._appCheckCredentials,s,o);ho.set(t,a)}var e,n,i,r;return ho.get(t)}var tl=class{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new ke(Ge,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ke(Ge,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(i,r,s,o){if(r===!0&&o===!0)throw new ke(Ge,`${i} and ${s} cannot be used together.`)}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};var nl=class{constructor(e,n,i){this._authCredentials=n,this._appCheckCredentials=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tl({}),this._settingsFrozen=!1,e instanceof Pi?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new ke(Ge,'"projectId" not provided in firebase.initializeApp.');return new Pi(r.options.projectId)}(e))}get app(){if(!this._app)throw new ke(Qr,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new ke(Qr,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tl(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new ku;switch(n.type){case"gapi":let i=n.client;return Wt(!(typeof i!="object"||i===null||!i.auth||!i.auth.getAuthHeaderValueForFirstParty)),new Ru(i,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new ke(Ge,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let n=ho.get(e);n&&(Ka("ComponentProvider","Removing Datastore"),ho.delete(e),n.terminate())}(this),Promise.resolve()}};function Ni(t=ki()){return Hn(t,"firestore/lite").getImmediate()}var Ot=class{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ot(this.firestore,e,this._key)}},go=class{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new go(this.firestore,e,this._query)}},rr=class extends go{constructor(e,n,i){super(e,n,new Bu(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ot(this.firestore,null,new en(e))}withConverter(e){return new rr(this.firestore,e,this._path)}};function xi(t,e,...n){if(t=Oe(t),arguments.length===1&&(e=Mu.R()),rw("doc","path",e),t instanceof nl){let i=gt.fromString(e,...n);return Pm(i),new Ot(t,null,new en(i))}{if(!(t instanceof Ot||t instanceof rr))throw new ke(Ge,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=t._path.child(gt.fromString(e,...n));return Pm(i),new Ot(t.firestore,t instanceof rr?t.converter:null,new en(i))}}var is=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ke(Ge,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ri=class{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ri(kn.fromBase64String(e))}catch(n){throw new ke(Ge,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ri(kn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var sr=class{constructor(e){this._methodName=e}};var _o=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ke(Ge,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ke(Ge,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return fo(this._lat,e._lat)||fo(this._long,e._long)}};var mw=/^__.*__$/,Ku=class{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new mo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qa(e,this.data,n,this.fieldTransforms)}},il=class{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new mo(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function Hm(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _n()}}var rs=class{constructor(e,n,i,r,s,o){this.settings=e,this.databaseId=n,this.q=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Z(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get tt(){return this.settings.tt}et(e){return new rs(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.q,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}nt(e){var n;let i=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.et({path:i,rt:!1});return r.st(e),r}it(e){var n;let i=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.et({path:i,rt:!1});return r.Z(),r}ot(e){return this.et({path:void 0,rt:!0})}ut(e){return rl(e,this.settings.methodName,this.settings.ct||!1,this.path,this.settings.at)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Z(){if(this.path)for(let e=0;e<this.path.length;e++)this.st(this.path.get(e))}st(e){if(e.length===0)throw this.ut("Document fields must not be empty");if(Hm(this.tt)&&mw.test(e))throw this.ut('Document fields cannot begin and end with "__"')}},Yu=class{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.q=i||sd(e)}ht(e,n,i,r=!1){return new rs({tt:e,methodName:n,at:i,path:mn.emptyPath(),rt:!1,ct:r},this.databaseId,this.q,this.ignoreUndefinedProperties)}};function Gm(t){let e=t._freezeSettings(),n=sd(t._databaseId);return new Yu(t._databaseId,!!e.ignoreUndefinedProperties,n)}function gw(t,e,n,i,r,s={}){let o=t.ht(s.merge||s.mergeFields?2:0,e,n,r);ad("Data must be an object, but it was:",o,i);let a=qm(i,o),l,c;if(s.merge)l=new es(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let u of s.mergeFields){let d=Xu(e,u,n);if(!o.contains(d))throw new ke(Ge,`Field '${d}' is specified in your field mask but missing from your input data.`);Ym(h,d)||h.push(d)}l=new es(h),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new Ku(new Vt(a),l,c)}var ss=class extends sr{_toFieldTransform(e){if(e.tt!==2)throw e.tt===1?e.ut(`${this._methodName}() can only appear at the top level of your update data`):e.ut(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ss}};function jm(t,e,n){return new rs({tt:3,at:e.settings.at,methodName:t._methodName,rt:n},e.databaseId,e.q,e.ignoreUndefinedProperties)}var Zu=class extends sr{constructor(e,n){super(e),this.lt=n}_toFieldTransform(e){let n=jm(this,e,!0),i=this.lt.map(s=>as(s,n)),r=new Za(i);return new Xa(e.path,r)}isEqual(e){return this===e}},Ju=class extends sr{constructor(e,n){super(e),this.lt=n}_toFieldTransform(e){let n=jm(this,e,!0),i=this.lt.map(s=>as(s,n)),r=new Ja(i);return new Xa(e.path,r)}isEqual(e){return this===e}};function _w(t,e,n,i){let r=t.ht(1,e,n);ad("Data must be an object, but it was:",r,i);let s=[],o=Vt.empty();vo(i,(l,c)=>{let h=ld(e,l,n);c=Oe(c);let u=r.it(h);if(c instanceof ss)s.push(h);else{let d=as(c,u);d!=null&&(s.push(h),o.set(h,d))}});let a=new es(s);return new il(o,a,r.fieldTransforms)}function vw(t,e,n,i,r,s){let o=t.ht(1,e,n),a=[Xu(e,i,n)],l=[r];if(s.length%2!=0)throw new ke(Ge,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Xu(e,s[d])),l.push(s[d+1]);let c=[],h=Vt.empty();for(let d=a.length-1;d>=0;--d)if(!Ym(c,a[d])){let p=a[d],_=l[d];_=Oe(_);let g=o.it(p);if(_ instanceof ss)c.push(p);else{let y=as(_,g);y!=null&&(c.push(p),h.set(p,y))}}let u=new es(c);return new il(h,u,o.fieldTransforms)}function as(t,e){if(Km(t=Oe(t)))return ad("Unsupported field value:",e,t),qm(t,e);if(t instanceof sr)return function(n,i){if(!Hm(i.tt))throw i.ut(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.ut(`${n._methodName}() is not currently supported inside arrays`);let r=n._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.rt&&e.tt!==4)throw e.ut("Nested arrays are not supported");return function(n,i){let r=[],s=0;for(let o of n){let a=as(o,i.ot(s));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),s++}return{arrayValue:{values:r}}}(t,e)}return function(n,i){if((n=Oe(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return lw(i.q,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let r=xt.fromDate(n);return{timestampValue:ju(i.q,r)}}if(n instanceof xt){let r=new xt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ju(i.q,r)}}if(n instanceof _o)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ri)return{bytesValue:cw(i.q,n._byteString)};if(n instanceof Ot){let r=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(r))throw i.ut(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Bm(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.ut(`Unsupported field value: ${id(n)}`)}(t,e)}function qm(t,e){let n={};return function(i){for(let r in i)if(Object.prototype.hasOwnProperty.call(i,r))return!1;return!0}(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vo(t,(i,r)=>{let s=as(r,e.nt(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function Km(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xt||t instanceof _o||t instanceof Ri||t instanceof Ot||t instanceof sr)}function ad(t,e,n){if(!Km(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let i=id(n);throw i==="an object"?e.ut(t+" a custom object"):e.ut(t+" "+i)}}function Xu(t,e,n){if((e=Oe(e))instanceof is)return e._internalPath;if(typeof e=="string")return ld(t,e);throw rl("Field path arguments must be of type string or ",t,!1,void 0,n)}var yw=new RegExp("[~\\*/\\[\\]]");function ld(t,e,n){if(e.search(yw)>=0)throw rl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new is(...e.split("."))._internalPath}catch{throw rl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function rl(t,e,n,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new ke(Ge,a+t+l)}function Ym(t,e){return t.some(n=>n.isEqual(e))}var sl=class{constructor(e,n,i,r,s){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Qu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(bw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},Qu=class extends sl{data(){return super.data()}};function bw(t,e){return typeof e=="string"?ld(t,e):e instanceof is?e._internalPath:e._delegate._internalPath}function ww(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}var ed=class extends class{convertValue(e,n="none"){switch(Fu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Lu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw _n()}}convertObject(e,n){let i={};return vo(e.fields,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertGeoPoint(e){return new _o(Qt(e.latitude),Qt(e.longitude))}convertArray(e,n){return(e.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(e,n){switch(n){case"previous":let i=Um(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp($u(e));default:return null}}convertTimestamp(e){let n=po(e);return new xt(n.seconds,n.nanos)}convertDocumentKey(e,n){let i=gt.fromString(e);Wt(Vm(i));let r=new Pi(i.get(1),i.get(3)),s=new en(i.popFirst(5));return r.isEqual(n)||td(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ri(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ot(this.firestore,null,n)}};function ol(t){let e=od((t=rd(t,Ot)).firestore),n=new ed(t.firestore);return pw(e,[t._key]).then(i=>{Wt(i.length===1);let r=i[0];return new sl(t.firestore,n,t._key,r.isFoundDocument()?r:null,t.converter)})}function Zm(t,e,n){let i=ww((t=rd(t,Ot)).converter,e,n),r=gw(Gm(t.firestore),"setDoc",t._key,i,t.converter!==null,n);return Wm(od(t.firestore),[r.toMutation(t._key,Ai.none())])}function al(t,e,n,...i){let r=Gm((t=rd(t,Ot)).firestore),s;return s=typeof(e=Oe(e))=="string"||e instanceof is?vw(r,"updateDoc",t._key,e,n,i):_w(r,"updateDoc",t._key,e),Wm(od(t.firestore),[s.toMutation(t._key,Ai.exists(!0))])}function Jm(...t){return new Zu("arrayUnion",t)}function Xm(...t){return new Ju("arrayRemove",t)}(function(t){os=t})(`${mi}_lite`),Xt(new Et("firestore/lite",(t,{options:e})=>{let n=t.getProvider("app").getImmediate(),i=new nl(n,new Au(t.getProvider("auth-internal")),new xu(t.getProvider("app-check-internal")));return e&&i._setSettings(e),i},"PUBLIC")),kt("firestore-lite","3.4.9",""),kt("firestore-lite","3.4.9","esm2017");var Of=Vs(Qm()),$y=Vs(eg()),Df=Vs(tg());var Sw="firebase",Ew="9.8.1";kt(Sw,Ew,"app");var lg=new Map,Cw={activated:!1,tokenObservers:[]},Tw={initialized:!1,enabled:!1};function At(t){return lg.get(t)||Cw}function gi(t,e){lg.set(t,e)}function hl(){return Tw}var cg="https://content-firebaseappcheck.googleapis.com/v1",Iw="exchangeRecaptchaV3Token";var kw="exchangeDebugToken",ng={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Aw=24*60*60*1e3;var md=class{constructor(e,n,i,r,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Bt,await Pw(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Bt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function Pw(t){return new Promise(e=>{setTimeout(e,t)})}var Rw={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},tn=new Cn("appCheck","AppCheck",Rw);function ig(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function ug(t){if(!At(t).activated)throw tn.create("use-before-activation",{appName:t.name})}function Nw(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{let e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function dg(t){let e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),i=Math.floor((e-n*3600*24)/3600),r=Math.floor((e-n*3600*24-i*3600)/60),s=e-n*3600*24-i*3600-r*60,o="";return n&&(o+=ll(n)+"d:"),i&&(o+=ll(i)+"h:"),o+=ll(r)+"m:"+ll(s)+"s",o}function ll(t){return t===0?"00":t>=10?t.toString():"0"+t}async function hg({url:t,body:e},n){let i={"Content-Type":"application/json"},r=n.getImmediate({optional:!0});if(r){let u=await r.getHeartbeatsHeader();u&&(i["X-Firebase-Client"]=u)}let s={method:"POST",body:JSON.stringify(e),headers:i},o;try{o=await fetch(t,s)}catch(u){throw tn.create("fetch-network-error",{originalErrorMessage:u.message})}if(o.status!==200)throw tn.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(u){throw tn.create("fetch-parse-error",{originalErrorMessage:u.message})}let l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw tn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});let c=Number(l[1])*1e3,h=Date.now();return{token:a.token,expireTimeMillis:h+c,issuedAtTimeMillis:h}}function xw(t,e){let{projectId:n,appId:i,apiKey:r}=t.options;return{url:`${cg}/projects/${n}/apps/${i}:${Iw}?key=${r}`,body:{recaptcha_v3_token:e}}}function Ow(t,e){let{projectId:n,appId:i,apiKey:r}=t.options;return{url:`${cg}/projects/${n}/apps/${i}:${kw}?key=${r}`,body:{debug_token:e}}}var Dw="firebase-app-check-database",Mw=1,yo="firebase-app-check-store",fg="debug-token",cl=null;function pg(){return cl||(cl=new Promise((t,e)=>{try{let n=indexedDB.open(Dw,Mw);n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{var r;e(tn.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},n.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(yo,{keyPath:"compositeKey"})}}}catch(n){e(tn.create("storage-open",{originalErrorMessage:n.message}))}}),cl)}function Lw(t){return gg(_g(t))}function $w(t,e){return mg(_g(t),e)}function Fw(t){return mg(fg,t)}function Uw(){return gg(fg)}async function mg(t,e){let i=(await pg()).transaction(yo,"readwrite"),s=i.objectStore(yo).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},i.onerror=l=>{var c;a(tn.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})}async function gg(t){let n=(await pg()).transaction(yo,"readonly"),r=n.objectStore(yo).get(t);return new Promise((s,o)=>{r.onsuccess=a=>{let l=a.target.result;s(l?l.value:void 0)},n.onerror=a=>{var l;o(tn.create("storage-get",{originalErrorMessage:(l=a.target.error)===null||l===void 0?void 0:l.message}))}})}function _g(t){return`${t.options.appId}-${t.name}`}var bo=new pn("@firebase/app-check");async function Bw(t){if(io()){let e;try{e=await Lw(t)}catch(n){bo.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function rg(t,e){return io()?$w(t,e).catch(n=>{bo.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function zw(){let t;try{t=await Uw()}catch{}if(t)return t;{let e=Nw();return Fw(e).catch(n=>bo.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}function vg(){return hl().enabled}async function yg(){let t=hl();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function Vw(){let t=om(),e=hl();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;let n=new Bt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(zw())}var Ww={error:"UNKNOWN_ERROR"};function Hw(t){return Kr.encodeString(JSON.stringify(t),!1)}async function ul(t,e=!1){let n=t.app;ug(n);let i=At(n),r=i.token,s;if(!r){let l=await i.cachedTokenPromise;l&&dl(l)&&(r=l)}if(!e&&r&&dl(r))return{token:r.token};let o=!1;if(vg()){i.exchangeTokenPromise||(i.exchangeTokenPromise=hg(Ow(n,await yg()),t.heartbeatServiceProvider).then(c=>(i.exchangeTokenPromise=void 0,c)),o=!0);let l=await i.exchangeTokenPromise;return await rg(n,l),gi(n,Object.assign(Object.assign({},i),{token:l})),{token:l.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(l=>(i.exchangeTokenPromise=void 0,l)),o=!0),r=await i.exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?bo.warn(l.message):bo.error(l),s=l}let a;return r?(a={token:r.token},gi(n,Object.assign(Object.assign({},i),{token:r})),await rg(n,r)):a=jw(s),o&&Sg(n,a),a}function bg(t,e,n,i){let{app:r}=t,s=At(r),o={next:n,error:i,type:e};if(gi(r,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]})),s.token&&dl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),sg(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>sg(t))}function wg(t,e){let n=At(t),i=n.tokenObservers.filter(r=>r.next!==e);i.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),gi(t,Object.assign(Object.assign({},n),{tokenObservers:i}))}function sg(t){let{app:e}=t,n=At(e),i=n.tokenRefresher;i||(i=Gw(t),gi(e,Object.assign(Object.assign({},n),{tokenRefresher:i}))),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function Gw(t){let{app:e}=t;return new md(async()=>{let n=At(e),i;if(n.token?i=await ul(t,!0):i=await ul(t),i.error)throw i.error},()=>!0,()=>{let n=At(e);if(n.token){let i=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,r=n.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},ng.RETRIAL_MIN_WAIT,ng.RETRIAL_MAX_WAIT)}function Sg(t,e){let n=At(t).tokenObservers;for(let i of n)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function dl(t){return t.expireTimeMillis-Date.now()>0}function jw(t){return{token:Hw(Ww),error:t}}var gd=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=At(this.app);for(let n of e)wg(this.app,n.next);return Promise.resolve()}};function qw(t,e){return new gd(t,e)}function Kw(t){return{getToken:e=>ul(t,e),addTokenListener:e=>bg(t,"INTERNAL",e),removeTokenListener:e=>wg(t.app,e)}}var Yw="@firebase/app-check",Zw="0.5.8";var Jw="https://www.google.com/recaptcha/api.js";function Xw(t,e){let n=At(t),i=new Bt;gi(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:i}}));let r=Qw(t),s=ig(!1);return s?og(t,e,s,r,i):nS(()=>{let o=ig(!1);if(!o)throw new Error("no recaptcha");og(t,e,o,r,i)}),i.promise}function og(t,e,n,i,r){n.ready(()=>{tS(t,e,n,i),r.resolve(n)})}function Qw(t){let e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function eS(t){ug(t);let n=await At(t).reCAPTCHAState.initialized.promise;return new Promise((i,r)=>{let s=At(t).reCAPTCHAState;n.ready(()=>{i(n.execute(s.widgetId,{action:"fire_app_check"}))})})}function tS(t,e,n,i){let r=n.render(i,{sitekey:e,size:"invisible"}),s=At(t);gi(t,Object.assign(Object.assign({},s),{reCAPTCHAState:Object.assign(Object.assign({},s.reCAPTCHAState),{widgetId:r})}))}function nS(t){let e=document.createElement("script");e.src=Jw,e.onload=t,document.head.appendChild(e)}var ls=class{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;rS(this._throttleData);let n=await eS(this._app).catch(r=>{throw tn.create("recaptcha-error")}),i;try{i=await hg(xw(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=iS(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),tn.create("throttled",{time:dg(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,i}initialize(e){this._app=e,this._heartbeatServiceProvider=Hn(e,"heartbeat"),Xw(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof ls?this._siteKey===e._siteKey:!1}};function iS(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+Aw,httpStatus:t};{let n=e?e.backoffCount:0,i=hm(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+i,httpStatus:t}}}function rS(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw tn.create("throttled",{time:dg(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}function Eg(t=ki(),e){t=Oe(t);let n=Hn(t,"app-check");if(hl().initialized||Vw(),vg()&&yg().then(r=>console.log(`App Check debug token: ${r}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){let r=n.getImmediate(),s=n.getOptions();if(s.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&s.provider.isEqual(e.provider))return r;throw tn.create("already-initialized",{appName:t.name})}let i=n.initialize({options:e});return sS(t,e.provider,e.isTokenAutoRefreshEnabled),At(t).isTokenAutoRefreshEnabled&&bg(i,"INTERNAL",()=>{}),i}function sS(t,e,n){let i=At(t),r=Object.assign(Object.assign({},i),{activated:!0});r.provider=e,r.cachedTokenPromise=Bw(t).then(s=>(s&&dl(s)&&(gi(t,Object.assign(Object.assign({},At(t)),{token:s})),Sg(t,{token:s.token})),s)),r.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,gi(t,r),r.provider.initialize(t)}async function Cg(t,e){let n=await ul(t,e);if(n.error)throw n.error;return{token:n.token}}var oS="app-check",ag="app-check-internal";function aS(){Xt(new Et(oS,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return qw(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(ag).initialize()})),Xt(new Et(ag,t=>{let e=t.getProvider("app-check").getImmediate();return Kw(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),kt(Yw,Zw)}aS();var qg=Vs(jg(),1),{__extends:hA,__assign:fA,__rest:gl,__decorate:pA,__param:mA,__metadata:gA,__awaiter:_A,__generator:vA,__exportStar:yA,__createBinding:bA,__values:wA,__read:SA,__spread:EA,__spreadArrays:CA,__spreadArray:TA,__await:IA,__asyncGenerator:kA,__asyncDelegator:AA,__asyncValues:PA,__makeTemplateObject:RA,__importStar:NA,__importDefault:xA,__classPrivateFieldGet:OA,__classPrivateFieldSet:DA,__classPrivateFieldIn:MA}=qg.default;function o_(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var a_=o_,l_=new Cn("auth","Firebase",o_());var Kg=new pn("@firebase/auth");function _l(t,...e){Kg.logLevel<=Le.ERROR&&Kg.error(`Auth (${mi}): ${t}`,...e)}function vn(t,...e){throw Od(t,...e)}function jn(t,...e){return Od(t,...e)}function lS(t,e,n){let i=Object.assign(Object.assign({},a_()),{[e]:n});return new Cn("auth","Firebase",i).create(e,{appName:t.name})}function Od(t,...e){if(typeof t!="string"){let n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return l_.create(t,...e)}function me(t,e,...n){if(!t)throw Od(e,...n)}function Gn(t){let e="INTERNAL ASSERTION FAILED: "+t;throw _l(e),new Error(e)}function wi(t,e){t||Gn(e)}var Yg=new Map;function _i(t){wi(t instanceof Function,"Expected a class definition");let e=Yg.get(t);return e?(wi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Yg.set(t,e),e)}function c_(t,e){let n=Hn(t,"auth");if(n.isInitialized()){let r=n.getImmediate(),s=n.getOptions();if(Yr(s,e??{}))return r;vn(r,"already-initialized")}return n.initialize({options:e})}function cS(t,e){let n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(_i);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function bd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function uS(){return Zg()==="http:"||Zg()==="https:"}function Zg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function dS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uS()||im()||"connection"in navigator)?navigator.onLine:!0}function hS(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var or=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,wi(n>e,"Short delay should be less than long delay!"),this.isMobile=no()||Ha()}get(){return dS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Dd(t,e){wi(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Sl=class{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var fS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};var pS=new or(3e4,6e4);function Dt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ht(t,e,n,i,r={}){return u_(t,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});let a=Ii(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),Sl.fetch()(d_(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function u_(t,e,n){t._canInitEmulator=!1;let i=Object.assign(Object.assign({},fS),e);try{let r=new wd(t),s=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw vl(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw vl(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw vl(t,"email-already-in-use",o);let h=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw lS(t,h,c);vn(t,h)}}catch(r){if(r instanceof fn)throw r;vn(t,"network-request-failed")}}async function hr(t,e,n,i,r={}){let s=await Ht(t,e,n,i,r);return"mfaPendingCredential"in s&&vn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function d_(t,e,n,i){let r=`${e}${n}?${i}`;return t.config.emulator?Dd(t.config,r):`${t.config.apiScheme}://${r}`}var wd=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(jn(this.auth,"network-request-failed")),pS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function vl(t,e,n){let i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);let r=jn(t,e,i);return r.customData._tokenResponse=n,r}async function mS(t,e){return Ht(t,"POST","/v1/accounts:delete",e)}async function gS(t,e){return Ht(t,"POST","/v1/accounts:lookup",e)}function wo(t){if(!!t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function h_(t,e=!1){let n=Oe(t),i=await n.getIdToken(e),r=Md(i);me(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:wo(vd(r.auth_time)),issuedAtTime:wo(vd(r.iat)),expirationTime:wo(vd(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function vd(t){return Number(t)*1e3}function Md(t){let[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return _l("JWT malformed, contained fewer than 3 sections"),null;try{let r=Va(n);return r?JSON.parse(r):(_l("Failed to decode base64 JWT payload"),null)}catch(r){return _l("Caught error parsing JWT payload as JSON",r),null}}function _S(t){let e=Md(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ar(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof fn&&vS(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function vS({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var Sd=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var El=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wo(this.lastLoginAt),this.creationTime=wo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Cl(t){var e;let n=t.auth,i=await t.getIdToken(),r=await ar(t,gS(n,{idToken:i}));me(r?.users.length,n,"internal-error");let s=r.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?bS(s.providerUserInfo):[],a=yS(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!a?.length,h=l?c:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new El(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,u)}async function f_(t){let e=Oe(t);await Cl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yS(t,e){return[...t.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function bS(t){return t.map(e=>{var{providerId:n}=e,i=gl(e,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function wS(t,e){let n=await u_(t,{},async()=>{let i=Ii({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=d_(t,r,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Sl.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}var lr=class{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_S(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return me(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){let{accessToken:i,refreshToken:r,expiresIn:s}=await wS(e,n);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){let{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new lr;return i&&(me(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(me(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(me(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new lr,this.toJSON())}_performRefresh(){return Gn("not implemented")}};function Oi(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var vi=class{constructor(e){var{uid:n,auth:i,stsTokenManager:r}=e,s=gl(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Sd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new El(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let n=await ar(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return h_(this,e)}reload(){return f_(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new vi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Cl(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){let e=await this.getIdToken();return await ar(this,mS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var i,r,s,o,a,l,c,h;let u=(i=n.displayName)!==null&&i!==void 0?i:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,_=(o=n.photoURL)!==null&&o!==void 0?o:void 0,g=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,v=(c=n.createdAt)!==null&&c!==void 0?c:void 0,w=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:x,isAnonymous:P,providerData:F,stsTokenManager:C}=n;me(S&&C,e,"internal-error");let B=lr.fromJSON(this.name,C);me(typeof S=="string",e,"internal-error"),Oi(u,e.name),Oi(d,e.name),me(typeof x=="boolean",e,"internal-error"),me(typeof P=="boolean",e,"internal-error"),Oi(p,e.name),Oi(_,e.name),Oi(g,e.name),Oi(y,e.name),Oi(v,e.name),Oi(w,e.name);let G=new vi({uid:S,auth:e,email:d,emailVerified:x,displayName:u,isAnonymous:P,photoURL:_,phoneNumber:p,tenantId:g,stsTokenManager:B,createdAt:v,lastLoginAt:w});return F&&Array.isArray(F)&&(G.providerData=F.map(T=>Object.assign({},T))),y&&(G._redirectEventId=y),G}static async _fromIdTokenResponse(e,n,i=!1){let r=new lr;r.updateFromServerResponse(n);let s=new vi({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Cl(s),s}};var Tl=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){let n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}};Tl.type="NONE";var Ed=Tl;function yl(t,e,n){return`firebase:${t}:${e}:${n}`}var Mi=class{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=yl(this.userKey,r.apiKey,s),this.fullPersistenceKey=yl("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);return e?vi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Mi(_i(Ed),e,i);let r=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c),s=r[0]||_i(Ed),o=yl(i,e.config.apiKey,e.name),a=null;for(let c of n)try{let h=await c._get(o);if(h){let u=vi._fromJSON(e,h);c!==s&&(a=u),s=c;break}}catch{}let l=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Mi(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Mi(s,e,i))}};function Jg(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(g_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(p_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(v_(e))return"Blackberry";if(y_(e))return"Webos";if(Ld(e))return"Safari";if((e.includes("chrome/")||m_(e))&&!e.includes("edge/"))return"Chrome";if(__(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function p_(t=St()){return/firefox\//i.test(t)}function Ld(t=St()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function m_(t=St()){return/crios\//i.test(t)}function g_(t=St()){return/iemobile/i.test(t)}function __(t=St()){return/android/i.test(t)}function v_(t=St()){return/blackberry/i.test(t)}function y_(t=St()){return/webos/i.test(t)}function Fl(t=St()){return/iphone|ipad|ipod/i.test(t)}function SS(t=St()){var e;return Fl(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function ES(){return rm()&&document.documentMode===10}function b_(t=St()){return Fl(t)||__(t)||y_(t)||v_(t)||/windows phone/i.test(t)||g_(t)}function CS(){try{return!!(window&&window!==window.top)}catch{return!1}}function w_(t,e=[]){let n;switch(t){case"Browser":n=Jg(St());break;case"Worker":n=`${Jg(St())}-${t}`;break;default:n=t}let i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${mi}/${i}`}var Cd=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let i=s=>new Promise((o,a)=>{try{let l=e(s);o(l)}catch(l){a(l)}});i.onAbort=n,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let n=[];try{for(let i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(let r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i.message})}}};var Td=class{constructor(e,n,i){this.app=e,this.heartbeatServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Il(this),this.idTokenSubscription=new Il(this),this.beforeStateQueue=new Cd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=l_,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=_i(n)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await Mi.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;let i=await this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Cl(e)}catch(n){if(n.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){let n=e?Oe(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_i(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Cn("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){let i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let n=e&&_i(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await Mi.create(this,[_i(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,r){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return me(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof n=="function"?e.addObserver(n,i,r):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=w_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return i&&(n["X-Firebase-Client"]=i),n}};function To(t){return Oe(t)}var Il=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=um(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var cr=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gn("not implemented")}_getIdTokenResponse(e){return Gn("not implemented")}_linkToIdToken(e,n){return Gn("not implemented")}_getReauthenticationResolver(e){return Gn("not implemented")}};async function S_(t,e){return Ht(t,"POST","/v1/accounts:resetPassword",Dt(t,e))}async function E_(t,e){return Ht(t,"POST","/v1/accounts:update",e)}async function TS(t,e){return Ht(t,"POST","/v1/accounts:update",Dt(t,e))}async function IS(t,e){return hr(t,"POST","/v1/accounts:signInWithPassword",Dt(t,e))}async function C_(t,e){return Ht(t,"POST","/v1/accounts:sendOobCode",Dt(t,e))}async function kS(t,e){return C_(t,e)}async function AS(t,e){return C_(t,e)}async function PS(t,e){return hr(t,"POST","/v1/accounts:signInWithEmailLink",Dt(t,e))}async function RS(t,e){return hr(t,"POST","/v1/accounts:signInWithEmailLink",Dt(t,e))}var Li=class extends cr{constructor(e,n,i,r=null){super("password",i),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new Li(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Li(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return IS(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return PS(e,{email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return E_(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return RS(e,{idToken:n,email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function us(t,e){return hr(t,"POST","/v1/accounts:signInWithIdp",Dt(t,e))}var NS="http://localhost",Kn=class extends cr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let n=new Kn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):vn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=n,s=gl(n,["providerId","signInMethod"]);if(!i||!r)return null;let o=new Kn(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let n=this.buildRequest();return us(e,n)}_linkToIdToken(e,n){let i=this.buildRequest();return i.idToken=n,us(e,i)}_getReauthenticationResolver(e){let n=this.buildRequest();return n.autoCreate=!1,us(e,n)}buildRequest(){let e={requestUri:NS,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ii(n)}return e}};async function xS(t,e){return Ht(t,"POST","/v1/accounts:sendVerificationCode",Dt(t,e))}async function OS(t,e){return hr(t,"POST","/v1/accounts:signInWithPhoneNumber",Dt(t,e))}async function DS(t,e){let n=await hr(t,"POST","/v1/accounts:signInWithPhoneNumber",Dt(t,e));if(n.temporaryProof)throw vl(t,"account-exists-with-different-credential",n);return n}var MS={USER_NOT_FOUND:"user-not-found"};async function LS(t,e){let n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return hr(t,"POST","/v1/accounts:signInWithPhoneNumber",Dt(t,n),MS)}var yi=class extends cr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new yi({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new yi({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return OS(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return DS(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return LS(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:n,verificationId:i,verificationCode:r}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:i,code:r}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:n,verificationCode:i,phoneNumber:r,temporaryProof:s}=e;return!i&&!n&&!r&&!s?null:new yi({verificationId:n,verificationCode:i,phoneNumber:r,temporaryProof:s})}};function $S(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FS(t){let e=Zr(Jr(t)).link,n=e?Zr(Jr(e)).deep_link_id:null,i=Zr(Jr(t)).deep_link_id;return(i?Zr(Jr(i)).link:null)||i||n||e||t}var ds=class{constructor(e){var n,i,r,s,o,a;let l=Zr(Jr(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,h=(i=l.oobCode)!==null&&i!==void 0?i:null,u=$S((r=l.mode)!==null&&r!==void 0?r:null);me(c&&h&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=h,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let n=FS(e);try{return new ds(n)}catch{return null}}};var nn=class{constructor(){this.providerId=nn.PROVIDER_ID}static credential(e,n){return Li._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){let i=ds.parseLink(n);return me(i,"argument-error"),Li._fromEmailAndCode(e,i.code,i.tenantId)}};nn.PROVIDER_ID="password";nn.EMAIL_PASSWORD_SIGN_IN_METHOD="password";nn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var kl=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ur=class extends kl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var An=class extends ur{constructor(){super("facebook.com")}static credential(e){return Kn._fromParams({providerId:An.PROVIDER_ID,signInMethod:An.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return An.credentialFromTaggedObject(e)}static credentialFromError(e){return An.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return An.credential(e.oauthAccessToken)}catch{return null}}};An.FACEBOOK_SIGN_IN_METHOD="facebook.com";An.PROVIDER_ID="facebook.com";var Pn=class extends ur{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Kn._fromParams({providerId:Pn.PROVIDER_ID,signInMethod:Pn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Pn.credentialFromTaggedObject(e)}static credentialFromError(e){return Pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Pn.credential(n,i)}catch{return null}}};Pn.GOOGLE_SIGN_IN_METHOD="google.com";Pn.PROVIDER_ID="google.com";var Rn=class extends ur{constructor(){super("github.com")}static credential(e){return Kn._fromParams({providerId:Rn.PROVIDER_ID,signInMethod:Rn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rn.credentialFromTaggedObject(e)}static credentialFromError(e){return Rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rn.credential(e.oauthAccessToken)}catch{return null}}};Rn.GITHUB_SIGN_IN_METHOD="github.com";Rn.PROVIDER_ID="github.com";var Nn=class extends ur{constructor(){super("twitter.com")}static credential(e,n){return Kn._fromParams({providerId:Nn.PROVIDER_ID,signInMethod:Nn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Nn.credentialFromTaggedObject(e)}static credentialFromError(e){return Nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Nn.credential(n,i)}catch{return null}}};Nn.TWITTER_SIGN_IN_METHOD="twitter.com";Nn.PROVIDER_ID="twitter.com";var $i=class{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,r=!1){let s=await vi._fromIdTokenResponse(e,i,r),o=Xg(i);return new $i({user:s,providerId:o,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);let r=Xg(i);return new $i({user:e,providerId:r,_tokenResponse:i,operationType:n})}};function Xg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}var hs=class extends fn{constructor(e,n,i,r){var s;super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,hs.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,r){return new hs(e,n,i,r)}};function T_(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?hs._fromErrorAndOperation(t,s,e,i):s})}async function US(t,e,n=!1){let i=await ar(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return $i._forOperation(t,"link",i)}async function I_(t,e,n=!1){let{auth:i}=t,r="reauthenticate";try{let s=await ar(t,T_(i,r,e,t),n);me(s.idToken,i,"internal-error");let o=Md(s.idToken);me(o,i,"internal-error");let{sub:a}=o;return me(t.uid===a,i,"user-mismatch"),$i._forOperation(t,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&vn(i,"user-mismatch"),s}}async function k_(t,e,n=!1){let i="signIn",r=await T_(t,i,e),s=await $i._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}async function A_(t,e){return k_(To(t),e)}async function Io(t,e){return I_(Oe(t),e)}var Al=class{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?So._fromServerResponse(e,n):vn(e,"internal-error")}},So=class extends Al{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new So(n)}};function P_(t,e,n){var i;me(((i=n.url)===null||i===void 0?void 0:i.length)>0,t,"invalid-continue-uri"),me(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(me(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(me(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function $d(t,e,n){let i=Oe(t),r={requestType:"PASSWORD_RESET",email:e};n&&P_(i,r,n),await kS(i,r)}async function Fd(t,e,n){await S_(Oe(t),{oobCode:e,newPassword:n})}async function Ul(t,e){await TS(Oe(t),{oobCode:e})}async function Bl(t,e){let n=Oe(t),i=await S_(n,{oobCode:e}),r=i.requestType;switch(me(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":me(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":me(i.mfaInfo,n,"internal-error");default:me(i.email,n,"internal-error")}let s=null;return i.mfaInfo&&(s=Al._fromServerResponse(To(n),i.mfaInfo)),{data:{email:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.newEmail:i.email)||null,previousEmail:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.email:i.newEmail)||null,multiFactorInfo:s},operation:r}}async function Ud(t,e){let{data:n}=await Bl(Oe(t),e);return n.email}function Bd(t,e,n){return A_(Oe(t),nn.credential(e,n))}async function zd(t,e,n){let i=Oe(t),r=await t.getIdToken(),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:r,newEmail:e};n&&P_(i.auth,s,n);let{email:o}=await AS(i.auth,s);o!==t.email&&await t.reload()}async function BS(t,e){return Ht(t,"POST","/v1/accounts:update",e)}async function Vd(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;let i=Oe(t),s={idToken:await i.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await ar(i,BS(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;let a=i.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function Wd(t,e){return zS(Oe(t),null,e)}async function zS(t,e,n){let{auth:i}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);let o=await ar(t,E_(i,s));await t._updateTokensIfNecessary(o,!0)}function Hd(t,e,n,i){return Oe(t).onAuthStateChanged(e,n,i)}async function Gd(t){return Oe(t).delete()}function VS(t,e){return Ht(t,"POST","/v2/accounts/mfaEnrollment:start",Dt(t,e))}function WS(t,e){return Ht(t,"POST","/v2/accounts/mfaEnrollment:finalize",Dt(t,e))}var Pl="__sak";var Rl=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Pl,"1"),this.storage.removeItem(Pl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){let n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function HS(){let t=St();return Ld(t)||Fl(t)}var GS=1e3,jS=10,Nl=class extends Rl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=HS()&&CS(),this.fallbackToPolling=b_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let n of Object.keys(this.listeners)){let i=this.storage.getItem(n),r=this.localCache[n];i!==r&&e(n,r,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}let i=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let o=this.storage.getItem(i);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(i,e.newValue):this.storage.removeItem(i);else if(this.localCache[i]===e.newValue&&!n)return}let r=()=>{let o=this.storage.getItem(i);!n&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);ES()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,jS):r()}notifyListeners(e,n){this.localCache[e]=n;let i=this.listeners[e];if(i)for(let r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},GS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){let n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}};Nl.type="LOCAL";var R_=Nl;var xl=class extends Rl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}};xl.type="SESSION";var jd=xl;function qS(t){return Promise.all(t.map(async e=>{try{let n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}var fs=class{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;let i=new fs(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let n=e,{eventId:i,eventType:r,data:s}=n.data,o=this.handlersMap[r];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});let a=Array.from(o).map(async c=>c(n.origin,s)),l=await qS(a);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};fs.receivers=[];function qd(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}var Id=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{let c=qd("",20);r.port1.start();let h=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(u){let d=u;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(h),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function qn(){return window}function KS(t){qn().location.href=t}function N_(){return typeof qn().WorkerGlobalScope<"u"&&typeof qn().importScripts=="function"}async function YS(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZS(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function JS(){return N_()?self:null}var x_="firebaseLocalStorageDb",XS=1,Ol="firebaseLocalStorage",O_="fbase_key",dr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function zl(t,e){return t.transaction([Ol],e?"readwrite":"readonly").objectStore(Ol)}function QS(){let t=indexedDB.deleteDatabase(x_);return new dr(t).toPromise()}function kd(){let t=indexedDB.open(x_,XS);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{let i=t.result;try{i.createObjectStore(Ol,{keyPath:O_})}catch(r){n(r)}}),t.addEventListener("success",async()=>{let i=t.result;i.objectStoreNames.contains(Ol)?e(i):(i.close(),await QS(),e(await kd()))})})}async function Qg(t,e,n){let i=zl(t,!0).put({[O_]:e,value:n});return new dr(i).toPromise()}async function eE(t,e){let n=zl(t,!1).get(e),i=await new dr(n).toPromise();return i===void 0?null:i.value}function e_(t,e){let n=zl(t,!0).delete(e);return new dr(n).toPromise()}var tE=800,nE=3,Dl=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kd(),this.db)}async _withRetries(e){let n=0;for(;;)try{let i=await this._openDb();return await e(i)}catch(i){if(n++>nE)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return N_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fs._getInstance(JS()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await YS(),!this.activeServiceWorker)return;this.sender=new Id(this.activeServiceWorker);let i=await this.sender._send("ping",{},800);!i||((e=i[0])===null||e===void 0?void 0:e.fulfilled)&&((n=i[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZS()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await kd();return await Qg(e,Pl,"1"),await e_(e,Pl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>Qg(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){let n=await this._withRetries(i=>eE(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>e_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(r=>{let s=zl(r,!1).getAll();return new dr(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];let n=[],i=new Set;for(let{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),n.push(r));for(let r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;let i=this.listeners[e];if(i)for(let r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};Dl.type="LOCAL";var D_=Dl;function iE(t,e){return Ht(t,"POST","/v2/accounts/mfaSignIn:start",Dt(t,e))}function rE(t,e){return Ht(t,"POST","/v2/accounts/mfaSignIn:finalize",Dt(t,e))}function sE(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function oE(t){return new Promise((e,n)=>{let i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=r=>{let s=jn("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",sE().appendChild(i)})}function M_(t){return`__${t}${Math.floor(Math.random()*1e6)}`}var WA=M_("rcb"),HA=new or(3e4,6e4);var aE="recaptcha";async function lE(t,e,n){var i;let r=await n.verify();try{me(typeof r=="string",t,"argument-error"),me(n.type===aE,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return me(o.type==="enroll",t,"internal-error"),(await VS(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{me(o.type==="signin",t,"internal-error");let a=((i=s.multiFactorHint)===null||i===void 0?void 0:i.uid)||s.multiFactorUid;return me(a,t,"missing-multi-factor-info"),(await iE(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=await xS(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return o}}finally{n._reset()}}var bi=class{constructor(e){this.providerId=bi.PROVIDER_ID,this.auth=To(e)}verifyPhoneNumber(e,n){return lE(this.auth,e,Oe(n))}static credential(e,n){return yi._fromVerification(e,n)}static credentialFromResult(e){let n=e;return bi.credentialFromTaggedObject(n)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:n,temporaryProof:i}=e;return n&&i?yi._fromTokenResponse(n,i):null}};bi.PROVIDER_ID="phone";bi.PHONE_SIGN_IN_METHOD="phone";function cE(t,e){return e?_i(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var Eo=class extends cr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return us(e,this._buildIdpRequest())}_linkToIdToken(e,n){return us(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return us(e,this._buildIdpRequest())}_buildIdpRequest(e){let n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function uE(t){return k_(t.auth,new Eo(t),t.bypassAuthState)}function dE(t){let{auth:e,user:n}=t;return me(n,e,"internal-error"),I_(n,new Eo(t),t.bypassAuthState)}async function hE(t){let{auth:e,user:n}=t;return me(n,e,"internal-error"),US(n,new Eo(t),t.bypassAuthState)}var Ml=class{constructor(e,n,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){let{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let l={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uE;case"linkViaPopup":case"linkViaRedirect":return hE;case"reauthViaPopup":case"reauthViaRedirect":return dE;default:vn(this.auth,"internal-error")}}resolve(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var fE=new or(2e3,1e4);var Di=class extends Ml{constructor(e,n,i,r,s){super(e,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Di.currentPopupAction&&Di.currentPopupAction.cancel(),Di.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){wi(this.filter.length===1,"Popup operations only handle one event");let e=qd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(jn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(jn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Di.currentPopupAction=null}pollUserCancellation(){let e=()=>{var n,i;if(!((i=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(jn(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,fE.get())};e()}};Di.currentPopupAction=null;var pE="pendingRedirect",bl=new Map,Ad=class extends Ml{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=bl.get(this.auth._key());if(!e){try{let i=await mE(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}bl.set(this.auth._key(),e)}return this.bypassAuthState||bl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function mE(t,e){let n=vE(e),i=_E(t);if(!await i._isAvailable())return!1;let r=await i._get(n)==="true";return await i._remove(n),r}function gE(t,e){bl.set(t._key(),e)}function _E(t){return _i(t._redirectPersistence)}function vE(t){return yl(pE,t.config.apiKey,t.name)}async function yE(t,e,n=!1){let i=To(t),r=cE(i,e),o=await new Ad(i,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}var bE=10*60*1e3,Pd=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wE(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var i;if(e.error&&!L_(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";n.onError(jn(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){let i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=bE&&this.cachedEventUids.clear(),this.cachedEventUids.has(t_(e))}saveEventToCache(e){this.cachedEventUids.add(t_(e)),this.lastProcessedEventTime=Date.now()}};function t_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function L_({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function wE(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return L_(t);default:return!1}}async function SE(t,e={}){return Ht(t,"GET","/v1/projects",e)}var EE=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,CE=/^https?/;async function TE(t){if(t.config.emulator)return;let{authorizedDomains:e}=await SE(t);for(let n of e)try{if(IE(n))return}catch{}vn(t,"unauthorized-domain")}function IE(t){let e=bd(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){let o=new URL(t);return o.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!CE.test(n))return!1;if(EE.test(t))return i===t;let r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var kE=new or(3e4,6e4);function n_(){let t=qn().___jsl;if(t?.H){for(let e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function AE(t){return new Promise((e,n)=>{var i,r,s;function o(){n_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{n_(),n(jn(t,"network-request-failed"))},timeout:kE.get()})}if(!((r=(i=qn().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=qn().gapi)===null||s===void 0)&&s.load)o();else{let a=M_("iframefcb");return qn()[a]=()=>{gapi.load?o():n(jn(t,"network-request-failed"))},oE(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw wl=null,e})}var wl=null;function PE(t){return wl=wl||AE(t),wl}var RE=new or(5e3,15e3),NE="__/auth/iframe",xE="emulator/auth/iframe",OE={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},DE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ME(t){let e=t.config;me(e.authDomain,t,"auth-domain-config-required");let n=e.emulator?Dd(e,xE):`https://${t.config.authDomain}/${NE}`,i={apiKey:e.apiKey,appName:t.name,v:mi},r=DE.get(t.config.apiHost);r&&(i.eid=r);let s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${Ii(i).slice(1)}`}async function LE(t){let e=await PE(t),n=qn().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:ME(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:OE,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});let o=jn(t,"network-request-failed"),a=qn().setTimeout(()=>{s(o)},RE.get());function l(){qn().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}var $E={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FE=500,UE=600,BE="_blank",zE="http://localhost",Ll=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function VE(t,e,n,i=FE,r=UE){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",l=Object.assign(Object.assign({},$E),{width:i.toString(),height:r.toString(),top:s,left:o}),c=St().toLowerCase();n&&(a=m_(c)?BE:n),p_(c)&&(e=e||zE,l.scrollbars="yes");let h=Object.entries(l).reduce((d,[p,_])=>`${d}${p}=${_},`,"");if(SS(c)&&a!=="_self")return WE(e||"",a),new Ll(null);let u=window.open(e||"",a,h);me(u,t,"popup-blocked");try{u.focus()}catch{}return new Ll(u)}function WE(t,e){let n=document.createElement("a");n.href=t,n.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}var HE="__/auth/handler",GE="emulator/auth/handler";function i_(t,e,n,i,r,s){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");let o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:mi,eventId:r};if(e instanceof kl){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ro(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[l,c]of Object.entries(s||{}))o[l]=c}if(e instanceof ur){let l=e.getScopes().filter(c=>c!=="");l.length>0&&(o.scopes=l.join(","))}t.tenantId&&(o.tid=t.tenantId);let a=o;for(let l of Object.keys(a))a[l]===void 0&&delete a[l];return`${jE(t)}?${Ii(a).slice(1)}`}function jE({config:t}){return t.emulator?Dd(t,GE):`https://${t.authDomain}/${HE}`}var yd="webStorageSupport",Rd=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jd,this._completeRedirectFn=yE,this._overrideRedirectResult=gE}async _openPopup(e,n,i,r){var s;wi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=i_(e,n,i,bd(),r);return VE(e,o,qd())}async _openRedirect(e,n,i,r){return await this._originValidation(e),KS(i_(e,n,i,bd(),r)),new Promise(()=>{})}_initialize(e){let n=e._key();if(this.eventManagers[n]){let{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(wi(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){let n=await LE(e),i=new Pd(e);return n.register("authEvent",r=>(me(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(yd,{type:yd},r=>{var s;let o=(s=r?.[0])===null||s===void 0?void 0:s[yd];o!==void 0&&n(!!o),vn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=TE(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return b_()||Ld()||Fl()}},$_=Rd,Nd=class{constructor(e){this.factorId=e}_process(e,n,i){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,i);case"signin":return this._finalizeSignIn(e,n.credential);default:return Gn("unexpected MultiFactorSessionType")}}},Co=class extends Nd{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Co(e)}_finalizeEnroll(e,n,i){return WS(e,{idToken:n,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return rE(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},$l=class{constructor(){}static assertion(e){return Co._fromCredential(e)}};$l.FACTOR_ID="phone";var r_="@firebase/auth",s_="0.20.1";var xd=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(i=>{var r;e(((r=i)===null||r===void 0?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function qE(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function KE(t){Xt(new Et("auth",(e,{options:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:s,authDomain:o}=i.options;return((a,l)=>{me(s&&!s.includes(":"),"invalid-api-key",{appName:a.name}),me(!o?.includes(":"),"argument-error",{appName:a.name});let c={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:w_(t)},h=new Td(a,l,c);return cS(h,n),h})(i,r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Xt(new Et("auth-internal",e=>{let n=To(e.getProvider("auth").getImmediate());return(i=>new xd(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),kt(r_,s_,qE(t)),kt(r_,s_,"esm2017")}function fr(t=ki()){let e=Hn(t,"auth");return e.isInitialized()?e.getImmediate():c_(t,{popupRedirectResolver:$_,persistence:[D_,R_,jd]})}KE("Browser");var F_="@firebase/database",U_="0.13.0";var zh="";function YE(t){zh=t}var th=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ft(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:qr(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var nh=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Tn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var gv=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new th(e)}}catch{}return new nh},mr=gv("localStorage"),ih=gv("sessionStorage");var gs=new pn("@firebase/database"),ZE=function(){let t=1;return function(){return t++}}(),_v=function(t){let e=dm(t),n=new Wa;n.update(e);let i=n.digest();return Kr.encodeByteArray(i)},Yo=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Yo.apply(null,i):typeof i=="object"?e+=ft(i):e+=i,e+=" "}return e},gr=null,B_=!0,JE=function(t,e){oe(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(gs.logLevel=Le.VERBOSE,gr=gs.log.bind(gs),e&&ih.set("logging_enabled",!0)):typeof t=="function"?gr=t:(gr=null,ih.remove("logging_enabled"))},Ct=function(...t){if(B_===!0&&(B_=!1,gr===null&&ih.get("logging_enabled")===!0&&JE(!0)),gr){let e=Yo.apply(null,t);gr(e)}},Zo=function(t){return function(...e){Ct(t,...e)}},rh=function(...t){let e="FIREBASE INTERNAL ERROR: "+Yo(...t);gs.error(e)},_r=function(...t){let e=`FIREBASE FATAL ERROR: ${Yo(...t)}`;throw gs.error(e),new Error(e)},Mt=function(...t){let e="FIREBASE WARNING: "+Yo(...t);gs.warn(e)},XE=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Mt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Vh=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},QE=function(t){if(Vn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},vs="[MIN_NAME]",vr="[MAX_NAME]",Sr=function(t,e){if(t===e)return 0;if(t===vs||e===vr)return-1;if(e===vs||t===vr)return 1;{let n=z_(t),i=z_(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},eC=function(t,e){return t===e?0:t<e?-1:1},ko=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ft(e))},Wh=function(t){if(typeof t!="object"||t===null)return ft(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=ft(e[i]),n+=":",n+=Wh(t[e[i]]);return n+="}",n},vv=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function Lt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var yv=function(t){oe(!Vh(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,r,s,o,a,l;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));let c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let h=c.join(""),u="";for(l=0;l<64;l+=8){let d=parseInt(h.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),u=u+d}return u.toLowerCase()},tC=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},nC=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var iC=new RegExp("^-?(0*)\\d{1,10}$"),rC=-2147483648,sC=2147483647,z_=function(t){if(iC.test(t)){let e=Number(t);if(e>=rC&&e<=sC)return e}return null},Is=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Mt("Exception was thrown by user callback.",n),e},Math.floor(0))}},oC=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},No=function(t,e){let n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};var sh=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Mt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var oh=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Mt(e)}},Do=class{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}};Do.OWNER="owner";var Wl="5",bv="v",wv="s",Sv="r",Ev="f",Cv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Tv="ls",Iv="p",ah="ac",kv="websocket",Av="long_polling";var lh=class{constructor(e,n,i,r,s=!1,o="",a=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&mr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function aC(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Pv(t,e,n){oe(typeof e=="string","typeof type must == string"),oe(typeof n=="object","typeof params must == object");let i;if(e===kv)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Av)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);aC(t)&&(n.ns=t.namespace);let r=[];return Lt(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var ch=class{constructor(){this.counters_={}}incrementCounter(e,n=1){Tn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return tm(this.counters_)}};var Kd={},Yd={};function Hh(t){let e=t.toString();return Kd[e]||(Kd[e]=new ch),Kd[e]}function lC(t,e){let n=t.toString();return Yd[n]||(Yd[n]=e()),Yd[n]}var uh=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Is(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var V_="start",cC="close",uC="pLPCommand",dC="pRTLPCB",Rv="id",Nv="pw",xv="ser",hC="cb",fC="seg",pC="ts",mC="d",gC="dframe",Ov=1870,Dv=30,_C=Ov-Dv,vC=25e3,yC=3e4,Fi=class{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zo(e),this.stats_=Hh(n),this.urlFn=l=>(this.appCheckToken&&(l[ah]=this.appCheckToken),Pv(n,Av,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new uh(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(yC)),QE(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mo((...s)=>{let[o,a,l,c,h]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===V_)this.id=a,this.password=l;else if(o===cC)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[V_]="t",i[xv]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[hC]=this.scriptTagHolder.uniqueCallbackIdentifier),i[bv]=Wl,this.transportSessionId&&(i[wv]=this.transportSessionId),this.lastSessionId&&(i[Tv]=this.lastSessionId),this.applicationId&&(i[Iv]=this.applicationId),this.appCheckToken&&(i[ah]=this.appCheckToken),typeof location<"u"&&location.hostname&&Cv.test(location.hostname)&&(i[Sv]=Ev);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Fi.forceAllow_=!0}static forceDisallow(){Fi.forceDisallow_=!0}static isAvailable(){return Vn()?!1:Fi.forceAllow_?!0:!Fi.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!tC()&&!nC()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=ft(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=lu(n),r=vv(i,_C);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Vn())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[gC]="t",i[Rv]=e,i[Nv]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=ft(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Mo=class{constructor(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Vn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=ZE(),window[uC+this.uniqueCallbackIdentifier]=e,window[dC+this.uniqueCallbackIdentifier]=n,this.myIFrame=Mo.createIFrame_();let s="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){let a=document.domain;s='<script>document.domain="'+a+'";<\/script>'}let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Rv]=this.myID,e[Nv]=this.myPW,e[xv]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Dv+i.length<=Ov;){let o=this.pendingSegs.shift();i=i+"&"+fC+r+"="+o.seg+"&"+pC+r+"="+o.ts+"&"+mC+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(vC)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){Vn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var bC=16384,wC=45e3,Hl=null;typeof MozWebSocket<"u"?Hl=MozWebSocket:typeof WebSocket<"u"&&(Hl=WebSocket);var rn=class{constructor(e,n,i,r,s,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zo(this.connId),this.stats_=Hh(n),this.connURL=rn.connectionURL_(n,o,a,r,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,i,r,s){let o={};return o[bv]=Wl,!Vn()&&typeof location<"u"&&location.hostname&&Cv.test(location.hostname)&&(o[Sv]=Ev),n&&(o[wv]=n),i&&(o[Tv]=i),r&&(o[ah]=r),s&&(o[Iv]=s),Pv(e,kv,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mr.set("previous_websocket_failure",!0);try{let i;if(Vn()){let r=this.nodeAdmin?"AdminNode":"Node",s={headers:{"User-Agent":`Firebase/${Wl}/${zh}/${process.platform}/${r}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(s.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(s.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(s.proxy={origin:a})}this.mySock=new Hl(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){rn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){let n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Hl!==null&&!rn.forceDisallow_}static previouslyFailed(){return mr.isInMemoryStorage||mr.get("previous_websocket_failure")===!0}markConnectionHealthy(){mr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){let n=this.frames.join("");this.frames=null;let i=qr(n);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(oe(this.frames===null,"We already have a frame buffer"),e.length<=6){let n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;let n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{let i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();let n=ft(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=vv(n,bC);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(wC))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}};rn.responsesRequiredToBeHealthy=2;rn.healthyTimeout=3e4;var yr=class{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Fi,rn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){let n=rn&&rn.isAvailable(),i=n&&!rn.previouslyFailed();if(e.webSocketOnly&&(n||Mt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[rn];else{let r=this.transports_=[];for(let s of yr.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);yr.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}};yr.globalTransportInitialized_=!1;var SC=6e4,EC=5e3,CC=10*1024,TC=100*1024,Zd="t",W_="d",IC="s",H_="r",kC="e",G_="o",j_="a",q_="n",K_="p",AC="h",dh=class{constructor(e,n,i,r,s,o,a,l,c,h){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zo("c:"+this.id+":"),this.transportManager_=new yr(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=No(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>TC?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>CC?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Zd in e){let n=e[Zd];n===j_?this.upgradeIfSecondaryHealthy_():n===H_?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===G_&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=ko("t",e),i=ko("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:K_,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:j_,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:q_,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=ko("t",e),i=ko("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=ko(Zd,e);if(W_ in e){let i=e[W_];if(n===AC)this.onHandshake_(i);else if(n===q_){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===IC?this.onConnectionShutdown_(i):n===H_?this.onReset_(i):n===kC?rh("Server Error: "+i):n===G_?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rh("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Wl!==i&&Mt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),No(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(SC))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):No(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(EC))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:K_,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Gl=class{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var jl=class{constructor(e){this.allowedEvents_=e,this.listeners_={},oe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){oe(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var ys=class extends jl{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!no()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ys}getInitialEvent(e){return oe(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Y_=32,Z_=768,ze=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function We(){return new ze("")}function Ne(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function zi(t){return t.pieces_.length-t.pieceNum_}function Qe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ze(t.pieces_,e)}function Gh(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function PC(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Lo(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Mv(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ze(e,0)}function ot(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof ze)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new ze(n,0)}function De(t){return t.pieceNum_>=t.pieces_.length}function sn(t,e){let n=Ne(t),i=Ne(e);if(n===null)return e;if(n===i)return sn(Qe(t),Qe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function RC(t,e){let n=Lo(t,0),i=Lo(e,0);for(let r=0;r<n.length&&r<i.length;r++){let s=Sr(n[r],i[r]);if(s!==0)return s}return n.length===i.length?0:n.length<i.length?-1:1}function jh(t,e){if(zi(t)!==zi(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function yn(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(zi(t)>zi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var hh=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Lo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=ao(this.parts_[i]);Lv(this)}};function NC(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ao(e),Lv(t)}function xC(t){let e=t.parts_.pop();t.byteLength_-=ao(e),t.parts_.length>0&&(t.byteLength_-=1)}function Lv(t){if(t.byteLength_>Z_)throw new Error(t.errorPrefix_+"has a key path longer than "+Z_+" bytes ("+t.byteLength_+").");if(t.parts_.length>Y_)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Y_+") or object contains a cycle "+pr(t))}function pr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var $o=class extends jl{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new $o}getInitialEvent(e){return oe(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ao=1e3,OC=60*5*1e3,DC=3*1e3,J_=30*1e3,MC=1.3,LC=3e4,$C="server_kill",X_=3,On=class extends Gl{constructor(e,n,i,r,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=On.nextPersistentConnectionId_++,this.log_=Zo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ao,this.maxReconnectDelay_=OC,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Vn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$o.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ys.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,i){let r=++this.requestNumber_,s={r,a:e,b:n};this.log_(ft(s)),oe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();let n=new Bt,i={p:e._path.toString(),q:e._queryObject},r={action:"g",request:i,onComplete:o=>{let a=o.d;o.s==="ok"?(this.onDataUpdate_(i.p,a,!1,null),n.resolve(a)):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{let o=this.outstandingGets_[s];o===void 0||r!==o||(delete this.outstandingGets_[s],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),this.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))},DC),this.connected_&&this.sendGet_(s),n.promise}listen(e,n,i,r){this.initConnection_();let s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),oe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),oe(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");let a={onComplete:r,hashFn:n,query:e,tag:i};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){let n=this.outstandingGets_[e];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(e){let n=e.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);let s={p:i},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{let l=a.d,c=a.s;On.warnOnListenWarnings_(l,n),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,r),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Tn(e,"w")){let i=er(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();Mt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||cm(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=J_)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let e=this.authToken_,n=lm(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,r=>{let s=r.s,o=r.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{let n=e.s,i=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(e,n){let i=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),oe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,e._queryObject,n)}sendUnlisten_(e,n,i,r){this.log_("Unlisten on "+e+" for "+n);let s={p:e},o="n";r&&(s.q=i,s.t=r),this.sendRequest(o,s)}onDisconnectPut(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:i})}onDisconnectMerge(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:i})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,i,r){let s={p:n,d:i};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,i,r){this.putInternal("p",e,n,i,r)}merge(e,n,i,r){this.putInternal("m",e,n,i,r)}putInternal(e,n,i,r,s){this.initConnection_();let o={p:n,d:i};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;let a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){let n=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,i,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(e){if(this.connected_){let n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){let s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ft(e));let n=e.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):rh("Unrecognized action received from server: "+ft(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){oe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ao,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ao,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>LC&&(this.reconnectDelay_=Ao),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let e=new Date().getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*MC)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+On.nextConnectionId_++,s=this.lastSessionId,o=!1,a=null,l=function(){a?a.close():(o=!0,i())},c=function(u){oe(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(u)};this.realtime_={close:l,sendRequest:c};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[u,d]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=d&&d.token,a=new dh(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,i,p=>{Mt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt($C)},s))}catch(u){this.log_("Failed to get token: "+u),o||(this.repoInfo_.nodeAdmin&&Mt(u),l())}}}interrupt(e){Ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ro(this.interruptReasons_)&&(this.reconnectDelay_=Ao,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){let n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){let n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let i;n?i=n.map(s=>Wh(s)).join("$"):i="default";let r=this.removeListen_(e,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){let i=new ze(e).toString(),r;if(this.listens.has(i)){let s=this.listens.get(i);r=s.get(n),s.delete(n),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(e,n){Ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=X_&&(this.reconnectDelay_=J_,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=X_&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let e of this.listens.values())for(let n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){let e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){let e={},n="js";Vn()&&(this.repoInfo_.nodeAdmin?n="admin_node":n="node"),e["sdk."+n+"."+zh.replace(/\./g,"-")]=1,no()?e["framework.cordova"]=1:Ha()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){let e=ys.getInstance().currentlyOnline();return ro(this.interruptReasons_)&&e}};On.nextPersistentConnectionId_=0;On.nextConnectionId_=0;var Ce=class{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Ce(e,n)}};var bs=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new Ce(vs,e),r=new Ce(vs,n);return this.compare(i,r)!==0}minPost(){return Ce.MIN}};var Vl,ql=class extends bs{static get __EMPTY_NODE(){return Vl}static set __EMPTY_NODE(e){Vl=e}compare(e,n){return Sr(e.name,n.name)}isDefinedOn(e){throw Qi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ce.MIN}maxPost(){return new Ce(vr,Vl)}makePost(e,n){return oe(typeof e=="string","KeyIndex indexValue must always be a string."),new Ce(e,Vl)}toString(){return".key"}},_s=new ql;var ms=class{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},ut=class{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??ut.RED,this.left=r??Pt.EMPTY_NODE,this.right=s??Pt.EMPTY_NODE}copy(e,n,i,r,s){return new ut(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this,s=i(e,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Pt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let i,r;if(i=this,n(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(e,i.key)===0){if(i.right.isEmpty())return Pt.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){let e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){let e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){let e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};ut.RED=!0;ut.BLACK=!1;var fh=class{copy(e,n,i,r,s){return this}insert(e,n,i){return new ut(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Pt=class{constructor(e,n=Pt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Pt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ut.BLACK,null,null))}remove(e){return new Pt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ut.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ms(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ms(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ms(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ms(this.root_,null,this.comparator_,!0,e)}};Pt.EMPTY_NODE=new fh;function FC(t,e){return Sr(t.name,e.name)}function qh(t,e){return Sr(t,e)}var ph;function UC(t){ph=t}var $v=function(t){return typeof t=="number"?"number:"+yv(t):"string:"+t},Fv=function(t){if(t.isLeafNode()){let e=t.val();oe(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Tn(e,".sv"),"Priority must be a string or number.")}else oe(t===ph||t.isEmpty(),"priority of unexpected type.");oe(t===ph||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Q_,ct=class{constructor(e,n=ct.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,oe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Fv(this.priorityNode_)}static set __childrenNodeConstructor(e){Q_=e}static get __childrenNodeConstructor(){return Q_}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ct(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ct.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return De(e)?this:Ne(e)===".priority"?this.priorityNode_:ct.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:ct.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){let i=Ne(e);return i===null?n:n.isEmpty()&&i!==".priority"?this:(oe(i!==".priority"||zi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,ct.__childrenNodeConstructor.EMPTY_NODE.updateChild(Qe(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$v(this.priorityNode_.val())+":");let n=typeof this.value_;e+=n+":",n==="number"?e+=yv(this.value_):e+=this.value_,this.lazyHash_=_v(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ct.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ct.__childrenNodeConstructor?-1:(oe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){let n=typeof e.value_,i=typeof this.value_,r=ct.VALUE_TYPE_ORDER.indexOf(n),s=ct.VALUE_TYPE_ORDER.indexOf(i);return oe(r>=0,"Unknown leaf type: "+n),oe(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){let n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}};ct.VALUE_TYPE_ORDER=["object","boolean","number","string"];var Uv,Bv;function BC(t){Uv=t}function zC(t){Bv=t}var mh=class extends bs{compare(e,n){let i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?Sr(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ce.MIN}maxPost(){return new Ce(vr,new ct("[PRIORITY-POST]",Bv))}makePost(e,n){let i=Uv(e);return new Ce(n,new ct("[PRIORITY-POST]",i))}toString(){return".priority"}},at=new mh;var VC=Math.log(2),gh=class{constructor(e){let n=s=>parseInt(Math.log(s)/VC,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Kl=function(t,e,n,i){t.sort(e);let r=function(l,c){let h=c-l,u,d;if(h===0)return null;if(h===1)return u=t[l],d=n?n(u):u,new ut(d,u.node,ut.BLACK,null,null);{let p=parseInt(h/2,10)+l,_=r(l,p),g=r(p+1,c);return u=t[p],d=n?n(u):u,new ut(d,u.node,ut.BLACK,_,g)}},s=function(l){let c=null,h=null,u=t.length,d=function(_,g){let y=u-_,v=u;u-=_;let w=r(y+1,v),S=t[y],x=n?n(S):S;p(new ut(x,S.node,g,null,w))},p=function(_){c?(c.left=_,c=_):(h=_,c=_)};for(let _=0;_<l.count;++_){let g=l.nextBitIsOne(),y=Math.pow(2,l.count-(_+1));g?d(y,ut.BLACK):(d(y,ut.BLACK),d(y,ut.RED))}return h},o=new gh(t.length),a=s(o);return new Pt(i||e,a)};var Jd,ps={},xn=class{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return oe(ps&&at,"ChildrenNode.ts has not been loaded"),Jd=Jd||new xn({".priority":ps},{".priority":at}),Jd}get(e){let n=er(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Pt?n:null}hasIndex(e){return Tn(this.indexSet_,e.toString())}addIndex(e,n){oe(e!==_s,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=n.getIterator(Ce.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Kl(i,e.getCompare()):a=ps;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let h=Object.assign({},this.indexes_);return h[l]=a,new xn(h,c)}addToIndexes(e,n){let i=so(this.indexes_,(r,s)=>{let o=er(this.indexSet_,s);if(oe(o,"Missing index implementation for "+s),r===ps)if(o.isDefinedOn(e.node)){let a=[],l=n.getIterator(Ce.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Kl(a,o.getCompare())}else return ps;else{let a=n.get(e.name),l=r;return a&&(l=l.remove(new Ce(e.name,a))),l.insert(e,e.node)}});return new xn(i,this.indexSet_)}removeFromIndexes(e,n){let i=so(this.indexes_,r=>{if(r===ps)return r;{let s=n.get(e.name);return s?r.remove(new Ce(e.name,s)):r}});return new xn(i,this.indexSet_)}};var Po,we=class{constructor(e,n,i){this.children_=e,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Fv(this.priorityNode_),this.children_.isEmpty()&&oe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Po||(Po=new we(new Pt(qh),null,xn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Po}updatePriority(e){return this.children_.isEmpty()?this:new we(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{let n=this.children_.get(e);return n===null?Po:n}}getChild(e){let n=Ne(e);return n===null?this:this.getImmediateChild(n).getChild(Qe(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(oe(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{let i=new Ce(e,n),r,s;n.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(i,this.children_));let o=r.isEmpty()?Po:this.priorityNode_;return new we(r,o,s)}}updateChild(e,n){let i=Ne(e);if(i===null)return n;{oe(Ne(e)!==".priority"||zi(e)===1,".priority must be the last token in a path");let r=this.getImmediateChild(i).updateChild(Qe(e),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;let n={},i=0,r=0,s=!0;if(this.forEachChild(at,(o,a)=>{n[o]=a.val(e),i++,s&&we.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!e&&s&&r<2*i){let o=[];for(let a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+$v(this.getPriority().val())+":"),this.forEachChild(at,(n,i)=>{let r=i.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":_v(e)}return this.lazyHash_}getPredecessorChildName(e,n,i){let r=this.resolveIndex_(i);if(r){let s=r.getPredecessorKey(new Ce(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){let n=this.resolveIndex_(e);if(n){let i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){let n=this.getFirstChildName(e);return n?new Ce(n,this.children_.get(n)):null}getLastChildName(e){let n=this.resolveIndex_(e);if(n){let i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){let n=this.getLastChildName(e);return n?new Ce(n,this.children_.get(n)):null}forEachChild(e,n){let i=this.resolveIndex_(e);return i?i.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){let i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(e,r=>r);{let r=this.children_.getIteratorFrom(e.name,Ce.Wrap),s=r.peek();for(;s!=null&&n.compare(s,e)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){let i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(e,r=>r);{let r=this.children_.getReverseIteratorFrom(e.name,Ce.Wrap),s=r.peek();for(;s!=null&&n.compare(s,e)>0;)r.getNext(),s=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Jo?-1:0}withIndex(e){if(e===_s||this.indexMap_.hasIndex(e))return this;{let n=this.indexMap_.addIndex(e,this.children_);return new we(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===_s||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{let n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){let i=this.getIterator(at),r=n.getIterator(at),s=i.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=i.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===_s?null:this.indexMap_.get(e.toString())}};we.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var _h=class extends we{constructor(){super(new Pt(qh),we.EMPTY_NODE,xn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return we.EMPTY_NODE}isEmpty(){return!1}},Jo=new _h;Object.defineProperties(Ce,{MIN:{value:new Ce(vs,we.EMPTY_NODE)},MAX:{value:new Ce(vr,Jo)}});ql.__EMPTY_NODE=we.EMPTY_NODE;ct.__childrenNodeConstructor=we;UC(Jo);zC(Jo);var WC=!0;function pt(t,e=null){if(t===null)return we.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),oe(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new ct(n,pt(e))}if(!(t instanceof Array)&&WC){let n=[],i=!1;if(Lt(t,(o,a)=>{if(o.substring(0,1)!=="."){let l=pt(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new Ce(o,l)))}}),n.length===0)return we.EMPTY_NODE;let s=Kl(n,FC,o=>o.name,qh);if(i){let o=Kl(n,at.getCompare());return new we(s,pt(e),new xn({".priority":o},{".priority":at}))}else return new we(s,pt(e),xn.Default)}else{let n=we.EMPTY_NODE;return Lt(t,(i,r)=>{if(Tn(t,i)&&i.substring(0,1)!=="."){let s=pt(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(pt(e))}}BC(pt);var vh=class extends bs{constructor(e){super(),this.indexPath_=e,oe(!De(e)&&Ne(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?Sr(e.name,n.name):s}makePost(e,n){let i=pt(e),r=we.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ce(n,r)}maxPost(){let e=we.EMPTY_NODE.updateChild(this.indexPath_,Jo);return new Ce(vr,e)}toString(){return Lo(this.indexPath_,0).join("/")}};var yh=class extends bs{compare(e,n){let i=e.node.compareTo(n.node);return i===0?Sr(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ce.MIN}maxPost(){return Ce.MAX}makePost(e,n){let i=pt(e);return new Ce(n,i)}toString(){return".value"}},HC=new yh;var ev="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";var GC=function(){let t=0,e=[];return function(n){let i=n===t;t=n;let r,s=new Array(8);for(r=7;r>=0;r--)s[r]=ev.charAt(n%64),n=Math.floor(n/64);oe(n===0,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=ev.charAt(e[r]);return oe(o.length===20,"nextPushId: Length should be 20."),o}}();function jC(t){return{type:"value",snapshotNode:t}}function Fo(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Uo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Bo(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function qC(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var zo=class{constructor(e){this.index_=e}updateChild(e,n,i,r,s,o){oe(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Uo(n,a)):oe(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Fo(n,i)):o.trackChildChange(Bo(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(at,(r,s)=>{n.hasChild(r)||i.trackChildChange(Uo(r,s))}),n.isLeafNode()||n.forEachChild(at,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Bo(r,s,o))}else i.trackChildChange(Fo(r,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?we.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var br=class{constructor(e){this.indexedFilter_=new zo(e.getIndex()),this.index_=e.getIndex(),this.startPost_=br.getStartPost_(e),this.endPost_=br.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,i,r,s,o){return this.matches(new Ce(n,i))||(i=we.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,r,s,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=we.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(we.EMPTY_NODE);let s=this;return n.forEachChild(at,(o,a)=>{s.matches(new Ce(o,a))||(r=r.updateImmediateChild(o,we.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var bh=class{constructor(e){this.rangedFilter_=new br(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,i,r,s,o){return this.rangedFilter_.matches(new Ce(n,i))||(i=we.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,r,s,o):this.fullLimitUpdateChild_(e,n,i,s,o)}updateFullNode(e,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=we.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=we.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext(),l;if(this.reverse_?l=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:l=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,l)r=r.updateImmediateChild(a.name,a.node),o++;else break}}else{r=n.withIndex(this.index_),r=r.updatePriority(we.EMPTY_NODE);let s,o,a,l;if(this.reverse_){l=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();let u=this.index_.getCompare();a=(d,p)=>u(p,d)}else l=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let c=0,h=!1;for(;l.hasNext();){let u=l.getNext();!h&&a(s,u)<=0&&(h=!0),h&&c<this.limit_&&a(u,o)<=0?c++:r=r.updateImmediateChild(u.name,we.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,r,s){let o;if(this.reverse_){let u=this.index_.getCompare();o=(d,p)=>u(p,d)}else o=this.index_.getCompare();let a=e;oe(a.numChildren()===this.limit_,"");let l=new Ce(n,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(n)){let u=a.getImmediateChild(n),d=r.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);let p=d==null?1:o(d,l);if(h&&!i.isEmpty()&&p>=0)return s?.trackChildChange(Bo(n,i,u)),a.updateImmediateChild(n,i);{s?.trackChildChange(Uo(n,u));let g=a.updateImmediateChild(n,we.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s?.trackChildChange(Fo(d.name,d.node)),g.updateImmediateChild(d.name,d.node)):g}}else return i.isEmpty()?e:h&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Uo(c.name,c.node)),s.trackChildChange(Fo(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(c.name,we.EMPTY_NODE)):e}};var Vo=class{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=at}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return oe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return oe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:vs}hasEnd(){return this.endSet_}getIndexEndValue(){return oe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return oe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:vr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return oe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===at}copy(){let e=new Vo;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function KC(t){return t.loadsAllData()?new zo(t.getIndex()):t.hasLimit()?new bh(t):new br(t)}function tv(t){let e={};if(t.isDefault())return e;let n;return t.index_===at?n="$priority":t.index_===HC?n="$value":t.index_===_s?n="$key":(oe(t.index_ instanceof vh,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ft(n),t.startSet_&&(e.startAt=ft(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+ft(t.indexStartName_))),t.endSet_&&(e.endAt=ft(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+ft(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function nv(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==at&&(e.i=t.index_.toString()),e}var ws=class extends Gl{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Zo("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(oe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=ws.getListenId_(e,i),a={};this.listens_[o]=a;let l=tv(e._queryParams);this.restRequest_(s+".json",l,(c,h)=>{let u=h;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(s,u,!1,i),er(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",r(d,null)}})}unlisten(e,n){let i=ws.getListenId_(e,n);delete this.listens_[i]}get(e){let n=tv(e._queryParams),i=e._path.toString(),r=new Bt;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ii(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=qr(a.responseText)}catch{Mt("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&Mt("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var wh=class{constructor(){this.rootNode_=we.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Yl(){return{value:null,children:new Map}}function zv(t,e,n){if(De(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=Ne(e);t.children.has(i)||t.children.set(i,Yl());let r=t.children.get(i);e=Qe(e),zv(r,e,n)}}function Sh(t,e,n){t.value!==null?n(e,t.value):YC(t,(i,r)=>{let s=new ze(e.toString()+"/"+i);Sh(r,s,n)})}function YC(t,e){t.children.forEach((n,i)=>{e(i,n)})}var Eh=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Lt(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}};var iv=10*1e3,ZC=30*1e3,JC=5*60*1e3,Ch=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Eh(e);let i=iv+(ZC-iv)*Math.random();No(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;Lt(e,(r,s)=>{s>0&&Tn(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),No(this.reportStats_.bind(this),Math.floor(Math.random()*2*JC))}};var Yn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Yn||(Yn={}));function Kh(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Vv(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Wv(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Ss=class{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=Yn.ACK_USER_WRITE,this.source=Kh()}operationForChild(e){if(De(this.path)){if(this.affectedTree.value!=null)return oe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new ze(e));return new Ss(We(),n,this.revert)}}else return oe(Ne(this.path)===e,"operationForChild called for unrelated child."),new Ss(Qe(this.path),this.affectedTree,this.revert)}};var Si=class{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=Yn.OVERWRITE}operationForChild(e){return De(this.path)?new Si(this.source,We(),this.snap.getImmediateChild(e)):new Si(this.source,Qe(this.path),this.snap)}};var Vi=class{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=Yn.MERGE}operationForChild(e){if(De(this.path)){let n=this.children.subtree(new ze(e));return n.isEmpty()?null:n.value?new Si(this.source,We(),n.value):new Vi(this.source,We(),n)}else return oe(Ne(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Vi(this.source,Qe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Zn=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(De(e))return this.isFullyInitialized()&&!this.filtered_;let n=Ne(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Th=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function XC(t,e,n,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(qC(o.childName,o.snapshotNode))}),Ro(t,r,"child_removed",e,i,n),Ro(t,r,"child_added",e,i,n),Ro(t,r,"child_moved",s,i,n),Ro(t,r,"child_changed",e,i,n),Ro(t,r,"value",e,i,n),r}function Ro(t,e,n,i,r,s){let o=i.filter(a=>a.type===n);o.sort((a,l)=>eT(t,a,l)),o.forEach(a=>{let l=QC(t,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function QC(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function eT(t,e,n){if(e.childName==null||n.childName==null)throw Qi("Should only compare child_ events.");let i=new Ce(e.childName,e.snapshotNode),r=new Ce(n.childName,n.snapshotNode);return t.index_.compare(i,r)}function tc(t,e){return{eventCache:t,serverCache:e}}function xo(t,e,n,i){return tc(new Zn(e,n,i),t.serverCache)}function Hv(t,e,n,i){return tc(t.eventCache,new Zn(e,n,i))}function Zl(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function wr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Xd,tT=()=>(Xd||(Xd=new Pt(eC)),Xd),je=class{constructor(e,n=tT()){this.value=e,this.children=n}static fromObject(e){let n=new je(null);return Lt(e,(i,r)=>{n=n.set(new ze(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:We(),value:this.value};if(De(e))return null;{let i=Ne(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(Qe(e),n);return s!=null?{path:ot(new ze(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(De(e))return this;{let n=Ne(e),i=this.children.get(n);return i!==null?i.subtree(Qe(e)):new je(null)}}set(e,n){if(De(e))return new je(n,this.children);{let i=Ne(e),s=(this.children.get(i)||new je(null)).set(Qe(e),n),o=this.children.insert(i,s);return new je(this.value,o)}}remove(e){if(De(e))return this.children.isEmpty()?new je(null):new je(null,this.children);{let n=Ne(e),i=this.children.get(n);if(i){let r=i.remove(Qe(e)),s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new je(null):new je(this.value,s)}else return this}}get(e){if(De(e))return this.value;{let n=Ne(e),i=this.children.get(n);return i?i.get(Qe(e)):null}}setTree(e,n){if(De(e))return n;{let i=Ne(e),s=(this.children.get(i)||new je(null)).setTree(Qe(e),n),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new je(this.value,o)}}fold(e){return this.fold_(We(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(ot(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,We(),n)}findOnPath_(e,n,i){let r=this.value?i(n,this.value):!1;if(r)return r;if(De(e))return null;{let s=Ne(e),o=this.children.get(s);return o?o.findOnPath_(Qe(e),ot(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,We(),n)}foreachOnPath_(e,n,i){if(De(e))return this;{this.value&&i(n,this.value);let r=Ne(e),s=this.children.get(r);return s?s.foreachOnPath_(Qe(e),ot(n,r),i):new je(null)}}foreach(e){this.foreach_(We(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(ot(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var on=class{constructor(e){this.writeTree_=e}static empty(){return new on(new je(null))}};function Oo(t,e,n){if(De(e))return new on(new je(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=sn(r,e);return s=s.updateChild(o,n),new on(t.writeTree_.set(r,s))}else{let r=new je(n),s=t.writeTree_.setTree(e,r);return new on(s)}}}function Ih(t,e,n){let i=t;return Lt(n,(r,s)=>{i=Oo(i,ot(e,r),s)}),i}function rv(t,e){if(De(e))return on.empty();{let n=t.writeTree_.setTree(e,new je(null));return new on(n)}}function kh(t,e){return Er(t,e)!=null}function Er(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(sn(n.path,e)):null}function sv(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(at,(i,r)=>{e.push(new Ce(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new Ce(i,r.value))}),e}function Bi(t,e){if(De(e))return t;{let n=Er(t,e);return n!=null?new on(new je(n)):new on(t.writeTree_.subtree(e))}}function Ah(t){return t.writeTree_.isEmpty()}function Es(t,e){return Gv(We(),t.writeTree_,e)}function Gv(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(oe(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=Gv(ot(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(ot(t,".priority"),i)),n}}function Yh(t,e){return Yv(e,t)}function nT(t,e,n,i,r){oe(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Oo(t.visibleWrites,e,n)),t.lastWriteId=i}function iT(t,e,n,i){oe(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=Ih(t.visibleWrites,e,n),t.lastWriteId=i}function rT(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function sT(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);oe(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&oT(a,i.path)?r=!1:yn(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return aT(t),!0;if(i.snap)t.visibleWrites=rv(t.visibleWrites,i.path);else{let a=i.children;Lt(a,l=>{t.visibleWrites=rv(t.visibleWrites,ot(i.path,l))})}return!0}else return!1}function oT(t,e){if(t.snap)return yn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&yn(ot(t.path,n),e))return!0;return!1}function aT(t){t.visibleWrites=jv(t.allWrites,lT,We()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function lT(t){return t.visible}function jv(t,e,n){let i=on.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let o=s.path,a;if(s.snap)yn(n,o)?(a=sn(n,o),i=Oo(i,a,s.snap)):yn(o,n)&&(a=sn(o,n),i=Oo(i,We(),s.snap.getChild(a)));else if(s.children){if(yn(n,o))a=sn(n,o),i=Ih(i,a,s.children);else if(yn(o,n))if(a=sn(o,n),De(a))i=Ih(i,We(),s.children);else{let l=er(s.children,Ne(a));if(l){let c=l.getChild(Qe(a));i=Oo(i,We(),c)}}}else throw Qi("WriteRecord should have .snap or .children")}}return i}function qv(t,e,n,i,r){if(!i&&!r){let s=Er(t.visibleWrites,e);if(s!=null)return s;{let o=Bi(t.visibleWrites,e);if(Ah(o))return n;if(n==null&&!kh(o,We()))return null;{let a=n||we.EMPTY_NODE;return Es(o,a)}}}else{let s=Bi(t.visibleWrites,e);if(!r&&Ah(s))return n;if(!r&&n==null&&!kh(s,We()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(yn(c.path,e)||yn(e,c.path))},a=jv(t.allWrites,o,e),l=n||we.EMPTY_NODE;return Es(a,l)}}}function cT(t,e,n){let i=we.EMPTY_NODE,r=Er(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(at,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){let s=Bi(t.visibleWrites,e);return n.forEachChild(at,(o,a)=>{let l=Es(Bi(s,new ze(o)),a);i=i.updateImmediateChild(o,l)}),sv(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Bi(t.visibleWrites,e);return sv(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function uT(t,e,n,i,r){oe(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=ot(e,n);if(kh(t.visibleWrites,s))return null;{let o=Bi(t.visibleWrites,s);return Ah(o)?r.getChild(n):Es(o,r.getChild(n))}}function dT(t,e,n,i){let r=ot(e,n),s=Er(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){let o=Bi(t.visibleWrites,r);return Es(o,i.getNode().getImmediateChild(n))}else return null}function hT(t,e){return Er(t.visibleWrites,e)}function fT(t,e,n,i,r,s,o){let a,l=Bi(t.visibleWrites,e),c=Er(l,We());if(c!=null)a=c;else if(n!=null)a=Es(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let h=[],u=o.getCompare(),d=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),p=d.getNext();for(;p&&h.length<r;)u(p,i)!==0&&h.push(p),p=d.getNext();return h}else return[]}function pT(){return{visibleWrites:on.empty(),allWrites:[],lastWriteId:-1}}function Jl(t,e,n,i){return qv(t.writeTree,t.treePath,e,n,i)}function Zh(t,e){return cT(t.writeTree,t.treePath,e)}function ov(t,e,n,i){return uT(t.writeTree,t.treePath,e,n,i)}function Xl(t,e){return hT(t.writeTree,ot(t.treePath,e))}function mT(t,e,n,i,r,s){return fT(t.writeTree,t.treePath,e,n,i,r,s)}function Jh(t,e,n){return dT(t.writeTree,t.treePath,e,n)}function Kv(t,e){return Yv(ot(t.treePath,e),t.writeTree)}function Yv(t,e){return{treePath:t,writeTree:e}}var Ph=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;oe(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),oe(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,Bo(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Uo(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Fo(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,Bo(i,e.snapshotNode,r.oldSnap));else throw Qi("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var Rh=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},Zv=new Rh,Wo=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new Zn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Jh(this.writes_,e,i)}}getChildAfterChild(e,n,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:wr(this.viewCache_),s=mT(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}};function gT(t){return{filter:t}}function _T(t,e){oe(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),oe(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function vT(t,e,n,i,r){let s=new Ph,o,a;if(n.type===Yn.OVERWRITE){let c=n;c.source.fromUser?o=Nh(t,e,c.path,c.snap,i,r,s):(oe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!De(c.path),o=Ql(t,e,c.path,c.snap,i,r,a,s))}else if(n.type===Yn.MERGE){let c=n;c.source.fromUser?o=bT(t,e,c.path,c.children,i,r,s):(oe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=xh(t,e,c.path,c.children,i,r,a,s))}else if(n.type===Yn.ACK_USER_WRITE){let c=n;c.revert?o=ET(t,e,c.path,i,r,s):o=wT(t,e,c.path,c.affectedTree,i,r,s)}else if(n.type===Yn.LISTEN_COMPLETE)o=ST(t,e,n.path,i,s);else throw Qi("Unknown operation type: "+n.type);let l=s.getChanges();return yT(e,o,l),{viewCache:o,changes:l}}function yT(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Zl(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(jC(Zl(e)))}}function Jv(t,e,n,i,r,s){let o=e.eventCache;if(Xl(i,n)!=null)return e;{let a,l;if(De(n))if(oe(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=wr(e),h=c instanceof we?c:we.EMPTY_NODE,u=Zh(i,h);a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let c=Jl(i,wr(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=Ne(n);if(c===".priority"){oe(zi(n)===1,"Can't have a priority with additional path components");let h=o.getNode();l=e.serverCache.getNode();let u=ov(i,n,h,l);u!=null?a=t.filter.updatePriority(h,u):a=o.getNode()}else{let h=Qe(n),u;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let d=ov(i,n,o.getNode(),l);d!=null?u=o.getNode().getImmediateChild(c).updateChild(h,d):u=o.getNode().getImmediateChild(c)}else u=Jh(i,c,e.serverCache);u!=null?a=t.filter.updateChild(o.getNode(),c,u,h,r,s):a=o.getNode()}}return xo(e,a,o.isFullyInitialized()||De(n),t.filter.filtersNodes())}}function Ql(t,e,n,i,r,s,o,a){let l=e.serverCache,c,h=o?t.filter:t.filter.getIndexedFilter();if(De(n))c=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){let p=l.getNode().updateChild(n,i);c=h.updateFullNode(l.getNode(),p,null)}else{let p=Ne(n);if(!l.isCompleteForPath(n)&&zi(n)>1)return e;let _=Qe(n),y=l.getNode().getImmediateChild(p).updateChild(_,i);p===".priority"?c=h.updatePriority(l.getNode(),y):c=h.updateChild(l.getNode(),p,y,_,Zv,null)}let u=Hv(e,c,l.isFullyInitialized()||De(n),h.filtersNodes()),d=new Wo(r,u,s);return Jv(t,u,n,r,d,a)}function Nh(t,e,n,i,r,s,o){let a=e.eventCache,l,c,h=new Wo(r,e,s);if(De(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=xo(e,c,!0,t.filter.filtersNodes());else{let u=Ne(n);if(u===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),l=xo(e,c,a.isFullyInitialized(),a.isFiltered());else{let d=Qe(n),p=a.getNode().getImmediateChild(u),_;if(De(d))_=i;else{let g=h.getCompleteChild(u);g!=null?Gh(d)===".priority"&&g.getChild(Mv(d)).isEmpty()?_=g:_=g.updateChild(d,i):_=we.EMPTY_NODE}if(p.equals(_))l=e;else{let g=t.filter.updateChild(a.getNode(),u,_,d,h,o);l=xo(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function av(t,e){return t.eventCache.isCompleteForChild(e)}function bT(t,e,n,i,r,s,o){let a=e;return i.foreach((l,c)=>{let h=ot(n,l);av(e,Ne(h))&&(a=Nh(t,a,h,c,r,s,o))}),i.foreach((l,c)=>{let h=ot(n,l);av(e,Ne(h))||(a=Nh(t,a,h,c,r,s,o))}),a}function lv(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function xh(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;De(n)?c=i:c=new je(null).setTree(n,i);let h=e.serverCache.getNode();return c.children.inorderTraversal((u,d)=>{if(h.hasChild(u)){let p=e.serverCache.getNode().getImmediateChild(u),_=lv(t,p,d);l=Ql(t,l,new ze(u),_,r,s,o,a)}}),c.children.inorderTraversal((u,d)=>{let p=!e.serverCache.isCompleteForChild(u)&&d.value===void 0;if(!h.hasChild(u)&&!p){let _=e.serverCache.getNode().getImmediateChild(u),g=lv(t,_,d);l=Ql(t,l,new ze(u),g,r,s,o,a)}}),l}function wT(t,e,n,i,r,s,o){if(Xl(r,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(De(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Ql(t,e,n,l.getNode().getChild(n),r,s,a,o);if(De(n)){let c=new je(null);return l.getNode().forEachChild(_s,(h,u)=>{c=c.set(new ze(h),u)}),xh(t,e,n,c,r,s,a,o)}else return e}else{let c=new je(null);return i.foreach((h,u)=>{let d=ot(n,h);l.isCompleteForPath(d)&&(c=c.set(h,l.getNode().getChild(d)))}),xh(t,e,n,c,r,s,a,o)}}function ST(t,e,n,i,r){let s=e.serverCache,o=Hv(e,s.getNode(),s.isFullyInitialized()||De(n),s.isFiltered());return Jv(t,o,n,i,Zv,r)}function ET(t,e,n,i,r,s){let o;if(Xl(i,n)!=null)return e;{let a=new Wo(i,e,r),l=e.eventCache.getNode(),c;if(De(n)||Ne(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Jl(i,wr(e));else{let u=e.serverCache.getNode();oe(u instanceof we,"serverChildren would be complete if leaf node"),h=Zh(i,u)}h=h,c=t.filter.updateFullNode(l,h,s)}else{let h=Ne(n),u=Jh(i,h,e.serverCache);u==null&&e.serverCache.isCompleteForChild(h)&&(u=l.getImmediateChild(h)),u!=null?c=t.filter.updateChild(l,h,u,Qe(n),a,s):e.eventCache.getNode().hasChild(h)?c=t.filter.updateChild(l,h,we.EMPTY_NODE,Qe(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Jl(i,wr(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Xl(i,We())!=null,xo(e,c,o,t.filter.filtersNodes())}}var Oh=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new zo(i.getIndex()),s=KC(i);this.processor_=gT(s);let o=n.serverCache,a=n.eventCache,l=r.updateFullNode(we.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(we.EMPTY_NODE,a.getNode(),null),h=new Zn(l,o.isFullyInitialized(),r.filtersNodes()),u=new Zn(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=tc(u,h),this.eventGenerator_=new Th(this.query_)}get query(){return this.query_}};function CT(t){return Zl(t.viewCache_)}function TT(t,e){let n=wr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!De(e)&&!n.getImmediateChild(Ne(e)).isEmpty())?n.getChild(e):null}function cv(t,e,n,i){e.type===Yn.MERGE&&e.source.queryId!==null&&(oe(wr(t.viewCache_),"We should always have a full cache before handling merges"),oe(Zl(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=vT(t.processor_,r,e,n,i);return _T(t.processor_,s.viewCache),oe(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,IT(t,s.changes,s.viewCache.eventCache.getNode(),null)}function IT(t,e,n,i){let r=i?[i]:t.eventRegistrations_;return XC(t.eventGenerator_,e,n,r)}var uv,Dh=class{constructor(){this.views=new Map}};function kT(t){oe(!uv,"__referenceConstructor has already been defined"),uv=t}function Xh(t,e,n,i){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return oe(s!=null,"SyncTree gave us an op for an invalid query."),cv(s,e,n,i)}else{let s=[];for(let o of t.views.values())s=s.concat(cv(o,e,n,i));return s}}function AT(t,e,n,i,r){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Jl(n,r?i:null),l=!1;a?l=!0:i instanceof we?(a=Zh(n,i),l=!1):(a=we.EMPTY_NODE,l=!1);let c=tc(new Zn(a,l,!1),new Zn(i,r,!1));return new Oh(e,c)}return o}function Ho(t,e){let n=null;for(let i of t.views.values())n=n||TT(i,e);return n}var dv;function PT(t){oe(!dv,"__referenceConstructor has already been defined"),dv=t}var ec=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new je(null),this.pendingWriteTree_=pT(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Xv(t,e,n,i,r){return nT(t.pendingWriteTree_,e,n,i,r),r?Qo(t,new Si(Kh(),e,n)):[]}function RT(t,e,n,i){iT(t.pendingWriteTree_,e,n,i);let r=je.fromObject(n);return Qo(t,new Vi(Kh(),e,r))}function Ui(t,e,n=!1){let i=rT(t.pendingWriteTree_,e);if(sT(t.pendingWriteTree_,e)){let s=new je(null);return i.snap!=null?s=s.set(We(),!0):Lt(i.children,o=>{s=s.set(new ze(o),!0)}),Qo(t,new Ss(i.path,s,n))}else return[]}function Xo(t,e,n){return Qo(t,new Si(Vv(),e,n))}function NT(t,e,n){let i=je.fromObject(n);return Qo(t,new Vi(Vv(),e,i))}function xT(t,e,n,i){let r=ty(t,i);if(r!=null){let s=ny(r),o=s.path,a=s.queryId,l=sn(o,e),c=new Si(Wv(a),l,n);return iy(t,o,c)}else return[]}function OT(t,e,n,i){let r=ty(t,i);if(r){let s=ny(r),o=s.path,a=s.queryId,l=sn(o,e),c=je.fromObject(n),h=new Vi(Wv(a),l,c);return iy(t,o,h)}else return[]}function Qh(t,e,n){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let l=sn(o,e),c=Ho(a,l);if(c)return c});return qv(r,e,s,n,!0)}function DT(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(c,h)=>{let u=sn(c,n);i=i||Ho(h,u)});let r=t.syncPointTree_.get(n);r?i=i||Ho(r,We()):(r=new Dh,t.syncPointTree_=t.syncPointTree_.set(n,r));let s=i!=null,o=s?new Zn(i,!0,!1):null,a=Yh(t.pendingWriteTree_,e._path),l=AT(r,e,a,s?o.getNode():we.EMPTY_NODE,s);return CT(l)}function Qo(t,e){return Qv(e,t.syncPointTree_,null,Yh(t.pendingWriteTree_,We()))}function Qv(t,e,n,i){if(De(t.path))return ey(t,e,n,i);{let r=e.get(We());n==null&&r!=null&&(n=Ho(r,We()));let s=[],o=Ne(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){let c=n?n.getImmediateChild(o):null,h=Kv(i,o);s=s.concat(Qv(a,l,c,h))}return r&&(s=s.concat(Xh(r,t,i,n))),s}}function ey(t,e,n,i){let r=e.get(We());n==null&&r!=null&&(n=Ho(r,We()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=n?n.getImmediateChild(o):null,c=Kv(i,o),h=t.operationForChild(o);h&&(s=s.concat(ey(h,a,l,c)))}),r&&(s=s.concat(Xh(r,t,i,n))),s}function ty(t,e){return t.tagToQueryMap.get(e)}function ny(t){let e=t.indexOf("$");return oe(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ze(t.substr(0,e))}}function iy(t,e,n){let i=t.syncPointTree_.get(e);oe(i,"Missing sync point for query tag that we're tracking");let r=Yh(t.pendingWriteTree_,e);return Xh(i,n,r,null)}var Go=class{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new Go(n)}node(){return this.node_}},jo=class{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=ot(this.path_,e);return new jo(this.syncTree_,n)}node(){return Qh(this.syncTree_,this.path_)}},MT=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},hv=function(t,e,n){if(!t||typeof t!="object")return t;if(oe(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return LT(t[".sv"],e,n);if(typeof t[".sv"]=="object")return $T(t[".sv"],e);oe(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},LT=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:oe(!1,"Unexpected server value: "+t)}},$T=function(t,e,n){t.hasOwnProperty("increment")||oe(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&oe(!1,"Unexpected increment value: "+i);let r=e.node();if(oe(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},ry=function(t,e,n,i){return ef(e,new jo(n,t),i)},sy=function(t,e,n){return ef(t,new Go(e),n)};function ef(t,e,n){let i=t.getPriority().val(),r=hv(i,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=hv(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new ct(a,pt(r)):t}else{let o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new ct(r))),o.forEachChild(at,(a,l)=>{let c=ef(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var qo=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function tf(t,e){let n=e instanceof ze?e:new ze(e),i=t,r=Ne(n);for(;r!==null;){let s=er(i.node.children,r)||{children:{},childCount:0};i=new qo(r,i,s),n=Qe(n),r=Ne(n)}return i}function ks(t){return t.node.value}function oy(t,e){t.node.value=e,Mh(t)}function ay(t){return t.node.childCount>0}function FT(t){return ks(t)===void 0&&!ay(t)}function nc(t,e){Lt(t.node.children,(n,i)=>{e(new qo(n,t,i))})}function ly(t,e,n,i){n&&!i&&e(t),nc(t,r=>{ly(r,e,!0,i)}),n&&i&&e(t)}function UT(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function ea(t){return new ze(t.parent===null?t.name:ea(t.parent)+"/"+t.name)}function Mh(t){t.parent!==null&&BT(t.parent,t.name,t)}function BT(t,e,n){let i=FT(n),r=Tn(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,Mh(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,Mh(t))}var zT=/[\[\].#$\/\u0000-\u001F\u007F]/,VT=/[\[\].#$\u0000-\u001F\u007F]/,Qd=10*1024*1024,nf=function(t){return typeof t=="string"&&t.length!==0&&!zT.test(t)},cy=function(t){return typeof t=="string"&&t.length!==0&&!VT.test(t)},WT=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),cy(t)},HT=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Vh(t)||t&&typeof t=="object"&&Tn(t,".sv")},uy=function(t,e,n,i){i&&e===void 0||ic(oo(t,"value"),e,n)},ic=function(t,e,n){let i=n instanceof ze?new hh(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+pr(i));if(typeof e=="function")throw new Error(t+"contains a function "+pr(i)+" with contents = "+e.toString());if(Vh(e))throw new Error(t+"contains "+e.toString()+" "+pr(i));if(typeof e=="string"&&e.length>Qd/3&&ao(e)>Qd)throw new Error(t+"contains a string greater than "+Qd+" utf8 bytes "+pr(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Lt(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!nf(o)))throw new Error(t+" contains an invalid key ("+o+") "+pr(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);NC(i,o),ic(t,a,i),xC(i)}),r&&s)throw new Error(t+' contains ".value" child '+pr(i)+" in addition to actual children.")}},GT=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];let s=Lo(i);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!nf(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(RC);let r=null;for(n=0;n<e.length;n++){if(i=e[n],r!==null&&yn(r,i))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}},jT=function(t,e,n,i){if(i&&e===void 0)return;let r=oo(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");let s=[];Lt(e,(o,a)=>{let l=new ze(o);if(ic(r,a,ot(n,l)),Gh(l)===".priority"&&!HT(a))throw new Error(r+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),GT(r,s)};var dy=function(t,e,n,i){if(!(i&&n===void 0)&&!cy(n))throw new Error(oo(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},qT=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),dy(t,e,n,i)},rf=function(t,e){if(Ne(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},KT=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!nf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!WT(n))throw new Error(oo(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var Lh=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function rc(t,e){let n=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();n!==null&&!jh(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function YT(t,e,n){rc(t,n),hy(t,i=>jh(i,e))}function Dn(t,e,n){rc(t,n),hy(t,i=>yn(i,e)||yn(e,i))}function hy(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let r=t.eventLists_[i];if(r){let s=r.path;e(s)?(ZT(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function ZT(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();gr&&Ct("event: "+n.toString()),Is(i)}}}var JT="repo_interrupt",XT=25,$h=class{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Lh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Yl(),this.transactionQueueTree_=new qo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function QT(t,e,n){if(t.stats_=Hh(t.repoInfo_),t.forceRestClient_||oC())t.server_=new ws(t.repoInfo_,(i,r,s,o)=>{fv(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>pv(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ft(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new On(t.repoInfo_,e,(i,r,s,o)=>{fv(t,i,r,s,o)},i=>{pv(t,i)},i=>{eI(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=lC(t.repoInfo_,()=>new Ch(t.stats_,t.server_)),t.infoData_=new wh,t.infoSyncTree_=new ec({startListening:(i,r,s,o)=>{let a=[],l=t.infoData_.getNode(i._path);return l.isEmpty()||(a=Xo(t.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),sf(t,"connected",!1),t.serverSyncTree_=new ec({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);Dn(t.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function fy(t){let n=t.infoData_.getNode(new ze(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function sc(t){return MT({timestamp:fy(t)})}function fv(t,e,n,i,r){t.dataUpdateCount++;let s=new ze(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){let l=so(n,c=>pt(c));o=OT(t.serverSyncTree_,s,l,r)}else{let l=pt(n);o=xT(t.serverSyncTree_,s,l,r)}else if(i){let l=so(n,c=>pt(c));o=NT(t.serverSyncTree_,s,l)}else{let l=pt(n);o=Xo(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Cs(t,s)),Dn(t.eventQueue_,a,o)}function pv(t,e){sf(t,"connected",e),e===!1&&rI(t)}function eI(t,e){Lt(e,(n,i)=>{sf(t,n,i)})}function sf(t,e,n){let i=new ze("/.info/"+e),r=pt(n);t.infoData_.updateSnapshot(i,r);let s=Xo(t.infoSyncTree_,i,r);Dn(t.eventQueue_,i,s)}function of(t){return t.nextWriteId_++}function tI(t,e){let n=DT(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(i=>{let r=pt(i).withIndex(e._queryParams.getIndex()),s=Xo(t.serverSyncTree_,e._path,r);return YT(t.eventQueue_,e._path,s),Promise.resolve(r)},i=>(ta(t,"get for query "+ft(e)+" failed: "+i),Promise.reject(new Error(i))))}function nI(t,e,n,i,r){ta(t,"set",{path:e.toString(),value:n,priority:i});let s=sc(t),o=pt(n,i),a=Qh(t.serverSyncTree_,e),l=sy(o,a,s),c=of(t),h=Xv(t.serverSyncTree_,e,l,c,!0);rc(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(d,p)=>{let _=d==="ok";_||Mt("set at "+e+" failed: "+d);let g=Ui(t.serverSyncTree_,c,!_);Dn(t.eventQueue_,e,g),Fh(t,r,d,p)});let u=lf(t,e);Cs(t,u),Dn(t.eventQueue_,u,[])}function iI(t,e,n,i){ta(t,"update",{path:e.toString(),value:n});let r=!0,s=sc(t),o={};if(Lt(n,(a,l)=>{r=!1,o[a]=ry(ot(e,a),pt(l),t.serverSyncTree_,s)}),r)Ct("update() called with empty data.  Don't do anything."),Fh(t,i,"ok",void 0);else{let a=of(t),l=RT(t.serverSyncTree_,e,o,a);rc(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,h)=>{let u=c==="ok";u||Mt("update at "+e+" failed: "+c);let d=Ui(t.serverSyncTree_,a,!u),p=d.length>0?Cs(t,e):e;Dn(t.eventQueue_,p,d),Fh(t,i,c,h)}),Lt(n,c=>{let h=lf(t,ot(e,c));Cs(t,h)}),Dn(t.eventQueue_,e,[])}}function rI(t){ta(t,"onDisconnectEvents");let e=sc(t),n=Yl();Sh(t.onDisconnect_,We(),(r,s)=>{let o=ry(r,s,t.serverSyncTree_,e);zv(n,r,o)});let i=[];Sh(n,We(),(r,s)=>{i=i.concat(Xo(t.serverSyncTree_,r,s));let o=lf(t,r);Cs(t,o)}),t.onDisconnect_=Yl(),Dn(t.eventQueue_,We(),i)}function sI(t){t.persistentConnection_&&t.persistentConnection_.interrupt(JT)}function ta(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function Fh(t,e,n,i){e&&Is(()=>{if(n==="ok")e(null);else{let r=(n||"error").toUpperCase(),s=r;i&&(s+=": "+i);let o=new Error(s);o.code=r,e(o)}})}function py(t,e,n){return Qh(t.serverSyncTree_,e,n)||we.EMPTY_NODE}function af(t,e=t.transactionQueueTree_){if(e||oc(t,e),ks(e)){let n=gy(t,e);oe(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&oI(t,ea(e),n)}else ay(e)&&nc(e,n=>{af(t,n)})}function oI(t,e,n){let i=n.map(c=>c.currentWriteId),r=py(t,e,i),s=r,o=r.hash();for(let c=0;c<n.length;c++){let h=n[c];oe(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;let u=sn(e,h.path);s=s.updateChild(u,h.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{ta(t,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){let u=[];for(let d=0;d<n.length;d++)n[d].status=2,h=h.concat(Ui(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&u.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();oc(t,tf(t.transactionQueueTree_,e)),af(t,t.transactionQueueTree_),Dn(t.eventQueue_,e,h);for(let d=0;d<u.length;d++)Is(u[d])}else{if(c==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{Mt("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=c}Cs(t,e)}},o)}function Cs(t,e){let n=my(t,e),i=ea(n),r=gy(t,n);return aI(t,r,i),i}function aI(t,e,n){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=sn(n,l.path),h=!1,u;if(oe(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,u=l.abortReason,r=r.concat(Ui(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=XT)h=!0,u="maxretry",r=r.concat(Ui(t.serverSyncTree_,l.currentWriteId,!0));else{let d=py(t,l.path,o);l.currentInputSnapshot=d;let p=e[a].update(d.val());if(p!==void 0){ic("transaction failed: Data returned ",p,l.path);let _=pt(p);typeof p=="object"&&p!=null&&Tn(p,".priority")||(_=_.updatePriority(d.getPriority()));let y=l.currentWriteId,v=sc(t),w=sy(_,d,v);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=w,l.currentWriteId=of(t),o.splice(o.indexOf(y),1),r=r.concat(Xv(t.serverSyncTree_,l.path,w,l.currentWriteId,l.applyLocally)),r=r.concat(Ui(t.serverSyncTree_,y,!0))}else h=!0,u="nodata",r=r.concat(Ui(t.serverSyncTree_,l.currentWriteId,!0))}Dn(t.eventQueue_,n,r),r=[],h&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(u==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(u),!1,null))))}oc(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)Is(i[a]);af(t,t.transactionQueueTree_)}function my(t,e){let n,i=t.transactionQueueTree_;for(n=Ne(e);n!==null&&ks(i)===void 0;)i=tf(i,n),e=Qe(e),n=Ne(e);return i}function gy(t,e){let n=[];return _y(t,e,n),n.sort((i,r)=>i.order-r.order),n}function _y(t,e,n){let i=ks(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);nc(e,r=>{_y(t,r,n)})}function oc(t,e){let n=ks(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,oy(e,n.length>0?n:void 0)}nc(e,i=>{oc(t,i)})}function lf(t,e){let n=ea(my(t,e)),i=tf(t.transactionQueueTree_,e);return UT(i,r=>{eh(t,r)}),eh(t,i),ly(i,r=>{eh(t,r)}),n}function eh(t,e){let n=ks(e);if(n){let i=[],r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(oe(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(oe(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Ui(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?oy(e,void 0):n.length=s+1,Dn(t.eventQueue_,ea(e),r);for(let o=0;o<i.length;o++)Is(i[o])}}function lI(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function cI(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Mt(`Invalid query segment '${n}' in query '${t}'`)}return e}var mv=function(t,e){let n=uI(t),i=n.namespace;n.domain==="firebase.com"&&_r(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&_r("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||XE();let r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new lh(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new ze(n.pathString)}},uI=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let h=t.indexOf("/");h===-1&&(h=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(h,u)),h<u&&(r=lI(t.substring(h,u)));let d=cI(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let p=e.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{let _=e.indexOf(".");i=e.substring(0,_).toLowerCase(),n=e.substring(_+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var Ko=class{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return De(this._path)?null:Gh(this._path)}get ref(){return new Jn(this._repo,this._path)}get _queryIdentifier(){let e=nv(this._queryParams),n=Wh(e);return n==="{}"?"default":n}get _queryObject(){return nv(this._queryParams)}isEqual(e){if(e=Oe(e),!(e instanceof Ko))return!1;let n=this._repo===e._repo,i=jh(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+PC(this._path)}};var Jn=class extends Ko{constructor(e,n){super(e,n,new Vo,!1)}get parent(){let e=Mv(this._path);return e===null?null:new Jn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Ts=class{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new ze(e),i=Xn(this.ref,e);return new Ts(this._node.getChild(n),i,at)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new Ts(r,Xn(this.ref,i),at)))}hasChild(e){let n=new ze(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Wi(t,e){return t=Oe(t),t._checkNotDeleted("ref"),e!==void 0?Xn(t._root,e):t._root}function Xn(t,e){return t=Oe(t),Ne(t._path)===null?qT("child","path",e,!1):dy("child","path",e,!1),new Jn(t._repo,ot(t._path,e))}function vy(t,e){t=Oe(t),rf("push",t._path),uy("push",e,t._path,!0);let n=fy(t._repo),i=GC(n),r=Xn(t,i),s=Xn(t,i),o;return e!=null?o=ac(s,e).then(()=>s):o=Promise.resolve(s),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function yy(t){return rf("remove",t._path),ac(t,null)}function ac(t,e){t=Oe(t),rf("set",t._path),uy("set",e,t._path,!1);let n=new Bt;return nI(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function by(t,e){jT("update",e,t._path,!1);let n=new Bt;return iI(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function na(t){return t=Oe(t),tI(t._repo,t).then(e=>new Ts(e,new Jn(t._repo,t._path),t._queryParams.getIndex()))}kT(Jn);PT(Jn);var dI="FIREBASE_DATABASE_EMULATOR_HOST",Uh={},hI=!1;function fI(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||_r("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=mv(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[dI]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=mv(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let h=r&&l?new Do(Do.OWNER):new oh(t.name,t.options,e);KT("Invalid Firebase Database URL",o),De(o.path)||_r("Database URL must point to the root of a Firebase Database (not including a child path).");let u=mI(a,t,h,new sh(t.name,n));return new Bh(u,t)}function pI(t,e){let n=Uh[e];(!n||n[t.key]!==t)&&_r(`Database ${e}(${t.repoInfo_}) has already been deleted.`),sI(t),delete n[t.key]}function mI(t,e,n,i){let r=Uh[e.name];r||(r={},Uh[e.name]=r);let s=r[t.toURLString()];return s&&_r("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new $h(t,hI,n,i),r[t.toURLString()]=s,s}var Bh=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(QT(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Jn(this._repo,We())),this._rootInternal}_delete(){return this._rootInternal!==null&&(pI(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&_r("Cannot call "+e+" on a deleted database.")}};function Hi(t=ki(),e){return Hn(t,"database").getImmediate({identifier:e})}function gI(t){YE(mi),Xt(new Et("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return fI(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),kt(F_,U_,t),kt(F_,U_,"esm2017")}On.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};On.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};gI();var Fy=Vs(Sy());var Ey={apiKey:"AIzaSyC9WG81J_aH64UyoqtQwImbzVOtJGKrB1k",authDomain:"mapchart-8c8d5.firebaseapp.com",databaseURL:"https://mapchart-8c8d5-default-rtdb.firebaseio.com",projectId:"mapchart-8c8d5",storageBucket:"mapchart-8c8d5.appspot.com",messagingSenderId:"618321734432",appId:"1:618321734432:web:c3f1fb86f0b87c0de60545"},Cy="6LeY6m8fAAAAADnpxoTUqzDt-13s-EN36ZsX7l1i",uf="#firebaseui-auth-container",df=$(".u-logged-in"),hf=$(".u-not-logged-in"),As=$(".u-name"),lc=$("#u-name-form"),Gi=$("#change-u-name"),Ty=$(".u-created-at"),Iy=$(".u-license-key"),cc=$(".u-email"),uc=$("#u-email-form"),Cr=$("#change-u-email"),ff=$("#u-reenter-password-form"),pf=$("#u-current-pwd-form"),ia=$("#u-new-pwd-form"),ra=$("#u-confirm-pwd-form"),Tr=$("#change-u-password"),sa=$("#u-account-action-mode"),mf=$("#first-change-password-section"),gf=$("#verify-email-section"),_f=$("#recover-email-section"),Ir=$("#first-change-u-password"),vf=$("#verify-email-info"),yf=$("#recover-email-info"),ky=$("#u-delete-account-btn"),bf=$("#u-password-delete-form"),Ay=$("#u-save-config-btn"),oa=$("#u-save-config-form"),X1=$("#u-save-config-tooltip"),dc=$("#uSaveConfigModal"),kr=$("#u-show-save-config-modal"),hc=$("#u-show-save-config-tooltip"),Py=$("#u-show-save-as-config-modal"),wf=$("#u-show-save-as-config-tooltip"),Sf=$("#uLoadConfigModal"),Ry=$("#u-show-load-config-modal"),Ef=$("#u-show-load-config-tooltip"),Ny=$("#u-loaded-configs"),aa=$("#u-loaded-configs>tbody"),fc=$("#export-all-configs"),Cf=$("#u-premium-link"),Tf=$(".u-link"),If=$("#not-logged-in-msg"),la=$("#u-my-palette-list"),kf=$("#uRemovePaintModal"),Af=$("#u-remove-paint-btn"),xy=$("#u-paint-to-remove-span"),Oy=$('div[id*="div-gpt-ad"], .adsbygoogle, #shortcut-keeper'),Pf=$(".lbl"),Rf=$(".theme-switcher-item").slice(1),Nf=$(".map-theme-switcher-item").slice(3),xf=$(".map-theme-switcher-item.is-premium button, .theme-switcher-item.is-premium button "),Dy=$("#first-change-container"),My={"auth/wrong-password":"Wrong password. Please try again.","auth/expired-action-code":"Your verification code has expired. Please try again.","auth/invalid-action-code":"Your verification code has expired. Please try again.","auth/invalid-email":"Invalid e-mail. Please try again.","auth/requires-recent-login":"You need to sign in again to your account.","auth/email-already-in-use":"Error: there is already a user account with this e-mail."};Of.default.extend($y.default);var Je,Gt={},ca;async function Uy(){let t=Tm(Ey),e=Eg(t,{provider:new ls(Cy),isTokenAutoRefreshEnabled:!0}),n=fr(t);if(await vI(n),$("#account-btn").on("click",async function(){Ly()}),PAGE==="login"&&Ly(),PAGE==="my-maps"&&(II(),fc.on("click",function(){TI()})),PAGE==="welcome"){$(".loading-bars").show();let i=await yI(e);$("#user-email").html(i),$(".loading-bars").hide(),$("#resend-email").on("click",function(){bI(i)})}(PAGE==="account"||PAGE==="account-actions")&&PI(n),PAGE==="tutorial-premium"&&NI()}async function Ly(){await Sa("https://www.gstatic.com/firebasejs/9.5.0/firebase-app-compat.js"),await Sa("https://www.gstatic.com/firebasejs/9.5.0/firebase-auth-compat.js"),await Sa("https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.js"),await dp("https://www.gstatic.com/firebasejs/ui/6.0.0/firebase-ui-auth.css"),await _I()}async function _I(){let t={callbacks:{signInSuccessWithAuthResult:function(e,n){return!1},uiShown:function(){$("#auth-loader").hide(),$(".firebaseui-card-header").before($("<div class='beta-notice'><p>In beta access</p> <span>Available only for a limited number of users. Stay tuned!</span></div>"))}},signInFlow:"popup",signInOptions:[{provider:firebase.auth.EmailAuthProvider.PROVIDER_ID,disableSignUp:{status:!0}}],tosUrl:"https://mapchart.net/terms.html",privacyPolicyUrl:"https://mapchart.net/privacy-policy.html"};ca?(ca.reset(),ca.start(uf,t)):(ca=new firebaseui.auth.AuthUI(fr()),ca.start(uf,t))}async function vI(t){Hd(t,function(e){if(e){let n=e.displayName,i=e.email,r=e.metadata.creationTime?.substring(0,16);Oy.remove(),Pf.hide(),df.show(),hf.hide(),As.html(n??i),As.val(n??i),Ty.html(r),cc.html(i),cc.val(i),Iy.html(xI()),localStorage.setItem("u-uid",e.uid),Cf.hide(),Tf.addClass("u-link-enabled"),If.hide(),SI(),AI(),xf.attr("disabled",!1),Nf.removeClass("is-premium"),Rf.removeClass("is-premium");let s=Ji().config;s!==null&&wI(s),$(".tutorial-nav-premium").removeClass("hidden"),$(".tutorial-nav").addClass("hidden")}else Pf.show(),df.hide(),hf.show(),As.html(""),localStorage.removeItem("u-uid"),Cf.show(),localStorage.setItem("theme","default"),localStorage.setItem("mapTheme","default"),Tf.removeClass("u-link-enabled"),If.show(),Nf.addClass("is-premium"),Rf.addClass("is-premium"),xf.attr("disabled",!0),Je=void 0,$(".tutorial-nav").removeClass("hidden"),$(".tutorial-nav-premium").addClass("hidden")},function(e){console.log(e)}),$("#log-out").on("click",function(){t.signOut()}),oa.on({submit:e=>(e.preventDefault(),!1),keypress:e=>{if(e.key==="Enter"){let n=nt(),i=oa.val();Ps(n,i),dc.modal("hide")}}}),Ay.on("click",function(e){e.preventDefault();let n=nt(),i=oa.val();Ps(n,i)}),kr.on({click:async()=>{Object.keys(Gt).length!==0?EI():dc.modal("show")},mouseenter:()=>{if(Object.keys(Gt).length!==0){let e=(0,Of.default)(Gt.modifiedAt).fromNow();hc.html(`<strong>Editing:</strong> ${Ia(Gt.configName)} </br> <strong>Last saved:</strong> ${e}`).show()}else hc.html("Save map settings to My Maps").show()},mouseleave:function(){hc.hide()}}),Py.on({mouseenter:function(){wf.html("Save map settings as a new file").show()},mouseleave:function(){wf.hide()}}),dc.on("show.bs.modal",function(e){oa.val(Ta(PAGE,$("#map-title").val()))}),Ry.on({click:async function(){let e=an(),n=Wi(Hi());na(Xn(n,`configs/${e}/${PAGE}`)).then(i=>{i.exists()?By(i.val()):aa.find("td").html("<strong>\u26A0\uFE0F You have no saved configurations for this map page.</strong>"),$("#u-load-loading-bars").hide()}).catch(i=>{console.error(i)}),Sf.modal("show"),$("#u-load-loading-bars").show()},mouseenter:function(){Ef.html("Load map settings from My Maps").show()},mouseleave:function(){Ef.hide()}})}async function yI(t){let n=Ji().sale_id;if(n!=null){let i;try{return i=await Cg(t),(await(await fetch(`https://us-central1-mapchart-8c8d5.cloudfunctions.net/matchSaleToEmail?saleId=${n}`,{headers:{"x-firebase-appcheck":i.token}})).json()).result}catch{return"not found"}}}async function bI(t){var e={url:`https://mapchart.net/login.html?email=${t}`};$d(fr(),t,e).then(function(){console.log("Email sent")}).catch(function(n){console.log(n)})}async function Ps(t,e){Gt={config:t,createdAt:Date.now(),modifiedAt:Date.now(),configName:Ia(e)};let n=an(),i=Hi(),r=Wi(i,`configs/${n}/${PAGE}`),s=vy(r);ac(s,Gt),Gt.id=s.key}async function wI(t){let e=an(),n=Wi(Hi());$("#map-loading-bars").show(),na(Xn(n,`configs/${e}/${PAGE}/${t}`)).then(i=>{if(i.exists())zy(i.val(),t),$("#map-loading-bars").hide();else return}).catch(i=>{console.error(i)})}async function mc({prefName:t,prefValue:e}){if($t()){let n=an(),i=Ni(),r={};r[t]=e;let s=xi(i,"users",n);await Zm(s,r,{merge:!0})}}async function SI(){if(localStorage.getItem("filledPrefs")===null){let t=an(),e=Ni(),n=xi(e,"users",t),i=await ol(n);if(i.exists()){let r=i.data();localStorage.setItem("theme",r.theme||"default"),localStorage.setItem("mapTheme",r.mapTheme||"default"),localStorage.setItem("filledPrefs",!0)}}}async function EI(){let t=nt();if(t===Gt.config){kr.html("Already up-to-date \u2705"),setTimeout(()=>{kr.html("Save")},1e3);return}let e=Date.now(),n=an(),i=Hi(),r={};r[`configs/${n}/${PAGE}/${Gt.id}/config`]=t,r[`configs/${n}/${PAGE}/${Gt.id}/modifiedAt`]=e,Gt.config=t,Gt.modifiedAt=e,$("#u-save-loading-bars").show(),by(Wi(i),r).then(()=>{$("#u-save-loading-bars").hide(),kr.html("Saved! \u2705"),setTimeout(()=>{kr.html("Save")},1e3)}).catch(s=>{kr.after(`<span>Error: ${s.message} occured. </span>`)})}function By(t){aa.html("");for(let e in t){let n=t[e],i=CI(n,e);aa.append(i),i.find(".u-load-config").on("click",function(){if(PAGE==="my-maps"){let r=Ac(n.page)+`?config=${encodeURIComponent(e)}`;window.open(r,"_blank")}else zy(n,e),Sf.modal("hide")}),i.find(".u-export-config").on("click",function(){this.href="data:text/plain;charset=utf-8,"+encodeURIComponent(n.config);let r="mapchartSave__"+n.configName;this.download=r+".txt"})}}function CI(t,e){let n=PAGE!=="my-maps",i=JSON.parse(t.config).title===""?"-":Df.default.sanitize(JSON.parse(t.config).title),r=Math.random().toString(36).slice(-5),s=Ia(t.configName),o=`<tr id="config-${r}"><td><i class="fa fa-file-text-o" aria-hidden="true"></i></td>`;return n||(o+=`<td><a href="${t.page}.html" target="blank"> ${t.page}</a> </td>`),o+=`<td> ${pp(s)} </td> 
                <td><strong> ${i} </strong> </td> 
                <td> ${hp(t.modifiedAt)} </td>`,n||(o+=`<td> <button type="button" class="btn btn-link u-delete-config"  data-toggle="modal" data-target="#uDeleteConfigModal" data-config-id="${e}" data-config-name="${s}" data-config-page="${t.page}" data-row-id="config-${r}"><i class="fa fa-times" aria-hidden="true"></i> Delete</button> </td> <td> <a role="button" class="btn btn-link u-export-config"><i class="fa fa-cloud-download" aria-hidden="true"></i> Export  </a> </td>`),o+='<td> <button type="button" class="btn btn-link u-load-config">Load  <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></button> </td></tr>',$(o)}function TI(){let t=new Fy.default,e=an(),n=Wi(Hi());na(Xn(n,`configs/${e}/`)).then(i=>{if(i.exists()){let r=i.val(),s={};for(let o in r)for(let a in r[o])r[o][a].page=o,s[a]=r[o][a];for(let o in s){let a=s[o];t.file(`${a.page}/${o}/${a.configName}.txt`,a.config)}t.generateAsync({type:"base64"}).then(function(o){window.location="data:application/zip;base64,"+o},function(o){bn(fc,o)})}else bn(fc,"No data found!")}).catch(i=>{console.error(i)})}function zy(t,e){try{Gt={...t},Gt.id=e;let n=Df.default.sanitize(t.configName);be("UPLOAD_CLOUD_CONFIG",{configName:n},function(){zn(t.config)})}catch(n){cp(n,t.config)}}async function II(){$("#u-load-loading-bars").show();let t=an(),e=Wi(Hi());na(Xn(e,`configs/${t}/`)).then(n=>{if(n.exists()){let i=n.val(),r={};for(let s in i)for(let o in i[s])i[s][o].page=s,r[o]=i[s][o];By(r),Ny.DataTable({columns:[{searchable:!1,orderable:!1},null,null,null,null,{searchable:!1,orderable:!1},{searchable:!1,orderable:!1},{searchable:!1,orderable:!1}]})}else aa.find("td").html("<strong>\u26A0\uFE0F No saved configurations found.</strong>");$("#u-load-loading-bars").hide()}).catch(n=>{console.error(n)}),$("#uDeleteConfigModal").on("show.bs.modal",function(n){let i=$(n.relatedTarget),r=i.data("config-id"),s=i.data("config-page"),o=i.data("config-name"),a=i.data("row-id");$("#u-config-to-delete-name").html(o),$("#u-delete-config-btn").on("click",function(){kI(r,s),$(`#${a}`).remove()})})}async function kI(t,e){let n=an(),i=Hi(),r=Wi(i,`configs/${n}/${e}/${t}`);yy(r)}async function Rs(t){if($t()){let e=an(),n=Ni(),i=xi(n,"palettes",e);await al(i,{palette:Jm(t)}),Je.push(t)}}async function Ns(t){if($t()){let e=an(),n=Ni(),i=xi(n,"palettes",e);await al(i,{palette:Xm(t)}),Je=Je.filter(r=>r!=t)}}async function AI(){if($t()){let t=an(),e=Ni(),n=xi(e,"palettes",t),i=await ol(n);i.exists()?Je=i.data().palette:Je=[],(Je==null||Je===""||Je==="null")&&(Je=[]),PAGE==="my-palette"&&RI()}}function PI(t){Gi.on("click",function(h){h.preventDefault();let u=lc.val().trim();Vd(t.currentUser,{displayName:u}).then(()=>{As.html(u),Gi.html("Updated! \u2705"),setTimeout(()=>{Gi.prop("disabled",!0),Gi.html("Update")},2e3)}).catch(d=>{bn(Gi.parent(),d)})}),lc.on("input",function(h){if($t()){let u=lc.val(),d=As.html();u!==d?Gi.removeAttr("disabled"):Gi.prop("disabled",!0)}}),Cr.on("click",function(h){if(h.preventDefault(),$t()){let u=uc.val().trim(),d=ff.val(),p=nn.credential(t.currentUser.email,d);Io(t.currentUser,p).then(function(){zd(t.currentUser,u).then(function(){OI(Cr,`An e-mail was sent to ${u}. Use the link there to complete the process.`)}).catch(function(_){bn(Cr,_)})}).catch(_=>{bn(Cr,_)})}}),uc.on("input",function(h){let u=uc.val(),d=cc.html();u!==d&&ff.val()!==""?Cr.removeAttr("disabled"):Cr.prop("disabled",!0)}),Tr.on("click",function(h){h.preventDefault();let u=ia.val(),d=ra.val();if($t()&&u===d){let p=pf.val(),_=nn.credential(t.currentUser.email,p);Io(t.currentUser,_).then(function(){Wd(t.currentUser,u).then(function(){pc(Tr.parent(),"Password updated!")}).catch(function(g){console.log(g),console.log(g.message),bn(Tr.parent(),g)})}).catch(g=>{console.log(g),console.log(g.message),bn(Tr.parent(),g)})}}),ra.on("input",function(h){let u=ia.val(),d=ra.val();u===d&&pf.val()!==""?(Tr.removeAttr("disabled"),Ir.removeAttr("disabled")):(Tr.prop("disabled",!0),Ir.prop("disabled",!0))}),ky.on("click",function(h){h.preventDefault();let u=bf.val();if(u!==""&&$t()){let d=nn.credential(t.currentUser.email,u);Io(t.currentUser,d).then(function(){Gd(t.currentUser).then(function(){window.location.href="index.html"}).catch(function(p){console.log(p)})}).catch(p=>{bn(bf.parent(),p)})}}),$(".toggle-pwd").on("mousedown",function(h){$(this).find("i").removeClass("fa-eye-slash").addClass("fa-eye"),$(this).siblings("input").attr("type","text")}).on("mouseup mouseleave touchend",function(){$(this).find("i").removeClass("fa-eye").addClass("fa-eye-slash"),$(this).siblings("input").attr("type","password")});let e,n=$("#pwd-strength-msg"),i=new RegExp("((?=.*[a-z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{8,}))|((?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,}))|((?=.*[a-z])(?=.*[A-Z])(?=.{12,}))|((?=.*[a-z])(?=.*[0-9])(?=.{12,}))"),r=new RegExp("((?=.*[a-z])(?=.*[0-9])(?=.*[^A-Za-z0-9])(?=.{6,}))|((?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])(?=.{8,}))|((?=.*[a-z])(?=.{10,}))");function s(h){if(h.length==0){n.html("");return}i.test(h)?n.css("color","#3c763d").html("Password strength: Strong \u{1F7E2}"):r.test(h)?n.css("color","#8a6d3b").html("Password strength: Medium \u{1F7E1}"):n.css("color","#a94442").html("Password strength: Weak \u{1F534}")}if(ia.on("input",function(h){clearTimeout(e),e=setTimeout(()=>s(this.value),250)}),PAGE==="account-actions"){let h=Ji(),u=h.mode,d=h.oobCode;switch(u){case"resetPassword":sa.html("Set your password"),gf.remove(),_f.remove(),o(t,d);break;case"verifyAndChangeEmail":sa.html("Verify your email"),mf.remove(),_f.remove(),a(t,d);break;case"recoverEmail":sa.html("Recover your email"),mf.remove(),gf.remove(),l(t,d);break;default:sa.html("An error occured.")}}function o(h,u){Ir.on("click",function(d){d.preventDefault();let p=ia.val(),_=ra.val();p===_&&Ud(h,u).then(g=>{let y=g;Fd(h,u,p).then(v=>{Bd(h,y,p).then(w=>{pc(Ir,"<strong>Password set!</strong>",{redirect:!0,redirectTarget:"tutorial-premium",redirectParams:{isFirstChange:!0}})})}).catch(v=>{bn(Ir.parent(),v)})}).catch(g=>{bn(Ir.parent(),g)})})}function a(h,u){Ul(h,u).then(d=>{$(".loading-bars").hide(),pc(vf,"<p>\u2705 Your email has been changed!</p> <p> Use the new email to login to MapChart again.",{redirect:!0,redirectTarget:"login",seconds:10})}).catch(d=>{bn(vf,d)})}function l(h,u){let d=null;Bl(h,u).then(p=>(d=p.data.email,Ul(h,u))).then(()=>{$(".loading-bars").hide(),pc(yf,`<p>\u2705 Your email has been changed back to ${d}.</p> <p> Use it to login to MapChart again.`,{redirect:!0,redirectTarget:"login",seconds:10})}).catch(p=>{bn(yf,p)})}async function c(h,u){let d=Ni();await al(xi(d,"users",h),{email:u})}}function RI(){Je===void 0&&(Je=[]),la.append($r(Je)),la.on("click",function(t){t.target.classList.contains("sp-thumb-inner")&&kf.modal("show",t.target)}),kf.on("show.bs.modal",function(t){let e=t.relatedTarget.parentElement.getAttribute("title");xy.html($(t.relatedTarget).clone()),Af.off("click"),Af.on("click",function(){Ns(e).then(()=>{la.html($r(Je))})})}),$("#my-palette-picker").spectrum({color:"#cc3333",showInput:!0,showPalette:!0,palette:ui,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"my-palette-picker-container",includePatternsInPalette:!0,show:function(){for(let t of Je)$(`.my-palette-picker-container .sp-default-palette span.sp-thumb-el[title="${t}"]`).addClass("sp-thumb-active")},change:function(t){let e=Ue(t)?t:"#"+t.toHex();Rs(e).then(()=>{la.html($r(Je))})}}),$(".sp-add-to-palette, .sp-remove-from-palette").remove()}function NI(){Ji().isFirstChange==="true"&&Dy.show()}function $t(){return!!fr().currentUser}function an(){return localStorage.getItem("u-uid")??fr().currentUser.uid}function xI(){if(localStorage.getItem("u-license-key"))return localStorage.getItem("u-license-key");{let t=an(),e=Ni(),n=xi(e,"users",t);ol(n).then(i=>{let r=i.data().license_key;return localStorage.setItem("u-license-key",r),r})}}function bn(t,e){let i=`<div class="alert alert-danger alert-dismissible" role="alert">            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> ${My[e.code]??e.code} </div>`;t.before($(i))}function OI(t,e){let n=`<div class="alert alert-warning alert-dismissible" role="alert">            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> ${e} </div>`;t.before($(n))}function pc(t,e,n={}){let i=n.redirect||!1,r=n.redirectTarget||"index",s=n.redirectParams||{},o=n.seconds||5,a=i?`<p>Redirecting you in <span id='redirect-timer'>${o}</span> seconds...</p>`:"",l=`<div class="alert alert-success alert-dismissible" role="alert">            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> ${e} ${a}</div>`;if(t.before($(l)),i){let h=setInterval(function(){$("#redirect-timer").html(o),o--},1e3);setTimeout(function(){clearInterval(h),window.location.href=Ac(r,s)},o*1e3)}}function Vy(){let t=generateTestConfig(example_basic,!0,!1,!1),e=generateTestConfig(simple,!1,!1,!0),n=generateTestConfig(example_basic,!1,!1,!0),i=generateTestConfig(simple,!0,!1,!1);Ps(t,"Test config 1"),Ps(e,Ta(PAGE)),Ps(n,"Test config with longer title"),Ps(i,Ta(PAGE,"Another map title"))}function Wy(t){t.on("click",function(e){MI(e.target,e)}),t.on("mouseover",function(e){LI(e.target,e)}),t.mousemove(function(e){FI(e.target,e)}),t.on("mouseout",function(e){$I(e.target)}),$.contextMenu({selector:"#map path",className:"data-title",events:UI,items:BI})}function MI(t,e){if(t&&t.nodeName==="path"){let n=t.id;if(!Yt(n)||PAGE==="usa-counties"&&n.indexOf("_")===-1)return;let i=$(t),r=i.getFill();if(mapchart.eyeDropping){Ue(r)&&(r=Fr(r)),$("#"+mapchart.eyeDroppingForId).spectrum("set",r),Ks("disable");return}if(e.altKey&&e.shiftKey&&$("#color-single").length>0&&(e.preventDefault(),i.removeClass("cursor-color-group"),$("#color-single-list").val(hn(n)),$("#color-single").trigger("click")),e.shiftKey){let o=$("#shift-click-setting").val();if(o==="uncolor"){if(r=="none"&&Nt(n)||r===mt)return;be("REMOVE_COLOR",{affectedPaths:[n],prevColor:r},function(){Ti(n)});return}else if(o==="hide"){let a=i.getStrokeWidth();i.setStrokeWidth(a/2),be("HIDE",{affectedPaths:[n]},function(){bt(n)});return}}let s=$("#fillpicker").spectrum("get").toString();if(s==r)return;be("COLOR",{affectedPaths:[n],color:s},function(){It(s,n)})}}function LI(t,e){if(t&&t.nodeName==="path"){let n=t.id,i=$(t);if(!Yt(n))return;let r=$(t).getFill();if(r=="none"&&Nt(n)){i.setStroke("#000");return}if((e.ctrlKey||e.metaKey)&&e.shiftKey)r!==mt&&be("REMOVE_COLOR",{affectedPaths:[n],prevColor:r},function(){Ti(n),i.removeClass("cursor-eraser")});else if(e.ctrlKey||e.metaKey){let s=$("#fillpicker").spectrum("get").toString();s.toString()!==r&&be("COLOR",{affectedPaths:[n],color:s,prevColor:r},function(){It(s,n),i.removeClass("cursor-bucket")})}if(!(mapchart.zoomTool&&mapchart.zoomTool.isActive)){let s=i.getStrokeWidth();i.setStrokeWidth(s*2)}i.removeClass("cursor-bucket cursor-eraser cursor-color-group")}}function $I(t){if(t&&t.nodeName==="path"){let e=t.id,n=$(t);if(!Yt(e))return;if(Nt(e))n.setStroke("none");else if(n.removeClass("cursor-bucket cursor-eraser cursor-color-group"),!(mapchart.zoomTool&&mapchart.zoomTool.isActive)){let i=n.getStrokeWidth();n.setStrokeWidth(i/2)}}$("#info-tooltip").hide()}function FI(t,e){if(t&&t.nodeName==="path"){let n=t.id,i=$(t);if(!Yt(n))return;let r=$("#info-tooltip"),s=e.clientX,o=e.clientY,a=$("#map").width(),l=$("#map").height(),c=r.width(),h=r.height();if(r.html(n.replace(/_/g," ")),a-s>c?r.css({left:s+15}):a-s>c/2?r.css({left:s-c/2+15}):r.css({left:s-c-15}),l-o>h?r.css({top:o+15}):l-o>h/2?r.css({top:o-h/2+15}):r.css({top:o-h-15}),r.css({"background-image":"none"}),Nt(n))r.append('<span style="color:#a21618"> (hidden)</span>');else if(e.altKey&&e.shiftKey&&$("#color-single").length>0?(e.preventDefault(),i.addClass("cursor-color-group")):(e.ctrlKey||e.metaKey)&&e.shiftKey?i.addClass("cursor-eraser"):(e.ctrlKey||e.metaKey)&&i.addClass("cursor-bucket"),mapchart.eyeDropping){let u=$(t).getFill();r.html(""),Ue(u)?r.css({"background-image":Fn(Fr(u)),"background-repeat":"repeat"}):r.css({"background-color":u,"background-image":"none"})}r.show()}}var UI={show:function(t){$("#context-menu-layer").remove(),$(".data-title").attr("data-menutitle",t.$trigger.attr("id").replace(/_/g," "));let e=$("<span class='shift-click-hint'> *or use Shift + click</span>");$("#shift-click-setting").val()==="uncolor"?$(".remove-paint").append(e):$("#shift-click-setting").val()==="hide"&&$(".hide-path").append(e);let n=t.$trigger.attr("id");xp(n)},hide:function(t){$(".shift-click-hint").remove()}},BI={removePaint:{name:"Remove Paint",icon:"fa-eraser",className:"remove-paint",callback:function(t,e){let n=e.$trigger.getFill();be("REMOVE_COLOR",{affectedPaths:[e.$trigger.attr("id")],prevColor:n},function(){Ti(e.$trigger.attr("id"))})},disabled:function(t,e){let n=e.$trigger.attr("id"),i=e.$trigger.getFill();if(Nt(n)||!Yt(n)||i===mt)return!0}},sep2:"---------",copyPaint:{name:"Copy Existing Color/Pattern",icon:"fa-clone",className:"existing-paints-menu",items:{existingPatternUtils:{name:"                    ",type:"html",html:"",className:"existing-paints"}},disabled:function(t,e){let n=e.$trigger.attr("id");if(Nt(n)||!Yt(n)||jQuery.isEmptyObject(Xi()))return!0}},removePattern:{name:"Remove Pattern",icon:"fa-square",className:"remove-pattern",callback:function(t,e){Np(e.$trigger.attr("id"))},disabled:function(t,e){let n=e.$trigger.attr("id"),i=e.$trigger.getFill();if(Nt(n)||!Yt(n)||!Ue(i))return!0}},sep3:"---------",patternSettings:{name:`<input type="checkbox" class="scale-patterns-setting" name="scale-patterns-setting">                <label for="scale-patterns-setting">Do not scale patterns (<a href="#" data-toggle="modal" data-target="#patternsScaleModal">What's the difference?</a> )</label>`,isHtmlName:!0,className:"context-info",disabled:!0},sep4:"---------",showPath:{name:"Show",icon:"fa-eye",className:"show-path",callback:function(t,e){let n=e.$trigger.attr("id");be("SHOW",{affectedPaths:[n]},function(){Ut(n)})},disabled:function(t,e){let n=e.$trigger.attr("id");if(!Nt(n)||!Yt(n))return!0}},hidePath:{name:"Hide",icon:"fa-eye-slash",className:"hide-path",callback:function(t,e){let n=e.$trigger.attr("id");be("HIDE",{affectedPaths:[n]},function(){bt(n)})},disabled:function(t,e){let n=e.$trigger.attr("id");if(Nt(n)||!Yt(n))return!0}},sep5:"---------",info2:{name:"* Hidden elements will not appear on the final map.",className:"context-info",disabled:!0},sep1:"---------",info1:{name:"* Looking for the <strong>Add Pattern</strong> option? You can now find it <br/>via the color picker <strong>(Select Color > More patterns</strong>).",className:"context-info",isHtmlName:!0,disabled:!0}};var VI=$(".map-theme-switcher-btn");function Mf(){let t=localStorage.getItem("mapTheme")||"default";$(`button[data-map-theme='${t}']`).parent().addClass("is-active"),Hy(t),VI.on("click",function(){Hy($(this).data("map-theme")),$(this).parent().siblings().each(function(){$(this).removeClass("is-active")}),$(this).parent().addClass("is-active")})}function Hy(t){if(!(!["default","dark","aqua"].includes(t)&&!$t()))if(localStorage.setItem("mapTheme",t),PAGE!=="account"){let e=$(`button[data-map-theme='${t}']`),n=e.find("#theme_bg").attr("fill"),i=e.find("#theme_p1").attr("fill"),r=e.find("#theme_p1").attr("stroke"),s=t==="default"?PAGE.includes("usa")||PAGE.includes("canada")?"#000000":"#6a0707":e.find("#theme_labels").attr("fill"),o=e.find("#theme_legend_bg").attr("fill"),a=e.find("#theme_legend").attr("fill");Qs(n),eo(i),$a(r),to(s),Js(o),Xs(a),$("#backgroundpicker").spectrum("set",n),$("#defaultcolorpicker").spectrum("set",i),$("#borderpicker").spectrum("set",r),$("#labelscolorpicker").spectrum("set",s),$("#legendbgpicker").spectrum("set",o),$("#legendfontcolorpicker").spectrum("set",a)}else mc({prefName:"mapTheme",prefValue:t})}function WI(){let t=new Int32Array(256);for(let e=0;e<256;e++){let n=e;for(let i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;t[e]=n}return t}function HI(t){let e=-1;Lf||(Lf=WI());for(let n=0;n<t.length;n++)e=Lf[(e^t[n])&255]^e>>>8;return e^-1}var Lf,$f="image/png",Ff="image/jpeg",GI="AAlwSFlz",jI="AAAJcEhZ",qI="AAAACXBI",Gy="p".charCodeAt(0),jy="H".charCodeAt(0),qy="Y".charCodeAt(0),Ky="s".charCodeAt(0);function Yy(t,e){let n=t.split(","),i=n[0],r=n[1],s,o,a=!1;if(i.indexOf($f)!==-1){s=$f;let _=KI(r);_>=0?(o=Math.ceil((_+28)/3)*4,a=!0):o=33/3*4}i.indexOf(Ff)!==-1&&(s=Ff,o=18/3*4);let l=r.substring(0,o),c=r.substring(o),h=atob(l),u=new Uint8Array(h.length);for(let _=0;_<u.length;_++)u[_]=h.charCodeAt(_);let d=ZI(u,e,s,a),p=btoa(String.fromCharCode(...d));return[i,",",p,c].join("")}function KI(t){let e=t.indexOf(GI);return e===-1&&(e=t.indexOf(jI)),e===-1&&(e=t.indexOf(qI)),e}function YI(t){let e=t.length-1;for(let n=e;n>=4;n--)if(t[n-4]===9&&t[n-3]===Gy&&t[n-2]===jy&&t[n-1]===qy&&t[n]===Ky)return n-3}function ZI(t,e,n,i){if(n===Ff)return t[13]=1,t[14]=e>>8,t[15]=e&255,t[16]=e>>8,t[17]=e&255,t;if(n===$f){let r=new Uint8Array(13);e*=39.3701,r[0]=Gy,r[1]=jy,r[2]=qy,r[3]=Ky,r[4]=e>>>24,r[5]=e>>>16,r[6]=e>>>8,r[7]=e&255,r[8]=r[4],r[9]=r[5],r[10]=r[6],r[11]=r[7],r[12]=1;let s=HI(r),o=new Uint8Array(4);if(o[0]=s>>>24,o[1]=s>>>16,o[2]=s>>>8,o[3]=s&255,i){let a=YI(t);return t.set(r,a),t.set(o,a+13),t}else{let a=new Uint8Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=9;let l=new Uint8Array(54);return l.set(t,0),l.set(a,33),l.set(r,37),l.set(o,50),l}}}(function(t){var e="fontpicker",n={},i={arabic:"Arabic",bengali:"Bengali","chinese-hongkong":"Chinese (Hong Kong)","chinese-simplified":"Chinese (Simplified","chinese-traditional":"Chinese (Traditional)",cyrillic:"Cyrillic","cyrillic-ext":"Cyrillic Extended",devanagari:"Devanagari",greek:"Greek","greek-ext":"Greek Extended",gujarati:"Gujarati",gurmukhi:"Gurmukhi",hebrew:"Hebrew",japanese:"Japanese",kannada:"Kannada",khmer:"Khmer",korean:"Korean",latin:"Latin","latin-ext":"Latin Extended",malayalam:"Malayalam",myanmar:"Myanmar",oriya:"Oriya",sinhala:"Sinhala",tamil:"Tamil",telugu:"Telugu",thai:"Thai",tibetan:"Tibetan",vietnamese:"Vietnamese"},r=["serif","sans-serif","display","handwriting","monospace"];function s(o){var a=0;for(var l in o)o.hasOwnProperty(l)&&a++;return a}t.fn.fontpicker=function(o){var a=function(y){var v=y.parentElement,w=y.getBoundingClientRect(),S=v.getBoundingClientRect();w.bottom>S.bottom&&y.scrollIntoView(!1),w.top<S.top&&y.scrollIntoView()},l=function(y,v){var w="jqfs",S=365,x,P=new Date,F={},C="",B,G,T;if(x=(x=new RegExp("(?:^|; )"+w+"=([^;]*)").exec(document.cookie))?decodeURIComponent(x[1]):null,x!==null){G=x.split("||");for(B in G)try{T=G[B].split("|",2),F[T[0]]=T[1]}catch{}}if(arguments.length===1)return F[y];v===null||v===!1?delete F[y]:F[y]=v,G=[];for(B in F)G.push(B+"|"+F[B]);S>0&&(P.setTime(P.getTime()+S*24*60*60*1e3),C="; expires="+P.toGMTString()),document.cookie=w+"="+encodeURIComponent(G.join("||"))+"; path=/; SameSite=Lax"+C},c={"Abril Fatface":{category:"display",variants:"400",subsets:"latin,latin-ext"},Aclonica:{category:"sans-serif",variants:"400",subsets:"latin"},"Alegreya Sans":{category:"sans-serif",variants:"100,100i,300,300i,400,400i,500,500i,700,700i,800,800i,900,900i",subsets:"cyrillic,cyrillic-ext,greek,greek-ext,latin,latin-ext,vietnamese"},"Architects Daughter":{category:"handwriting",variants:"400",subsets:"latin"},Archivo:{category:"sans-serif",variants:"400,400i,500,500i,600,600i,700,700i",subsets:"latin,latin-ext,vietnamese"},"Archivo Narrow":{category:"sans-serif",variants:"400,400i,500,500i,600,600i,700,700i",subsets:"latin,latin-ext,vietnamese"},"Bebas Neue":{category:"display",variants:"400",subsets:"latin,latin-ext"},Bitter:{category:"serif",variants:"100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},"Bree Serif":{category:"serif",variants:"400",subsets:"latin,latin-ext"},Bungee:{category:"display",variants:"400",subsets:"latin,latin-ext,vietnamese"},Cabin:{category:"sans-serif",variants:"400,500,600,700,400i,500i,600i,700i",subsets:"latin,latin-ext,vietnamese"},Cairo:{category:"sans-serif",variants:"200,300,400,600,700,900",subsets:"arabic,latin,latin-ext"},Coda:{category:"display",variants:"400,800",subsets:"latin,latin-ext"},Comfortaa:{category:"display",variants:"300,400,500,600,700",subsets:"cyrillic,cyrillic-ext,greek,latin,latin-ext,vietnamese"},"Comic Neue":{category:"handwriting",variants:"300,300i,400,400i,700,700i",subsets:"latin"},Cousine:{category:"monospace",variants:"400,400i,700,700i",subsets:"cyrillic,cyrillic-ext,greek,greek-ext,hebrew,latin,latin-ext,vietnamese"},"Croissant One":{category:"display",variants:"400",subsets:"latin,latin-ext"},"Faster One":{category:"display",variants:"400",subsets:"latin"},Forum:{category:"display",variants:"400",subsets:"cyrillic,cyrillic-ext,latin,latin-ext"},"Great Vibes":{category:"handwriting",variants:"400",subsets:"latin,latin-ext"},Heebo:{category:"sans-serif",variants:"100,200,300,400,500,600,700,800,900",subsets:"hebrew,latin"},Inconsolata:{category:"monospace",variants:"200,300,400,500,600,700,800,900",subsets:"latin,latin-ext,vietnamese"},"Josefin Slab":{category:"serif",variants:"100,200,300,400,500,600,700,100i,200i,300i,400i,500i,600i,700i",subsets:"latin"},Lato:{category:"sans-serif",variants:"100,100i,300,300i,400,400i,700,700i,900,900i",subsets:"latin,latin-ext"},"Libre Baskerville":{category:"serif",variants:"400,400i,700",subsets:"latin,latin-ext"},Lobster:{category:"display",variants:"400",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Lora:{category:"serif",variants:"400,500,600,700,400i,500i,600i,700i",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Merriweather:{category:"serif",variants:"300,300i,400,400i,700,700i,900,900i",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Montserrat:{category:"sans-serif",variants:"100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Mukta:{category:"sans-serif",variants:"200,300,400,500,600,700,800",subsets:"devanagari,latin,latin-ext"},Nunito:{category:"sans-serif",variants:"200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Offside:{category:"display",variants:"400",subsets:"latin"},"Open Sans":{category:"sans-serif",variants:"300,300i,400,400i,600,600i,700,700i,800,800i",subsets:"cyrillic,cyrillic-ext,greek,greek-ext,latin,latin-ext,vietnamese"},Oswald:{category:"sans-serif",variants:"200,300,400,500,600,700",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Overlock:{category:"display",variants:"400,400i,700,700i,900,900i",subsets:"latin,latin-ext"},Pacifico:{category:"handwriting",variants:"400",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},"Playfair Display":{category:"serif",variants:"400,500,600,700,800,900,400i,500i,600i,700i,800i,900i",subsets:"cyrillic,latin,latin-ext,vietnamese"},Poppins:{category:"sans-serif",variants:"100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i",subsets:"devanagari,latin,latin-ext"},Raleway:{category:"sans-serif",variants:"100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i",subsets:"cyrillic,cyrillic-ext,latin,latin-ext,vietnamese"},Roboto:{category:"sans-serif",variants:"100,100i,300,300i,400,400i,500,500i,700,700i,900,900i",subsets:"cyrillic,cyrillic-ext,greek,greek-ext,latin,latin-ext,vietnamese"},"Roboto Mono":{category:"monospace",variants:"100,200,300,400,500,600,700,100i,200i,300i,400i,500i,600i,700i",subsets:"cyrillic,cyrillic-ext,greek,latin,latin-ext,vietnamese"},"Source Sans Pro":{category:"sans-serif",variants:"200,200i,300,300i,400,400i,600,600i,700,700i,900,900i",subsets:"cyrillic,cyrillic-ext,greek,greek-ext,latin,latin-ext,vietnamese"},"Space Mono":{category:"monospace",variants:"400,400i,700,700i",subsets:"latin,latin-ext,vietnamese"},"Spicy Rice":{category:"display",variants:"400",subsets:"latin"},"Squada One":{category:"display",variants:"400",subsets:"latin"},"Sue Ellen Francisco":{category:"handwriting",variants:"400",subsets:"latin"},"Trade Winds":{category:"display",variants:"400",subsets:"latin"},Ubuntu:{category:"sans-serif",variants:"300,300i,400,400i,500,500i,700,700i",subsets:"cyrillic,cyrillic-ext,greek,greek-ext,latin,latin-ext"},Varela:{category:"sans-serif",variants:"400",subsets:"latin,latin-ext"},Vollkorn:{category:"serif",variants:"400,500,600,700,800,900,400i,500i,600i,700i,800i,900i",subsets:"cyrillic,cyrillic-ext,greek,latin,latin-ext,vietnamese"},"Work Sans":{category:"sans-serif",variants:"100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i",subsets:"latin,latin-ext,vietnamese"},"Zilla Slab":{category:"serif",variants:"300,300i,400,400i,500,500i,600,600i,700,700i",subsets:"latin,latin-ext"}},h={en:{selectFont:"Select a font for the legend:",search:"Search",allLangs:"All languages",favFonts:"Favorite fonts",localFonts:"Basic fonts",googleFonts:"More fonts",select:"Select",styles:"styles",sampleText:"The quick brown fox jumps over the lazy dog.",sampleTextEditable:"Sample text, editable"},nl:{selectFont:"Kies een lettertype",search:"Zoek",allLangs:"Alle talen",favFonts:"Favoriete lettertypen",localFonts:"Lokale lettertypen",googleFonts:"Google lettertypen",select:"Kies",styles:"stijlen",sampleText:"Wazig tv-filmpje rond chique skybox.",sampleTextEditable:"Voorbeeldtekst, bewerkbaar"},de:{selectFont:"Schriftart w\xE4hlen",search:"Suchen",allLangs:"Alle Sprachen",favFonts:"Favorisierte Schriftarten",localFonts:"Lokale Schriftarten",googleFonts:"Google Schriftarten",select:"W\xE4hlen",styles:"stile",sampleText:"Vogel Quax zwickt Johnys Pferd Bim.",sampleTextEditable:"Beispieltext, editierbar"},es:{selectFont:"Seleccionar fuente",search:"Buscar",allLangs:"Todos los idiomas",favFonts:"Fuentes favoritas",localFonts:"Fuentes locales",googleFonts:"Fuentes de Google",select:"Seleccionar",styles:"estilos",sampleText:"La cig\xFCe\xF1a tocaba cada vez mejor el saxof\xF3n y el b\xFAho ped\xEDa kiwi y queso",sampleTextEditable:"Texto de ejemplo, editable"},fr:{selectFont:"Selectionner une police",search:"Rechercher",allLangs:"Toutes les langues",favFonts:"Polices favorites",localFonts:"Polices locales",googleFonts:"Polices Google",select:"Selectionner",styles:"Styles",sampleText:"Le vif renard brun saute par-dessus le chien paresseux.",sampleTextEditable:"Texte d'exemple, \xE9ditable"}},u={lang:"en",variants:!0,nrRecents:3,lazyLoad:!0,debug:!1,localFontsUrl:"/fonts/",parentElement:"body",localFonts:{Arial:{category:"sans-serif",variants:"400,400i,600,600i"},"Courier New":{category:"monospace",variants:"400,400i,600,600i"},Georgia:{category:"serif",variants:"400,400i,600,600i"},Tahoma:{category:"sans-serif",variants:"400,400i,600,600i"},"Times New Roman":{category:"serif",variants:"400,400i,600,600i"},"Trebuchet MS":{category:"sans-serif",variants:"400,400i,600,600i"},Verdana:{category:"sans-serif",variants:"400,400i,600,600i"}}},d=function(){function y(v,w){if(w.googleFonts&&Array.isArray(w.googleFonts)){for(var S={},x,P=0;P<w.googleFonts.length;P++)x=w.googleFonts[P],S[x]=c[x];w.googleFonts=S}else w.googleFonts!==!1&&(w.googleFonts=c);w.localFonts||(w.localFonts=[]),h[w.lang]||(w.lang="en"),this.dictionary=h[w.lang],this.allFonts={google:w.googleFonts,local:w.localFonts},this.options=w,this.$original=t(v),this.setupHtml(),this.bindEvents()}return y.prototype={loadFont:function(v,w){if(!n[w])switch(n[w]=!0,v){case"google":var S="https://fonts.googleapis.com/css?family="+w.replace(/ /g,"+")+":"+this.options.googleFonts[w].variants+"&display=swap";this.options.debug&&console.log("Loading Google font "+w+" from "+S),t("head").append(t("<link>",{href:S,rel:"stylesheet",type:"text/css"}));break;case"local":var x="fonts"in document&&"check"in document.fonts;(!x||!document.fonts.check("11pt "+w))&&(this.options.debug&&console.log("Loading local font "+w),t("head").append("<style> @font-face { font-family:'"+w+"'; src:local('"+w+"'), url('"+this.options.localFontsUrl+w+".woff') format('woff'); } </style>"));break}},showSample:function(v){t(".fp-sample",this.$element).css({fontFamily:"'"+v.data("font-family")+"'",fontStyle:v.data("font-italic")?"italic":"normal",fontWeight:v.data("font-weight")||400})},keyDown:function(v,w){function S(F){F.preventDefault(),F.stopPropagation()}var x=t("li.fp-active:visible",this.$results);if(v.keyCode>=49&&v.keyCode<=57||v.keyCode>=97&&v.keyCode<=105){S(v);var P=100*(v.keyCode-(v.keyCode>=97?96:48));t(".fp-pill[data-font-weight="+P+"]",x).trigger("click");return}switch(v.keyCode){case 73:S(v),t(".fp-pill.italic:visible",x).trigger("click");break;case 38:S(v),$prevLi=x.prevAll(":not(.fp-divider):visible:first"),$prevLi.length==0&&($prevLi=t("li:not(.fp-divider):visible:last",this.$results)),$prevLi.trigger("mouseenter").trigger("click"),a($prevLi[0]);break;case 40:S(v),$nextLi=x.nextAll(":not(.fp-divider):visible:first"),$nextLi.length==0&&($nextLi=t("li:not(.fp-divider):visible:first",this.$results)),$nextLi.trigger("mouseenter").trigger("click"),a($nextLi[0]);break;case 13:S(v),t("li.fp-active",this.$results).find("button.apply").trigger("click");break;case 27:S(v),t(".fp-close",this.$modal).trigger("click");break}},mouseEnter:function(v,w){var S=t(w);t("li.fp-hover",this.$results).removeClass("fp-hover"),S.addClass("fp-hover"),this.loadFont(S.data("font-type"),S.data("font-family")),this.showSample(S)},click:function(v,w){var S=t(w),x=this,P=S.data("font-type"),F=S.data("font-family"),C=S.data("font-italic")||!1,B=S.data("font-weight")||400,G=t("li[data-font-family='"+F+"']",this.$results),T=l("favs"),L=T?T.split(","):[];t("li.fp-active",this.$results).removeClass("fp-active").find(".fp-variants,.fp-btns").remove(),S.addClass("fp-active");var f=t('<div class="fp-btns">'),I=L.indexOf(P+":"+F)!=-1;f.append(t('<span class="fp-favorite'+(I?" checked":"")+'"></span>').on("click",function(O){O.stopPropagation();var R=L.indexOf(P+":"+F);t(this).is(".checked")?R!=-1&&L.splice(R,1):R==-1&&L.push(P+":"+F),t(this).toggleClass("checked"),l("favs",L.join(","))}),t('<button type="button" class="fp-btn apply btn btn-icon-drop btn-control-color">').html(this.dictionary.select).on("click",function(O){O.stopPropagation(),C=S.data("font-italic"),B=S.data("font-weight")||400;var R=F;if(x.options.variants&&(R+=":"+B+(C?"i":"")),x.$select.css({fontFamily:"'"+F+"'",fontStyle:C?"italic":"normal",fontWeight:B}).find(".fp-fontspec").html(R),x.$original.val(R).change(),x.options.onSelect&&x.options.onSelect({fontType:P,fontFamily:F,fontStyle:C?"italic":"normal",fontWeight:B,fontSpec:R}),x.toggleModal("hide"),x.options.nrRecents){var ee=l("recents"),te=S.data("font-type")+":"+F;ee=ee?ee.split(","):[],ee.indexOf(te)==-1&&ee.unshift(te),ee=ee.slice(0,x.options.nrRecents),l("recents",ee.join(","))}})),f.appendTo(S);var q=this.allFonts[P][F],M=q.variants?q.variants.split(","):[];if(this.options.variants&&M.length>1){for(var Q=t('<div class="fp-variants">'),b=!1,W=0;W<M.length;W++){if(/i$/.test(M[W])){b||(b=!0);continue}let O=M[W],R=+O.replace(/i$/,"");W>0&&Q.append(" "),t('<span data-font-weight="'+R+'" class="fp-pill weight'+(B==R?" checked":"")+'">').text(O).on("click",function(ee){ee.stopPropagation(),M.indexOf(R+"i")==-1?(t(".fp-pill.italic",S).removeClass("checked").css("display","none"),C=!1,S.data("font-italic",C)):t(".fp-pill.italic",S).css("display",""),t("span.fp-pill.weight",S).removeClass("checked"),t(this).addClass("checked"),G.data("font-weight",R),x.showSample(S)}).appendTo(Q)}b&&(Q.append(" "),t('<span class="fp-pill italic '+(C?" checked":"")+'">').css("display",M.indexOf(B+"i")==-1?"none":"").html("italic").on("click",function(O){O.stopPropagation(),C=!C,t(this).toggleClass("checked"),G.data("font-italic",C),x.showSample(S)}).appendTo(Q)),S.append(Q)}else M.length==1&&/i$/.test(M[0])&&G.data("font-italic",!0)},fontSpecToComponents:function(v){var w=v.split(":"),S=w[0],x=w[1]||"400",P=!1,F=400;return/(\d+)i$/.test(x)?(P=!0,F=+RegExp.$1):F=+x,{family:S,weight:F,italic:P}},applyFontToOriginalInput:function(v){if(v===""){this.$select.removeAttr("style").find(".fp-fontspec").html(this.dictionary.selectFont),this.$original.val("");return}var w=this.fontSpecToComponents(v);this.loadFont(this.options.googleFonts!==!1&&c[w.family]?"google":"local",w.family),this.$select.css({fontFamily:"'"+w.family+"'",fontStyle:w.italic?"italic":"normal",fontWeight:w.weight}).find(".fp-fontspec").html(v)},bindEvents:function(){var v=this;this.$results.on("keydown",function(w){v.keyDown(w,this)}).on("mouseenter","li:not(.fp-divider):visible",function(w){v.mouseEnter(w,this)}).on("click","li:not(.fp-divider):visible",function(w){v.click(w,this)}).on("dblclick","li:not(.fp-divider):visible",function(w){t("li.fp-active",this.$results).find("button.apply").trigger("click")}),this.$original.on("change",function(w){v.applyFontToOriginalInput(this.value)})},lazyLoad:function(){if(!!window.IntersectionObserver){var v=this,w,S=new IntersectionObserver(function(x){[].forEach.call(x,function(P){P.intersectionRatio>0&&(S.unobserve(P.target),w=t(P.target),v.loadFont(w.data("font-type"),w.data("font-family")),w.css("fontFamily","'"+w.data("font-family")+"'"))})});t("li:not(.fp-divider)",this.$results).each(function(){S.observe(this)})}},toggleModal:function(v){if(v||(v=this.$modal.is(":visible")?"hide":"show"),v=="hide")t(".fp-fav,.fp-variants,.fp-btns").remove(),this.$modal.css("display","none"),t(".fp-modal-backdrop",this.$element).remove(),t(this.options.parentElement).removeClass("fp-modal-open"),t("span",this.$select).focus();else{t(this.options.parentElement).addClass("fp-modal-open"),this.$element.append(t('<div class="fp-modal-backdrop">').on("click",function(){t(".fp-close",this.$modal).trigger("click")})),this.$modal.css("display","flex"),this.getFavorites();var w=this.$original.val();if(w){var S=this.fontSpecToComponents(w),x=t("li[data-font-family='"+S.family+"']",this.$results);x.length>0&&(x.data({"font-italic":S.italic,"font-weight":S.weight}).eq(0).trigger("click"),a(x[0]))}else this.$results.scrollTop(0);this.options.lazyLoad&&this.lazyLoad(),this.$results.focus()}},applyFilter:function(){var v=this.$lang.val(),w=this.$search.val().trim(),S=[];t(".fp-category",this.$filter).each(function(){t(this).hasClass("checked")&&S.push(t(this).data("category"))}),l("lang",v===""?!1:v),l("cats",S.join(","));for(var x in this.allFonts)for(var P in this.allFonts[x]){var F=this.allFonts[x][P],C=F.subsets?F.subsets.split(","):[],B=t("li[data-font-family='"+P+"']",this.$results),G=F.category||"other";(v==""||C.indexOf(v)!=-1)&&S.indexOf(G)!=-1&&(w==""||P.toLowerCase().indexOf(w.toLowerCase())!=-1)?B.show():B.hide()}},getFilterUI:function(){var v=this,w=t('<div class="fp-search-wrap">');this.$filter=t('<div class="fp-filter">'),this.$search=t("<input>",{class:"fp-search",type:"text",placeholder:this.dictionary.search,spellcheck:!1}).on("keyup",function(){v.applyFilter()}).appendTo(w),t('<div class="fp-clear">').on("click",function(){v.$search.val("").focus(),v.applyFilter()}).appendTo(w);var S=['<option value="">'+this.dictionary.allLangs+"</option>"];for(var x in i)S.push('<option value="'+x+'">'+i[x]+"</option>");this.$lang=t('<select class="fp-lang">').on("change",function(){v.applyFilter()}).html(S.join("")),this.$filter.append(t('<div class="fp-row">').append(w,this.$lang)),t('<div class="hr">').appendTo(this.$filter);var P=r.slice(0);P.push("other");for(var F=0;F<P.length;F++)t('<span class="fp-category fp-pill checked">').data("category",P[F]).text(P[F]).on("click",function(){t(this).toggleClass("checked"),v.applyFilter()}).appendTo(this.$filter)},getFontsList:function(){var v=this,w=t(document.createDocumentFragment()),S,x;function P(F,C){var B=v.allFonts[F][C],G="";if(B.category||B.variants){var T=[];if(B.category&&T.push(B.category),v.options.variants&&B.variants){var L=B.variants.split(",").length;L>1&&T.push(L+" "+v.dictionary.styles)}G=" <small>"+T.join(", ")+"</small>"}S=t("<li>",{"data-font-type":F,"data-font-family":C}).html(C+G),w.append(S[0])}if(s(this.options.localFonts)>0){S=t('<li class="fp-divider">'+this.dictionary.localFonts+"</li>"),w.append(S[0]);for(x in this.options.localFonts)P("local",x)}if(s(this.options.googleFonts)>0){S=t('<li class="fp-divider">'+this.dictionary.googleFonts+"</li>"),w.append(S[0]);for(x in this.options.googleFonts)P("google",x)}this.$results=t("<ul>",{class:"fp-results",tabindex:0}).append(w)},getFavorites:function(){var v=l("favs"),w=l("recents");v=v?v.split(","):[],w=!!this.options.nrRecents&&w?w.split(","):[];for(var S=w.slice(0),x=0;x<v.length;x++)S.indexOf(v[x])==-1&&S.push(v[x]);for(var P=t(document.createDocumentFragment()),F=null,C,B,G,T,L,x=0;x<S.length;x++)B=S[x].split(":"),G=B[0],T=B[1],L=this.allFonts[G][T],L&&(C=t("[data-font-family='"+T+"']",this.$results),C.length>0&&(F=C.clone().addClass("fp-fav"),P.append(F[0])));F!==null&&(P.prepend(t('<li class="fp-fav fp-divider">'+this.dictionary.favFonts+"</li>")[0]),this.$results.prepend(P))},setupHtml:function(){var v=this,w=this.$original.val();this.$original.hide(),this.$select=t('<div class="font-picker fp-select">').on("click",function(){v.toggleModal("show")}).on("keydown",function(P){P.keyCode==32&&(P.stopPropagation(),P.preventDefault(),v.toggleModal("show"))}).append('<span class="fp-fontspec" tabindex="0">'+(w||this.dictionary.selectFont)+"</span>"),v.options.showClear&&v.$select.append(t('<span class="fp-clear"></span>').on("click",function(P){P.stopPropagation(),v.$select.removeAttr("style").find(".fp-fontspec").html(v.dictionary.selectFont),v.$original.val("").change()})),this.$original.after(this.$select),this.$element=t("<div>",{class:"font-picker"}),this.$modal=t('<div class="fp-modal">').appendTo(this.$element),this.$modal.append(t('<div class="fp-header">').append(t('<div class="fp-icons">').append(t('<span class="fp-close">&times</span>').on("click",function(){v.toggleModal("hide")})),t("<h4>").text(this.dictionary.selectFont))),this.getFilterUI(),this.$modal.append(this.$filter),this.$sample=t("<div>",{class:"fp-sample",contenteditable:!0,spellcheck:!1,title:this.dictionary.sampleTextEditable}).html(this.dictionary.sampleText).appendTo(this.$modal),this.getFontsList(),this.$modal.append(this.$results);var S=l("lang"),x=l("cats");S&&this.$lang.val(S),x&&(x=x.split(","),t(".fp-category",this.$filter).each(function(){x.indexOf(t(this).data("category"))==-1?t(this).removeClass("checked"):t(this).addClass("checked")})),(S||x)&&v.applyFilter(),w&&v.applyFontToOriginalInput(w),t(this.options.parentElement).append(this.$element)},show:function(){var v=t(this).data("plugin_"+e);if(!v.$select)throw new Error("jquery."+e+": Cannot show, as I've been destroyed.");v.toggleModal("show")},hide:function(){var v=t(this).data("plugin_"+e);if(!v.$select)throw new Error("jquery."+e+": Cannot hide, as I've been destroyed.");v.toggleModal("hide")},destroy:function(){var v=t(this).data("plugin_"+e);if(!v.$select)throw new Error("jquery."+e+": Cannot destroy, as I've been destroyed already.");v.toggleModal("hide"),v.$select.remove(),v.$element.remove(),v.$original.off("setFont"),v.$original.show(),v.$select=v.$element=v.$original=v.$modal=null,t(v).removeData("plugin_"+e)}},y}();if(typeof arguments[0]=="string"){var p=arguments[0],_=Array.prototype.slice.call(arguments,1),g;return this.each(function(){if(t.data(this,"plugin_"+e)&&typeof t.data(this,"plugin_"+e)[p]=="function")g=t.data(this,"plugin_"+e)[p].apply(this,_);else throw new Error("jquery."+e+": Method "+p+" does not exist.")}),g!==void 0?g:this}return this.each(function(){t.data(this,"plugin_"+e)||(o&&t.extend(u,o),t.data(this,"plugin_"+e,new d(this,u)))})}})(jQuery);(function(t,e){"use strict";var n={beforeShow:d,move:d,change:d,show:d,hide:d,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showEyeDropper:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,includePatternsInPalette:!1,localStorageKey:!1,appendTo:"body",maxSelectionSize:36,cancelText:"Hide",chooseText:"Select",togglePaletteLessText:"Close",clearText:"Clear Color Selection",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},i=[],r=!!/msie/i.exec(window.navigator.userAgent),s=function(){function P(B,G){return!!~(""+B).indexOf(G)}var F=document.createElement("div"),C=F.style;return C.cssText="background-color:rgba(0,0,0,.5)",P(C.backgroundColor,"rgba")||P(C.backgroundColor,"hsla")}(),o=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","</div>"].join(""),a=function(){var P="";if(r)for(var F=1;F<=6;F++)P+="<div class='sp-"+F+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette-tab-container sp-cf'>","<button type='button' class='sp-default-palette-toggle btn-link sp-palette-tab-selected'>Default</button>","<button type='button' class='sp-my-palette-toggle btn-link'>My Palette</button>","</div>","<div class='sp-palette sp-default-palette sp-thumb sp-cf'></div>","<div class='sp-palette sp-my-palette sp-thumb sp-cf sp-hidden'></div>","<div class='sp-more-buttons-container sp-cf'>","<button type='button' class='sp-patterns-toggle sp-btn-action'>More patterns</button>","<button type='button' class='sp-palette-toggle sp-btn-action'>More colors <i class='fa fa-chevron-right'></i></button>","<button type='button' class='sp-cancel btn-link'>Hide <i class='fa fa-chevron-left'></i></button>","</div>","<div class='sp-eye-dropper-container sp-cf'>","<button type='button' class='btn btn-link sp-eye-dropper'>Pick from map <i class='fa fa-eyedropper' aria-hidden='true'></i></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",P,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-my-palette-button-container sp-cf'>","<button type='button' class='sp-add-to-palette btn-link'>Add to My Palette <i class='fa fa-heart-o' aria-hidden='true'></i> </button>","<button type='button' class='sp-remove-from-palette btn-link'>Remove from My Palette <i class='fa fa-heart' aria-hidden='true'></i> </button>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false' autocomplete='off' />","<button type='button' class='sp-choose sp-btn-action'></button>","<p class='sp-invalid-color-msg sp-hidden'>Invalid color. Input a color in hex format (e.g.#ca335d).</p>","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","</div>","</div>"].join("")}();function l(){for(var P=0;P<i.length;P++)i[P]&&i[P].hide()}function c(P,F){var C=t.extend({},n,P);return C.callbacks={move:_(C.move,F),change:_(C.change,F),show:_(C.show,F),hide:_(C.hide,F),beforeShow:_(C.beforeShow,F)},C}function h(P,F){var C=c(F,P),B=C.flat,G=C.showSelectionPalette,T=C.localStorageKey,L=C.theme,f=C.callbacks,I=w(dn,10),q=!1,M=!1,Q=0,b=0,W=0,O=0,R=0,ee=0,te=0,ne=0,ve=0,Ie=0,_e=0,pe=1,Ae=!1,xe="",qe=[],rt=[],m=["circles3_a03500_000000","diagonal1_d9b400_535353","diagonal3_3264c8_ffffff","horizontal1_72b38e_000000","horizontal3_986ba1_ffffff","vertical1_b9a087_ffffff","vertical3_4c91bf_ffff33","checkers_cc3333_f7f7f7","texture_d1dbdd_525252"],J={},j="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAMdJREFUOE+tkgsNwzAMRMugEAahEAahEAZhEAqlEAZhEAohEAYh81X2dIm8fKpEspLGvudPOsUYpxE2BIJCroJmEW9qJ+MKaBFhEMNabSy9oIcIPwrB+afvAUFoK4H0tMaQ3XtlrggDhOVVMuT4E5MMG0FBbCEYzjYT7OxLEvIHQLY2zWwQ3D+9luyOQTfKDiFD3iUIfPk8VqrKjgAiSfGFPecrg6HN6m/iBcwiDAo7WiBeawa+Kwh7tZoSCGLMqwlSAzVDhoK+6vH4G0P5wdkAAAAASUVORK5CYII=)",A="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIVJREFUeNpiYBhsgJFMffxAXABlN5JruT4Q3wfi/0DsT64h8UD8HmpIPCWG/KemIfOJCUB+Aoacx6EGBZyHBqI+WsDCwuQ9mhxeg2A210Ntfo8klk9sOMijaURm7yc1UP2RNCMbKE9ODK1HM6iegYLkfx8pligC9lCD7KmRof0ZhjQACDAAceovrtpVBRkAAAAASUVORK5CYII=)",E=C.selectionPalette.slice(0),z=C.maxSelectionSize,X="sp-dragging",K=null,H=P.ownerDocument,Z=t(P),ce=!1,D=t(a,H).addClass(L),Y=D.find(".sp-picker-container"),re=D.find(".sp-color"),ae=D.find(".sp-dragger"),Te=D.find(".sp-hue"),Ke=D.find(".sp-slider"),Ye=D.find(".sp-alpha-inner"),k=D.find(".sp-alpha"),U=D.find(".sp-alpha-handle"),N=D.find(".sp-input"),se=D.find(".sp-default-palette"),le=D.find(".sp-my-palette"),ye=D.find(".sp-initial"),Pe=D.find(".sp-cancel"),Re=D.find(".sp-clear"),Ee=D.find(".sp-choose"),et=D.find(".sp-palette-toggle"),dt=D.find(".sp-default-palette-toggle"),tt=D.find(".sp-my-palette-toggle"),Ar=D.find(".sp-default-palette"),wn=D.find(".sp-my-palette"),Qn=D.find(".sp-add-to-palette"),Sn=D.find(".sp-remove-from-palette"),xs=D.find(".sp-eye-dropper"),vc=D.find(".sp-patterns-toggle"),Pr=Z.is("input"),ha=D.find(".sp-invalid-color-msg"),yc=Pr&&Z.attr("type")==="color"&&S(),Rr=Pr&&!B,_t=Rr?t(o).addClass(L).addClass(C.className).addClass(C.replacerClassName):t([]),ei=Rr?_t:Z,ln=_t.find(".sp-preview-inner"),ji=C.color||Pr&&Z.val(),ti=!1,Ei=C.preferredFormat,fa=!C.showButtons||C.clickoutFiresChange,cn=!ji,Ze=C.allowEmpty&&!yc;async function qi(){if(C.showPaletteOnly&&(C.showPalette=!0),C.showPaletteOnly?et.show():et.hide(),C.palette){qe=C.palette.slice(0),rt=t.isArray(qe[0])?qe:[qe],J={};for(var ue=0;ue<rt.length;ue++)for(var de=0;de<rt[ue].length;de++){var Se=tinycolor(rt[ue][de]).toRgbString();J[Se]=!0}C.includePatternsInPalette&&rt.push(m)}D.toggleClass("sp-flat",B),D.toggleClass("sp-input-disabled",!C.showInput),D.toggleClass("sp-alpha-enabled",C.showAlpha),D.toggleClass("sp-clear-enabled",Ze),D.toggleClass("sp-buttons-disabled",!C.showButtons),D.toggleClass("sp-palette-buttons-disabled",!C.togglePaletteOnly),D.toggleClass("sp-palette-disabled",!C.showPalette),D.toggleClass("sp-palette-only",C.showPaletteOnly),D.toggleClass("sp-initial-disabled",!C.showInitial),D.toggleClass("sp-eye-dropper-disabled",!C.showEyeDropper),D.toggleClass("sp-patterns-toggle-disabled",!C.includePatternsInPalette),D.addClass(C.className).addClass(C.containerClassName),dn()}function ht(){if(r&&D.find("*:not(input)").attr("unselectable","on"),qi(),Rr&&Z.after(_t).hide(),Ze||Re.hide(),B)Z.after(D).hide();else{var ue=C.appendTo==="parent"?Z.parent():t(C.appendTo);ue.length!==1&&(ue=t("body")),ue.append(D)}Os(),ei.on("click.spectrum touchstart.spectrum",function(he){ce||Mn(),he.stopPropagation(),t(he.target).is("input")||he.preventDefault()}),(Z.is(":disabled")||C.disabled===!0)&&Dr(),D.click(p),Pe.on("click.spectrum",function(he){he.stopPropagation(),he.preventDefault(),C.showPaletteOnly=!C.showPaletteOnly,et.show(),Pe.hide(),qi()}),Re.attr("title",C.clearText),Re.on("click.spectrum",function(he){he.stopPropagation(),he.preventDefault(),cn=!0,qt(),B&&si(!0)}),Ee.text(C.chooseText),Ee.on("click.spectrum",function(he){he.stopPropagation(),he.preventDefault(),r&&N.is(":focus")&&ni(),ri()&&ni()}),Qn.on("click.spectrum",function(he){if(he.stopPropagation(),he.preventDefault(),ri()){let it=N.val();if(it!==null&&it!==""){var $e=tinycolor(it);$e.isValid()?Rs("#"+$e.toHex()).then(()=>{dn(),Qn.hide(),Sn.show().find("i").toggleClass("fa-flip-horizontal")}):N.addClass("sp-validation-error")}}}),Sn.on("click.spectrum",function(he){if(he.stopPropagation(),he.preventDefault(),ri()){let it=N.val();if(it!==null&&it!==""){var $e=tinycolor(it);$e.isValid()?Ns("#"+$e.toHex()).then(()=>{dn(),Sn.hide(),Qn.show().find("i").toggleClass("fa-flip-horizontal")}):N.addClass("sp-validation-error")}}}),C.showPaletteOnly?et.show():et.hide(),et.on("click.spectrum",function(he){he.stopPropagation(),he.preventDefault(),C.showPaletteOnly=!C.showPaletteOnly,et.hide(),Pe.show(),!C.showPaletteOnly&&!B&&D.css("left","-="+(Y.outerWidth(!0)+5)),qi()}),vc.on("click.spectrum",function(he){he.stopPropagation(),he.preventDefault(),y(Z)}),dt.on("click.spectrum",function(he){Ar.removeClass("sp-hidden"),wn.addClass("sp-hidden"),dt.toggleClass("sp-palette-tab-selected"),tt.toggleClass("sp-palette-tab-selected")}),tt.on("click.spectrum",function(he){Ar.addClass("sp-hidden"),wn.removeClass("sp-hidden"),dt.toggleClass("sp-palette-tab-selected"),tt.toggleClass("sp-palette-tab-selected")}),xs.on("click.spectrum",function(he){he.stopPropagation(),he.preventDefault(),mapchart.eyeDroppingForId=Z.attr("id"),Ks("enable"),t("body").on("click",function($e){$e.target&&$e.target.nodeName!=="path"&&Ks("disable")})}),g(k,function(he,$e,it){pe=he/ee,cn=!1,it.shiftKey&&(pe=Math.round(pe*10)/10),qt()},Ki,Nr),g(Te,function(he,$e){ve=parseFloat($e/O),cn=!1,C.showAlpha||(pe=1),qt()},Ki,Nr),g(re,function(he,$e,it){if(!it.shiftKey)K=null;else if(!K){var Mr=Ie*Q,Ci=b-_e*b,ai=Math.abs(he-Mr)>Math.abs($e-Ci);K=ai?"x":"y"}var ma=!K||K==="x",ga=!K||K==="y";ma&&(Ie=parseFloat(he/Q)),ga&&(_e=parseFloat((b-$e)/b)),cn=!1,C.showAlpha||(pe=1),qt()},Ki,Nr),ji?(Ln(ji),Kt(),Ei=C.preferredFormat||tinycolor(ji).format,En(ji)):Kt(),B&&Yi();function de(he){return he.data&&he.data.ignore?(Ln(t(he.target).closest(".sp-thumb-el").data("color")),qt()):(Ln(t(he.target).closest(".sp-thumb-el").data("color")),qt(),si(!0),C.hideAfterPaletteSelect&&un()),!1}var Se=r?"mousedown.spectrum":"click.spectrum touchstart.spectrum";se.on(Se,".sp-thumb-el",de),le.on(Se,".sp-thumb-el",de),ye.on(Se,".sp-thumb-el:nth-child(1)",{ignore:!0},de)}function Os(){if(T&&window.localStorage){try{var ue=window.localStorage[T].split(",#");ue.length>1&&(delete window.localStorage[T],t.each(ue,function(de,Se){En(Se)}))}catch{}try{E=window.localStorage[T].split(";")}catch{}}}function st(ue){C.includePatternsInPalette||(ue=ue.filter(function(de){return!Ue(de)}));for(let de of ue)En(de)}function En(ue){if(G){if(Ue(ue)){if(!m.includes(ue)&&t.inArray(ue,E)===-1)for(E.push(ue);E.length>z;)E.shift()}else{var de=tinycolor(ue).toRgbString();if(!J[de]&&t.inArray(de,E)===-1)for(E.push(de);E.length>z;)E.shift()}if(T&&window.localStorage)try{window.localStorage[T]=E.join(";")}catch{}}}function Ds(){var ue=[];if(C.showPalette)for(var de=0;de<E.length;de++){var Se=E[de];if(Ue(Se))m.includes(Se)||ue.push(Se);else{var he=tinycolor(Se).toRgbString();J[he]||ue.push(Se)}}return ue.reverse().slice(0,C.maxSelectionSize)}function Ms(){var ue=rt.map(function(Se,he){return ka(Se,"sp-palette-row sp-palette-row-"+he,C.includePatternsInPalette)});Os(),E&&ue.push(ka(Ds(),"sp-palette-row sp-palette-row-selection",C.includePatternsInPalette)),se.html(ue.join(""));var de=$r(Je);le.html(de.join(""))}function Ki(){(b<=0||Q<=0||O<=0)&&dn(),M=!0,D.addClass(X),K=null,Z.trigger("dragstart.spectrum",[vt()])}function Nr(){M=!1,D.removeClass(X),Z.trigger("dragstop.spectrum",[vt()])}function ni(){var ue=N.val();if((ue===null||ue==="")&&Ze)Ln(null),si(!0);else{var de=tinycolor(ue);de.isValid()?(de=C.showAlpha?de.toHex8():de.toHex(),Ln(de),si(!0),un()):(N.addClass("sp-validation-error"),ha.removeClass("sp-hidden"))}}function Mn(){q?un():Yi()}function Yi(){var ue=t.Event("beforeShow.spectrum");if(q){dn();return}Z.trigger(ue,[vt()]),!(f.beforeShow(vt())===!1||ue.isDefaultPrevented())&&(l(),q=!0,t(H).on("keydown.spectrum",xr),t(H).on("click.spectrum",ii),t(window).on("resize.spectrum",I),_t.addClass("sp-active"),D.removeClass("sp-hidden"),dn(),Kt(),ti=vt(),f.show(ti),Z.trigger("show.spectrum",[ti]),D.find(".sp-has-pattern.sp-thumb-active").each(function(){var de=t(this),Se=de.hasClass("sp-thumb-dark")?j:A,he=de.find("span"),$e=he.css("background-image");he.css("background-image",`${Se}, ${$e}`)}))}function xr(ue){ue.keyCode===27&&un()}function ii(ue){ue.button!=2&&(M||(fa?si(!0):Or(),t(".fillpicker-palette-context-menu").is(":visible")||un()))}function un(){!q||B||(q=!1,ha.addClass("sp-hidden"),t(H).unbind("keydown.spectrum",xr),t(H).unbind("click.spectrum",ii),t(window).unbind("resize.spectrum",I),_t.removeClass("sp-active"),D.addClass("sp-hidden"),f.hide(vt()),Z.trigger("hide.spectrum",[vt()]))}function Or(){Ln(ti,!0)}function Ln(ue,de){if(Ue(ue))xe=ue,Ae=!0;else{if(tinycolor.equals(ue,vt())){Kt();return}var Se,he;!ue&&Ze?cn=!0:(cn=!1,Se=tinycolor(ue),he=Se.toHsv(),ve=he.h%360/360,Ie=he.s,_e=he.v,pe=he.a),Ae=!1,xe="",Se&&Se.isValid()&&!de&&(Ei=C.preferredFormat||Se.getFormat())}Kt()}function vt(ue){return ue=ue||{},Ze&&cn?null:Ae&&!M?xe:tinycolor.fromRatio({h:ve,s:Ie,v:_e,a:Math.round(pe*100)/100},{format:ue.format||Ei})}function ri(){return!N.hasClass("sp-validation-error")}function qt(){Kt(),f.move(vt()),Z.trigger("move.spectrum",[vt()])}function Kt(){N.removeClass("sp-validation-error"),Ls();var ue=tinycolor.fromRatio({h:ve,s:1,v:1});re.css("background-color",ue.toHexString());var de=Ei;pe<1&&!(pe===0&&de==="name")&&(de==="hex"||de==="hex3"||de==="hex6"||de==="name")&&(de="rgb");var Se=vt({format:de}),he="";if(ln.removeClass("sp-clear-display"),ln.css({"background-color":Ue(Se)?Zt(Se).bg:"transparent","background-image":"none"}),!Ue(Se))if(!Se&&Ze)ln.addClass("sp-clear-display");else{var $e=Se.toHexString(),it=Se.toRgbString();if(s||Se.alpha===1?ln.css("background-color",it):(ln.css("background-color","transparent"),ln.css("filter",Se.toFilter())),ln.length===0&&Z.css("background-color",it),C.showAlpha){var Mr=Se.toRgb();Mr.a=0;var Ci=tinycolor(Mr).toRgbString(),ai="linear-gradient(left, "+Ci+", "+$e+")";r?Ye.css("filter",tinycolor(Ci).toFilter({gradientType:1},$e)):(Ye.css("background","-webkit-"+ai),Ye.css("background","-moz-"+ai),Ye.css("background","-ms-"+ai),Ye.css("background","linear-gradient(to right, "+Ci+", "+$e+")"))}he=Se.toString(de)}C.showInput&&(N.val(he),Je!==e?Je.includes(he)?(Sn.show(),Qn.hide()):(Qn.show(),Sn.hide()):(Qn.hide(),Sn.hide())),C.showPalette&&Ms()}function Ls(){var ue=Ie,de=_e;if(Ze&&cn)U.hide(),Ke.hide(),ae.hide();else{U.show(),Ke.show(),ae.show();var Se=ue*Q,he=b-de*b;Se=Math.max(-W,Math.min(Q-W,Se-W)),he=Math.max(-W,Math.min(b-W,he-W)),ae.css({top:he+"px",left:Se+"px"});var $e=pe*ee;U.css({left:$e-te/2+"px"});var it=ve*O;Ke.css({top:it-ne+"px"})}}function si(ue){var de=vt(),Se="",he=de.toString()!=ti.toString();if(de&&(Se=de.toString(Ei),En(de)),Ue(de)){var $e=Fn(xe);ln.css({"background-repeat":"repeat","background-image":$e})}Pr&&Z.val(Se),ue&&he&&(f.change(de,ti),Z.trigger("change",[de,ti]))}function dn(){!q||(Q=re.width(),b=re.height(),W=ae.height(),R=Te.width(),O=Te.height(),ne=Ke.height(),ee=k.width(),te=U.width(),B||(D.css({position:"absolute","min-height":D.outerHeight()}),C.offset?D.offset(C.offset):D.offset(u(D,ei))),Ls(),C.showPalette&&Ms(),Z.trigger("reflow.spectrum"))}function $s(){Z.show(),ei.unbind("click.spectrum touchstart.spectrum"),D.remove(),_t.remove(),i[oi.id]=null}function pa(ue,de){if(ue===e)return t.extend({},C);if(de===e)return C[ue];C[ue]=de,ue==="preferredFormat"&&(Ei=C.preferredFormat),qi()}function Fs(){ce=!1,Z.attr("disabled",!1),ei.removeClass("sp-disabled")}function Dr(){un(),ce=!0,Z.attr("disabled",!0),ei.addClass("sp-disabled")}function $n(ue){C.offset=ue,dn()}ht();var oi={show:Yi,hide:un,toggle:Mn,reflow:dn,option:pa,enable:Fs,disable:Dr,offset:$n,addColorToSelectionPalette:En,setSelectionPalette:st,set:function(ue){Ln(ue),si()},get:vt,destroy:$s,triggerChange:function(ue,de){f.change(ue,de)},container:D};return oi.id=i.push(oi)-1,oi}function u(P,F){var C=P.outerWidth(),B=P.outerHeight(),G=F.outerHeight(),T=P[0].ownerDocument,L=T.documentElement,f=L.clientWidth+t(T).scrollLeft(),I=L.clientHeight+t(T).scrollTop(),q=F.offset();return q.top+=G,q.left+=F.outerWidth(),q.left-=Math.min(q.left,q.left+C>f&&f>C?Math.abs(q.left+C-f):0),q.top-=Math.min(q.top,q.top+B>I&&I>B?Math.abs(B+G):0),t("body").hasClass("modal-open")&&q.top<t(T).scrollTop()&&t("body").removeClass("modal-open"),q}function d(){}function p(P){P.stopPropagation()}function _(P,F){var C=Array.prototype.slice,B=C.call(arguments,2);return function(){return P.apply(F,B.concat(C.call(arguments)))}}function g(P,F,C,B){F=F||function(){},C=C||function(){},B=B||function(){};var G=document,T=!1,L={},f=0,I=0,q="ontouchstart"in window,M={};M.selectstart=Q,M.dragstart=Q,M["touchmove mousemove"]=b,M["touchend mouseup"]=O;function Q(R){R.stopPropagation&&R.stopPropagation(),R.preventDefault&&R.preventDefault(),R.returnValue=!1}function b(R){if(T){if(r&&G.documentMode<9&&!R.button)return O();var ee=R.originalEvent&&R.originalEvent.touches&&R.originalEvent.touches[0],te=ee&&ee.pageX||R.pageX,ne=ee&&ee.pageY||R.pageY,ve=Math.max(0,Math.min(te-L.left,I)),Ie=Math.max(0,Math.min(ne-L.top,f));q&&Q(R),F.apply(P,[ve,Ie,R])}}function W(R){var ee=R.which?R.which==3:R.button==2;!ee&&!T&&C.apply(P,arguments)!==!1&&(T=!0,f=t(P).height(),I=t(P).width(),L=t(P).offset(),t(G).bind(M),t(G.body).addClass("sp-dragging"),b(R),Q(R))}function O(){T&&(t(G).unbind(M),t(G.body).removeClass("sp-dragging"),setTimeout(function(){B.apply(P,arguments)},0)),T=!1}t(P).bind("touchstart mousedown",W)}function y(P){let F=t(P).spectrum("get").toString(),C=Ue(F)?Zt(F).bg:F,B=Ue(F)?Zt(F).top:"#252525",G=Ue(F)?Zt(F).pType:"diagonal3";t("#bgPatternPicker").spectrum({color:C,showInput:!0,showPalette:!0,palette:ui,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"bgPatternPicker-container",change:function(f){Un(),v()},beforeShow:function(f){t(this).spectrum("setSelectionPalette",Object.keys(mapchart.colors()))},show:function(){for(let f in mapchart.colors())t(`.bgPatternPicker-container .sp-palette-container span.sp-thumb-el[title="${f}"]`).addClass("sp-thumb-active");Un()}}),t("#topPatternPicker").spectrum({color:B,showInput:!0,showPalette:!0,palette:ui,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"topPatternPicker-container",change:function(f){Un(),v()},beforeShow:function(f){t(this).spectrum("setSelectionPalette",Object.keys(mapchart.colors()))},show:function(){for(let f in mapchart.colors())t(`.topPatternPicker-container .sp-palette-container span.sp-thumb-el[title="${f}"]`).addClass("sp-thumb-active");Un()}}),t("#selected-pattern").off("change"),t("#selected-pattern").on("change",function(){Un(),v()}),t("#selected-pattern").val(G),Un(),v(),t("#paint-with-pattern").off("click"),t("#paint-with-pattern").on("click",function(f){Cp(P)});let T=t("#add-pattern-to-palette"),L=t("#remove-pattern-from-palette");T.off("click"),T.on("click",function(f){let I=Ys();Rs(I).then(()=>{T.hide(),L.show().find("i").toggleClass("fa-flip-horizontal")})}),L.off("click"),L.on("click",function(f){let I=Ys();Ns(I).then(()=>{L.hide(),T.show().find("i").toggleClass("fa-flip-horizontal")})}),t(P).spectrum("hide"),t("#patternBuilderModal").modal("show")}function v(){Je!==e?Je.includes(Ys())?(t("#add-pattern-to-palette").hide(),t("#remove-pattern-from-palette").show()):(t("#add-pattern-to-palette").show(),t("#remove-pattern-from-palette").hide()):(t("#add-pattern-to-palette").hide(),t("#remove-pattern-from-palette").hide())}function w(P,F,C){var B;return function(){var G=this,T=arguments,L=function(){B=null,P.apply(G,T)};C&&clearTimeout(B),(C||!B)&&(B=setTimeout(L,F))}}function S(){return t.fn.spectrum.inputTypeColorSupport()}var x="spectrum.id";t.fn.spectrum=function(P,F){if(typeof P=="string"){var C=this,B=Array.prototype.slice.call(arguments,1);return this.each(function(){var G=i[t(this).data(x)];if(G){var T=G[P];if(!T)throw new Error("Spectrum: no such method: '"+P+"'");P=="get"?C=G.get():P=="container"?C=G.container:P=="option"?C=G.option.apply(G,B):P=="destroy"?(G.destroy(),t(this).removeData(x)):T.apply(G,B)}}),C}return this.spectrum("destroy").each(function(){var G=t.extend({},P,t(this).data()),T=h(this,G);t(this).data(x,T.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=g,t.fn.spectrum.defaults=n,t.fn.spectrum.inputTypeColorSupport=function P(){if(typeof P._cachedResult>"u"){var F=t("<input type='color'/>")[0];P._cachedResult=F.type==="color"&&F.value!==""}return P._cachedResult},t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var P=t("input[type=color]");P.length&&!S()&&P.spectrum({preferredFormat:"hex6"})},function(){var P=/^[\s,#]+/,F=/\s+$/,C=0,B=Math,G=B.round,T=B.min,L=B.max,f=B.random,I=function(k,U){if(k=k||"",U=U||{},k instanceof I)return k;if(!(this instanceof I))return new I(k,U);var N=q(k);this._originalInput=k,this._r=N.r,this._g=N.g,this._b=N.b,this._a=N.a,this._roundA=G(100*this._a)/100,this._format=U.format||N.format,this._gradientType=U.gradientType,this._r<1&&(this._r=G(this._r)),this._g<1&&(this._g=G(this._g)),this._b<1&&(this._b=G(this._b)),this._ok=N.ok,this._tc_id=C++};I.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var k=this.toRgb();return(k.r*299+k.g*587+k.b*114)/1e3},setAlpha:function(k){return this._a=X(k),this._roundA=G(100*this._a)/100,this},toHsv:function(){var k=W(this._r,this._g,this._b);return{h:k.h*360,s:k.s,v:k.v,a:this._a}},toHsvString:function(){var k=W(this._r,this._g,this._b),U=G(k.h*360),N=G(k.s*100),se=G(k.v*100);return this._a==1?"hsv("+U+", "+N+"%, "+se+"%)":"hsva("+U+", "+N+"%, "+se+"%, "+this._roundA+")"},toHsl:function(){var k=Q(this._r,this._g,this._b);return{h:k.h*360,s:k.s,l:k.l,a:this._a}},toHslString:function(){var k=Q(this._r,this._g,this._b),U=G(k.h*360),N=G(k.s*100),se=G(k.l*100);return this._a==1?"hsl("+U+", "+N+"%, "+se+"%)":"hsla("+U+", "+N+"%, "+se+"%, "+this._roundA+")"},toHex:function(k){return R(this._r,this._g,this._b,k)},toHexString:function(k){return"#"+this.toHex(k)},toHex8:function(){return ee(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:G(this._r),g:G(this._g),b:G(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+G(this._r)+", "+G(this._g)+", "+G(this._b)+")":"rgba("+G(this._r)+", "+G(this._g)+", "+G(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:G(K(this._r,255)*100)+"%",g:G(K(this._g,255)*100)+"%",b:G(K(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+G(K(this._r,255)*100)+"%, "+G(K(this._g,255)*100)+"%, "+G(K(this._b,255)*100)+"%)":"rgba("+G(K(this._r,255)*100)+"%, "+G(K(this._g,255)*100)+"%, "+G(K(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:E[R(this._r,this._g,this._b,!0)]||!1},toFilter:function(k){var U="#"+ee(this._r,this._g,this._b,this._a),N=U,se=this._gradientType?"GradientType = 1, ":"";if(k){var le=I(k);N=le.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+se+"startColorstr="+U+",endColorstr="+N+")"},toString:function(k){var U=!!k;k=k||this._format;var N=!1,se=this._a<1&&this._a>=0,le=!U&&se&&(k==="hex"||k==="hex6"||k==="hex3"||k==="name");return le?k==="name"&&this._a===0?this.toName():this.toRgbString():(k==="rgb"&&(N=this.toRgbString()),k==="prgb"&&(N=this.toPercentageRgbString()),(k==="hex"||k==="hex6")&&(N=this.toHexString()),k==="hex3"&&(N=this.toHexString(!0)),k==="hex8"&&(N=this.toHex8String()),k==="name"&&(N=this.toName()),k==="hsl"&&(N=this.toHslString()),k==="hsv"&&(N=this.toHsvString()),N||this.toHexString())},_applyModification:function(k,U){var N=k.apply(null,[this].concat([].slice.call(U)));return this._r=N._r,this._g=N._g,this._b=N._b,this.setAlpha(N._a),this},lighten:function(){return this._applyModification(Ie,arguments)},brighten:function(){return this._applyModification(_e,arguments)},darken:function(){return this._applyModification(pe,arguments)},desaturate:function(){return this._applyModification(te,arguments)},saturate:function(){return this._applyModification(ne,arguments)},greyscale:function(){return this._applyModification(ve,arguments)},spin:function(){return this._applyModification(Ae,arguments)},_applyCombination:function(k,U){return k.apply(null,[this].concat([].slice.call(U)))},analogous:function(){return this._applyCombination(J,arguments)},complement:function(){return this._applyCombination(xe,arguments)},monochromatic:function(){return this._applyCombination(j,arguments)},splitcomplement:function(){return this._applyCombination(m,arguments)},triad:function(){return this._applyCombination(qe,arguments)},tetrad:function(){return this._applyCombination(rt,arguments)}},I.fromRatio=function(k,U){if(typeof k=="object"){var N={};for(var se in k)k.hasOwnProperty(se)&&(se==="a"?N[se]=k[se]:N[se]=re(k[se]));k=N}return I(k,U)};function q(k){var U={r:0,g:0,b:0},N=1,se=!1,le=!1;return typeof k=="string"&&(k=Ye(k)),typeof k=="object"&&(k.hasOwnProperty("r")&&k.hasOwnProperty("g")&&k.hasOwnProperty("b")?(U=M(k.r,k.g,k.b),se=!0,le=String(k.r).substr(-1)==="%"?"prgb":"rgb"):k.hasOwnProperty("h")&&k.hasOwnProperty("s")&&k.hasOwnProperty("v")?(k.s=re(k.s),k.v=re(k.v),U=O(k.h,k.s,k.v),se=!0,le="hsv"):k.hasOwnProperty("h")&&k.hasOwnProperty("s")&&k.hasOwnProperty("l")&&(k.s=re(k.s),k.l=re(k.l),U=b(k.h,k.s,k.l),se=!0,le="hsl"),k.hasOwnProperty("a")&&(N=k.a)),N=X(N),{ok:se,format:k.format||le,r:T(255,L(U.r,0)),g:T(255,L(U.g,0)),b:T(255,L(U.b,0)),a:N}}function M(k,U,N){return{r:K(k,255)*255,g:K(U,255)*255,b:K(N,255)*255}}function Q(k,U,N){k=K(k,255),U=K(U,255),N=K(N,255);var se=L(k,U,N),le=T(k,U,N),ye,Pe,Re=(se+le)/2;if(se==le)ye=Pe=0;else{var Ee=se-le;switch(Pe=Re>.5?Ee/(2-se-le):Ee/(se+le),se){case k:ye=(U-N)/Ee+(U<N?6:0);break;case U:ye=(N-k)/Ee+2;break;case N:ye=(k-U)/Ee+4;break}ye/=6}return{h:ye,s:Pe,l:Re}}function b(k,U,N){var se,le,ye;k=K(k,360),U=K(U,100),N=K(N,100);function Pe(et,dt,tt){return tt<0&&(tt+=1),tt>1&&(tt-=1),tt<1/6?et+(dt-et)*6*tt:tt<1/2?dt:tt<2/3?et+(dt-et)*(2/3-tt)*6:et}if(U===0)se=le=ye=N;else{var Re=N<.5?N*(1+U):N+U-N*U,Ee=2*N-Re;se=Pe(Ee,Re,k+1/3),le=Pe(Ee,Re,k),ye=Pe(Ee,Re,k-1/3)}return{r:se*255,g:le*255,b:ye*255}}function W(k,U,N){k=K(k,255),U=K(U,255),N=K(N,255);var se=L(k,U,N),le=T(k,U,N),ye,Pe,Re=se,Ee=se-le;if(Pe=se===0?0:Ee/se,se==le)ye=0;else{switch(se){case k:ye=(U-N)/Ee+(U<N?6:0);break;case U:ye=(N-k)/Ee+2;break;case N:ye=(k-U)/Ee+4;break}ye/=6}return{h:ye,s:Pe,v:Re}}function O(k,U,N){k=K(k,360)*6,U=K(U,100),N=K(N,100);var se=B.floor(k),le=k-se,ye=N*(1-U),Pe=N*(1-le*U),Re=N*(1-(1-le)*U),Ee=se%6,et=[N,Pe,ye,ye,Re,N][Ee],dt=[Re,N,N,Pe,ye,ye][Ee],tt=[ye,ye,Re,N,N,Pe][Ee];return{r:et*255,g:dt*255,b:tt*255}}function R(k,U,N,se){var le=[Y(G(k).toString(16)),Y(G(U).toString(16)),Y(G(N).toString(16))];return se&&le[0].charAt(0)==le[0].charAt(1)&&le[1].charAt(0)==le[1].charAt(1)&&le[2].charAt(0)==le[2].charAt(1)?le[0].charAt(0)+le[1].charAt(0)+le[2].charAt(0):le.join("")}function ee(k,U,N,se){var le=[Y(ae(se)),Y(G(k).toString(16)),Y(G(U).toString(16)),Y(G(N).toString(16))];return le.join("")}I.equals=function(k,U){return!k||!U?!1:I(k).toRgbString()==I(U).toRgbString()},I.random=function(){return I.fromRatio({r:f(),g:f(),b:f()})};function te(k,U){U=U===0?0:U||10;var N=I(k).toHsl();return N.s-=U/100,N.s=H(N.s),I(N)}function ne(k,U){U=U===0?0:U||10;var N=I(k).toHsl();return N.s+=U/100,N.s=H(N.s),I(N)}function ve(k){return I(k).desaturate(100)}function Ie(k,U){U=U===0?0:U||10;var N=I(k).toHsl();return N.l+=U/100,N.l=H(N.l),I(N)}function _e(k,U){U=U===0?0:U||10;var N=I(k).toRgb();return N.r=L(0,T(255,N.r-G(255*-(U/100)))),N.g=L(0,T(255,N.g-G(255*-(U/100)))),N.b=L(0,T(255,N.b-G(255*-(U/100)))),I(N)}function pe(k,U){U=U===0?0:U||10;var N=I(k).toHsl();return N.l-=U/100,N.l=H(N.l),I(N)}function Ae(k,U){var N=I(k).toHsl(),se=(G(N.h)+U)%360;return N.h=se<0?360+se:se,I(N)}function xe(k){var U=I(k).toHsl();return U.h=(U.h+180)%360,I(U)}function qe(k){var U=I(k).toHsl(),N=U.h;return[I(k),I({h:(N+120)%360,s:U.s,l:U.l}),I({h:(N+240)%360,s:U.s,l:U.l})]}function rt(k){var U=I(k).toHsl(),N=U.h;return[I(k),I({h:(N+90)%360,s:U.s,l:U.l}),I({h:(N+180)%360,s:U.s,l:U.l}),I({h:(N+270)%360,s:U.s,l:U.l})]}function m(k){var U=I(k).toHsl(),N=U.h;return[I(k),I({h:(N+72)%360,s:U.s,l:U.l}),I({h:(N+216)%360,s:U.s,l:U.l})]}function J(k,U,N){U=U||6,N=N||30;var se=I(k).toHsl(),le=360/N,ye=[I(k)];for(se.h=(se.h-(le*U>>1)+720)%360;--U;)se.h=(se.h+le)%360,ye.push(I(se));return ye}function j(k,U){U=U||6;for(var N=I(k).toHsv(),se=N.h,le=N.s,ye=N.v,Pe=[],Re=1/U;U--;)Pe.push(I({h:se,s:le,v:ye})),ye=(ye+Re)%1;return Pe}I.mix=function(k,U,N){N=N===0?0:N||50;var se=I(k).toRgb(),le=I(U).toRgb(),ye=N/100,Pe=ye*2-1,Re=le.a-se.a,Ee;Pe*Re==-1?Ee=Pe:Ee=(Pe+Re)/(1+Pe*Re),Ee=(Ee+1)/2;var et=1-Ee,dt={r:le.r*Ee+se.r*et,g:le.g*Ee+se.g*et,b:le.b*Ee+se.b*et,a:le.a*ye+se.a*(1-ye)};return I(dt)},I.readability=function(k,U){var N=I(k),se=I(U),le=N.toRgb(),ye=se.toRgb(),Pe=N.getBrightness(),Re=se.getBrightness(),Ee=Math.max(le.r,ye.r)-Math.min(le.r,ye.r)+Math.max(le.g,ye.g)-Math.min(le.g,ye.g)+Math.max(le.b,ye.b)-Math.min(le.b,ye.b);return{brightness:Math.abs(Pe-Re),color:Ee}},I.isReadable=function(k,U){var N=I.readability(k,U);return N.brightness>125&&N.color>500},I.mostReadable=function(k,U){for(var N=null,se=0,le=!1,ye=0;ye<U.length;ye++){var Pe=I.readability(k,U[ye]),Re=Pe.brightness>125&&Pe.color>500,Ee=3*(Pe.brightness/125)+Pe.color/500;(Re&&!le||Re&&le&&Ee>se||!Re&&!le&&Ee>se)&&(le=Re,se=Ee,N=I(U[ye]))}return N};var A=I.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},E=I.hexNames=z(A);function z(k){var U={};for(var N in k)k.hasOwnProperty(N)&&(U[k[N]]=N);return U}function X(k){return k=parseFloat(k),(isNaN(k)||k<0||k>1)&&(k=1),k}function K(k,U){ce(k)&&(k="100%");var N=D(k);return k=T(U,L(0,parseFloat(k))),N&&(k=parseInt(k*U,10)/100),B.abs(k-U)<1e-6?1:k%U/parseFloat(U)}function H(k){return T(1,L(0,k))}function Z(k){return parseInt(k,16)}function ce(k){return typeof k=="string"&&k.indexOf(".")!=-1&&parseFloat(k)===1}function D(k){return typeof k=="string"&&k.indexOf("%")!=-1}function Y(k){return k.length==1?"0"+k:""+k}function re(k){return k<=1&&(k=k*100+"%"),k}function ae(k){return Math.round(parseFloat(k)*255).toString(16)}function Te(k){return Z(k)/255}var Ke=function(){var k="[-\\+]?\\d+%?",U="[-\\+]?\\d*\\.\\d+%?",N="(?:"+U+")|(?:"+k+")",se="[\\s|\\(]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")\\s*\\)?",le="[\\s|\\(]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")[,|\\s]+("+N+")\\s*\\)?";return{rgb:new RegExp("rgb"+se),rgba:new RegExp("rgba"+le),hsl:new RegExp("hsl"+se),hsla:new RegExp("hsla"+le),hsv:new RegExp("hsv"+se),hsva:new RegExp("hsva"+le),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Ye(k){k=k.replace(P,"").replace(F,"").toLowerCase();var U=!1;if(A[k])k=A[k],U=!0;else if(k=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var N;return(N=Ke.rgb.exec(k))?{r:N[1],g:N[2],b:N[3]}:(N=Ke.rgba.exec(k))?{r:N[1],g:N[2],b:N[3],a:N[4]}:(N=Ke.hsl.exec(k))?{h:N[1],s:N[2],l:N[3]}:(N=Ke.hsla.exec(k))?{h:N[1],s:N[2],l:N[3],a:N[4]}:(N=Ke.hsv.exec(k))?{h:N[1],s:N[2],v:N[3]}:(N=Ke.hsva.exec(k))?{h:N[1],s:N[2],v:N[3],a:N[4]}:(N=Ke.hex8.exec(k))?{a:Te(N[1]),r:Z(N[2]),g:Z(N[3]),b:Z(N[4]),format:U?"name":"hex8"}:(N=Ke.hex6.exec(k))?{r:Z(N[1]),g:Z(N[2]),b:Z(N[3]),format:U?"name":"hex"}:(N=Ke.hex3.exec(k))?{r:Z(N[1]+""+N[1]),g:Z(N[2]+""+N[2]),b:Z(N[3]+""+N[3]),format:U?"name":"hex"}:!1}window.tinycolor=I}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})})(jQuery);(function(t){var e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in window.document||window.document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice,r,s;if(t.event.fixHooks)for(var o=e.length;o;)t.event.fixHooks[e[--o]]=t.event.mouseHooks;var a=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var u=n.length;u;)this.addEventListener(n[--u],l,!1);else this.onmousewheel=l;t.data(this,"mousewheel-line-height",a.getLineHeight(this)),t.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var u=n.length;u;)this.removeEventListener(n[--u],l,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(u){var d=t(u),p=d["offsetParent"in t.fn?"offsetParent":"parent"]();return p.length||(p=t("body")),parseInt(p.css("fontSize"),10)||parseInt(d.css("fontSize"),10)||16},getPageHeight:function(u){return t(u).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(u){return u?this.on("mousewheel",u):this.trigger("mousewheel")},unmousewheel:function(u){return this.off("mousewheel",u)}});function l(u){var d=u||window.event,p=i.call(arguments,1),_=0,g=0,y=0,v=0;if(u=t.event.fix(d),u.type="mousewheel","detail"in d&&(y=d.detail*-1),"wheelDelta"in d&&(y=d.wheelDelta),"wheelDeltaY"in d&&(y=d.wheelDeltaY),"wheelDeltaX"in d&&(g=d.wheelDeltaX*-1),"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(g=y*-1,y=0),_=y===0?g:y,"deltaY"in d&&(y=d.deltaY*-1,_=y),"deltaX"in d&&(g=d.deltaX,y===0&&(_=g*-1)),!(y===0&&g===0)){if(d.deltaMode===1){var w=t.data(this,"mousewheel-line-height");_*=w,y*=w,g*=w}else if(d.deltaMode===2){var S=t.data(this,"mousewheel-page-height");_*=S,y*=S,g*=S}if(v=Math.max(Math.abs(y),Math.abs(g)),(!s||v<s)&&(s=v,h(d,v)&&(s/=40)),h(d,v)&&(_/=40,g/=40,y/=40),_=Math[_>=1?"floor":"ceil"](_/s),g=Math[g>=1?"floor":"ceil"](g/s),y=Math[y>=1?"floor":"ceil"](y/s),a.settings.normalizeOffset&&this.getBoundingClientRect){var x=this.getBoundingClientRect();u.offsetX=u.clientX-x.left,u.offsetY=u.clientY-x.top}return u.deltaX=g,u.deltaY=y,u.deltaFactor=s,u.deltaMode=0,p.unshift(u,_,g,y),r&&window.clearTimeout(r),r=window.setTimeout(c,200),(t.event.dispatch||t.event.handle).apply(this,p)}}function c(){s=null}function h(u,d){return a.settings.adjustOldDeltas&&u.type==="mousewheel"&&d%120===0}})(jQuery);(function(t){"use strict";t.SvgZoomer=function(e,n){let i={panEnabled:!0,zoomEnabled:!0,dblClickZoomEnabled:!0,mouseWheelZoomEnabled:!0,preventMouseEventsDefault:!0,zoomScaleSensitivity:1.05,maxZoomLevel:null,adjustStrokeWidths:!1,afterZoomIn:null,afterZoomOut:null,beforeZoomIn:null,beforeZoomOut:null,beforePan:null,onPan:null,afterPan:null,isNestedSVG:!1},r=this;r.options={};let s,o=function(){r.state="none",r.isActive=!0,r.svg=e[0],r.$svg=t(r.svg),r.$paths=r.$svg.children("path"),r.container=r.$svg.parent().parent(),gsap.registerPlugin(Draggable),r.proxy=document.createElement("div"),r.startClient=r.svg.createSVGPoint(),r.startGlobal=r.svg.createSVGPoint(),r.point=r.svg.createSVGPoint(),r.options=t.extend({},i,n),r.currentVB=r.svg.getAttribute("viewBox"),r.$svg.attr("data-originalVB")||r.$svg.attr("data-originalVB",r.currentVB),r.originalVB=r.$svg.attr("data-originalVB"),r.options.adjustStrokeWidths&&r.$paths.each(function(){let W=parseFloat(t(this).attr("stroke-width"))||parseFloat(t(this).css("stroke-width"));t(this).attr("data-originalStrokeWidth")||t(this).attr("data-originalStrokeWidth",W)});let b;r.options.isNestedSVG?(r.parentSVG=r.svg.parentElement,b=q(r.parentSVG)):b=q(r.svg),r.width=b.width,r.height=b.height,r.baseRect=document.createElementNS("http://www.w3.org/2000/svg","rect"),r.baseRect.setAttribute("id","baseRect"),r.baseRect.setAttribute("width",r.width),r.baseRect.setAttribute("height",r.height),r.baseRect.setAttribute("fill","transparent"),r.$svg.prepend(t(r.baseRect)),document.addEventListener("keydown",d),a(),P()},a=function(){r.options.isNestedSVG?r.parentSVG.addEventListener("dblclick",u,!1):r.svg.addEventListener("dblclick",u,!1),r.pannable=new Draggable(r.proxy,{trigger:r.parentSVG,onDrag:c,onDragStart:l,onDragEnd:h,allowContextMenu:!0}),r.options.mouseWheelZoomEnabled&&(r.options.mouseWheelZoomEnabled=!1,p())};function l(b){r.state="pan",r.options.onPan&&r.options.onPan(),s&&s.isActive&&s.kill(),r.startClient.x=this.pointerX,r.startClient.y=this.pointerY,r.startGlobal=r.startClient.matrixTransform(r.baseRect.getScreenCTM().inverse()),gsap.from(r.proxy,{x:this.pointerX,y:this.pointerY}),r.pannable.enable().update().startDrag(b)}function c(){r.point.x=this.x,r.point.y=this.y;let b=r.point.matrixTransform(r.baseRect.getScreenCTM().inverse()),W=r.svg.viewBox.baseVal;W.x-=b.x-r.startGlobal.x,W.y-=b.y-r.startGlobal.y;let O=I(W.x,W.y,W.width,W.height);r.currentVB=O}let h=function(){r.state==="pan"&&(r.state="none",r.options.afterPan&&r.options.afterPan())},u=function(b){r.options.preventMouseEventsDefault&&(b.preventDefault?b.preventDefault():b.returnValue=!1);let W=b.shiftKey?r.options.zoomScaleSensitivity+.1:1/r.options.zoomScaleSensitivity-.1,O=M(b);y(O,W)},d=function(b){t("input").is(":focus")||(b.which==73&&w(),b.which==79&&S(),b.which==87&&x("up"),b.which==83&&x("down"),b.which==65&&x("left"),b.which==68&&x("right"),b.which==27&&r.stop())},p=function(){r.options.mouseWheelZoomEnabled||(r.options.isNestedSVG?t(r.parentSVG).mousewheel(function(b){return g(b)}):t(r.svg).mousewheel(function(b){return g(b)}),r.options.mouseWheelZoomEnabled=!0)},_=function(){r.options.mouseWheelZoomEnabled&&(r.options.isNestedSVG?t(r.parentSVG).unmousewheel():t(r.svg).unmousewheel(),r.options.mouseWheelZoomEnabled=!1)},g=function(b){if(!r.options.zoomEnabled||r.state!=="none")return;r.options.preventMouseEventsDefault&&(b.preventDefault?b.preventDefault():b.returnValue=!1);let W,O=b.wheelDelta;O?W=O%120==0?O/120:O/12:(O=b.deltaY||b.detail||0,W=O%3?O*10:O/3);let R=W>0?1/r.options.zoomScaleSensitivity:r.options.zoomScaleSensitivity,ee=M(b);y(ee,R)},y=function(b,W){if(W>1)r.options.beforeZoomOut&&r.options.beforeZoomOut();else{if(r.options.maxZoomLevel&&r.getZoomLevel()>r.options.maxZoomLevel)return;r.options.beforeZoomIn&&r.options.beforeZoomIn()}let O=r.svg.viewBox.baseVal,R=O.x-(b.x-O.x)*(W-1),ee=O.y-(b.y-O.y)*(W-1),te=O.width*W,ne=O.height*W,ve=I(R,ee,te,ne);s=gsap.to(r.svg,{duration:.1,attr:{viewBox:ve}}),r.currentVB=ve,r.options.adjustStrokeWidths&&v(W),W>1?r.options.afterZoomOut&&r.options.afterZoomOut():r.options.afterZoomIn&&r.options.afterZoomIn()},v=function(b){let O=Math.log(r.options.maxZoomLevel-1)/Math.log(r.options.zoomScaleSensitivity);r.$paths.each(function(){let R=parseFloat(t(this).attr("stroke-width"))||parseFloat(t(this).css("stroke-width")),ee=parseFloat(t(this).attr("data-originalStrokeWidth")),te=parseFloat(((ee-.01)/O).toFixed(4));b<1&&(te=-te),!(R+te<.01)&&(R+te>ee||t(this).attr("stroke-width",R+te).css("stroke-width",R+te))})},w=function(){let b=1/r.options.zoomScaleSensitivity,W=Q();y(W,b)},S=function(){let b=r.options.zoomScaleSensitivity,W=Q();y(W,b)},x=function(b){let W=f(r.currentVB),O,R,ee;switch(b){case"up":ee=60/(r.height/W[3]),O=I(W[0],W[1]+ee,W[2],W[3]);break;case"down":ee=60/(r.height/W[3]),O=I(W[0],W[1]-ee,W[2],W[3]);break;case"left":R=60/(r.width/W[2]),O=I(W[0]+R,W[1],W[2],W[3]);break;case"right":R=60/(r.width/W[2]),O=I(W[0]-R,W[1],W[2],W[3]);break}gsap.to(r.svg,.2,{ease:Power2.easeOut,attr:{viewBox:O}}),r.currentVB=O,r.options.onPan?r.options.onPan():r.options.afterPan&&r.options.afterPan()},P=function(){let b=t('<div class="svgzoomer-controls"></div>');b.append(T()),b.append(L()),b.append(F()),b.append(C()),b.append(B()),b.append(G()),b.appendTo(r.container),r.controlIcons=b},F=function(){let b=t('<div id="svgzoomer-d-up" class="svg-zoomer-d-pad">&#9650;</div>');return b.on("click",function(){x("up")}),b.on("touchstart",function(){x("up")}),b},C=function(){let b=t('<div id="svgzoomer-d-down" class="svg-zoomer-d-pad">&#9660;</div>');return b.on("click",function(){x("down")}),b.on("touchstart",function(){x("down")}),b},B=function(){let b=t('<div id="svgzoomer-d-left" class="svg-zoomer-d-pad">&#9668;</div>');return b.on("click",function(){x("left")}),b.on("touchstart",function(){x("left")}),b},G=function(){let b=t('<div id="svgzoomer-d-right" class="svg-zoomer-d-pad">&#9658;</div>');return b.on("click",function(){x("right")}),b.on("touchstart",function(){x("right")}),b},T=function(){let b=t('<div id="svgzoomer-zoom-in" class="svg-zoomer-zoom-control">+</div>');return b.on("click",function(){w()}),b.on("touchstart",function(){w()}),b},L=function(){let b=t('<div id="svgzoomer-zoom-out" class="svg-zoomer-zoom-control">-</div>');return b.on("click",function(){S()}),b.on("touchstart",function(){S()}),b};r.reset=function(){r.pannable.tween&&r.pannable.tween.kill(),gsap.to(r.svg,{duration:.8,attr:{viewBox:t(r.svg).attr("data-originalVB")}}),r.$paths.each(function(){let b=t(this).attr("data-originalStrokeWidth");t(this).attr("stroke-width",b).css("stroke-width",b)}),r.stop()},r.stop=function(){r.state="none",r.isActive=!1,r.options.isNestedSVG?r.parentSVG.removeEventListener("dblclick",u,!1):r.svg.removeEventListener("dblclick",u,!1),r.pannable.disable(),document.removeEventListener("keydown",d),r.baseRect.remove(),_(),r.controlIcons.remove(),delete r.options},r.getZoomLevel=function(){return parseFloat((f(r.originalVB)[2]/f(r.currentVB)[2]).toFixed(2))},r.getZoomScaleSensitivity=function(){return r.options.zoomScaleSensitivity};let f=function(b){return b.split(" ").map(function(W){return parseFloat(W)})},I=function(b,W,O,R){return[b,W,O,R].join(" ")},q=function(b){if(b.clientWidth&&b.clientHeight)return{width:b.clientWidth,height:b.clientHeight};if(b.getBoundingClientRect())return b.getBoundingClientRect();throw new Error("Cannot get BoundingClientRect for SVG.")},M=function(b){let W=r.svg.createSVGPoint();return W.x=b.clientX,W.y=b.clientY,W.matrixTransform(r.svg.getScreenCTM().inverse())},Q=function(){let b=r.svg.createSVGPoint();return b.x=r.width/2,b.y=r.height/2,b.matrixTransform(r.svg.getScreenCTM().inverse())};o()},t.fn.SvgZoomer=function(e){return this.each(function(){if(t(this).data("SvgZoomer")===void 0){let n=new t.SvgZoomer(this,e);t(this).data("SvgZoomer",n)}})}})(jQuery);var Zy={pages:{"404":{pageDescription:"Create your own free custom Map of World, Europe, United States and others in 3 easy steps. Download it for free and use it for a great visual representation.",pageName:"404",pageSlug:"404",site:"mapchart"},account:{pageDescription:"Your MapChart Premium account.",pageName:"Account",pageSlug:"account",pageSpecificJS:!0,site:"mapchart"},"account-actions":{pageDescription:"Manage user account actions for MapChart Premium users",pageName:"Account Actions",pageSlug:"account-actions",pageSpecificJS:!0,site:"mapchart"},africa:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of Africa. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Africa",pageSlug:"africa",site:"mapchart",subdivision:["country","countries"]},"africa-detailed":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Africa's subdivisions. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Africa - Detailed",pageSlug:"africa-detailed",site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},americas:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0,zoom:!0},pageDescription:"Create your own custom map of the Americas (North and South). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"The Americas",pageSlug:"americas",pageSpecificJS:!0,site:"mapchart",subdivision:["country","countries"],subheading:!0},"americas-detailed":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of the American subdivisions. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"The Americas - Detailed",pageSlug:"americas-detailed",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},argentina:{has:{zoom:!0},pageDescription:"Create your own custom map of Argentina. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Argentina",pageSlug:"argentina",site:"mapchart",subdivision:["department","departments"],subheading:!0},asia:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of Asia. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Asia",pageSlug:"asia",site:"mapchart",subdivision:["country","countries"]},"asia-detailed":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Asia's subdivisions. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Asia - Detailed",pageSlug:"asia-detailed",site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},australia:{pageDescription:"Create your own custom map of Australian States. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Australia",pageSlug:"australia",site:"mapchart",subdivision:["state","states"]},"australia-electoral-divisions":{has:{header:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Australia's Electoral Divisions (election map). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Australia - Electoral Divisions (elections)",pageSlug:"australia-electoral-divisions",site:"mapchart",subdivision:["electoral division","electoral divisions"],wideLayout:!0},belgium:{pageDescription:"Create your own custom map of Belgium's municipalities. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Belgium",pageSlug:"belgium",site:"mapchart",subdivision:["municipality","municipalities"],subheading:!0},beta:{pageDescription:"Enroll in MapChart's beta program to test the latest features.",pageName:"Beta",pageSlug:"beta",site:"mapchart"},brazil:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of Brazil. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Brazil",pageSlug:"brazil",site:"mapchart",subdivision:["state","states"],subheading:!0},"brazil-municipalities":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Brazil's municipalities. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Brazil - Municipalities (munic\xEDpios)",pageSlug:"brazil-municipalities",site:"mapchart",subdivision:["municipality","municipalities"],subdivisionGroup:["state","states"],wideLayout:!0},"browser-themes":{pageDescription:"Try out one of these special, MapChart-style themes for your browser!",pageName:"Themes",pageSlug:"browser-themes",pageSpecificJS:!0,site:"mapchart"},canada:{has:{labels:!0},pageDescription:"Create your own custom map of Canada. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Canada",pageSlug:"canada",site:"mapchart",subdivision:["state","states"]},"canada-census-divisions":{has:{colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Canada's census divisions. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Canada - Census Divisions",pageSlug:"canada-census-divisions",site:"mapchart",subdivision:["census division","census divisions"],subdivisionGroup:["province/territory","provinces/territories"],wideLayout:!0},"canada-federal-ridings":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Canada's Federal Ridings (election map). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Canada - Federal Ridings (elections)",site:"mapchart",subdivision:["federal riding","federal ridings"],wideLayout:!0},caribbean:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0,zoom:!0},pageDescription:"Create your own custom map of the Caribbean. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"The Caribbean",pageSlug:"caribbean",site:"mapchart",subdivision:["country","countries"]},changelog:{pageDescription:"Changelog of the mapchart.net and historicalmapchart.net websites.",pageName:"Changelog",pageSlug:"changelog",site:"mapchart"},china:{has:{labels:!0},pageDescription:"Create your own custom map of China. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"China",pageSlug:"china",site:"mapchart",subdivision:["region","regions"]},coronavirus:{has:{zoom:!0},pageDescription:"Use the coronavirus (COVID-19) daily statistics map from MapChart to visualize the latest available pandemic data on a World map and download it for free.",pageName:"Coronavirus (COVID-19) Daily Statistics Map",pageSlug:"coronavirus",site:"mapchart"},detworld:{ads:{bottomRectangle:!0,topBanner:!0},has:{colorRegion:!0,header:!0,labels:!0,zoom:!0},pageDescription:"Create your own custom World map with all countries, including microstates. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"World Map - with Microstates",pageSlug:"detworld",pageSpecificJS:!0,site:"mapchart",subdivision:["country","countries"],subdivisionGroup:["region","regions"],wideLayout:!0},europe:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of Europe. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Europe",pageSlug:"europe",site:"mapchart",subdivision:["country","countries"]},"europe-detailed":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of all subdivisions in Europe. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Europe - Detailed",pageSlug:"europe-detailed",site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},"europe-nuts2":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of all NUTS2 statistical regions of the European Union. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Europe - NUTS2",pageSlug:"europe-nuts2",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},"europe-nuts3":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of all NUTS3 statistical regions of the European Union. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Europe - NUTS3",pageSlug:"europe-nuts3",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},"europe-world-war-1":{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom historical map of Europe at the start of World War I (1914). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Europe - World War I",pageSlug:"europe-world-war-1",site:"historicalmapchart",subdivision:["country","countries"],subheading:!0},"europe-world-war-2":{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom historical map of Europe at the start of World War II (1939). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Europe - World War II",pageSlug:"europe-world-war-2",site:"historicalmapchart",subdivision:["country","countries"],subheading:!0},feedback:{pageDescription:"Contact MapChart, the online map making tool, for any feature recommendation or bug report.",pageName:"Feedback",pageSlug:"feedback",site:"mapchart"},"feedback-historical":{pageDescription:"Contact Historical MapChart, the online map making tool, for any feature recommendation or bug report.",pageName:"Feedback",pageSlug:"feedback",site:"historicalmapchart"},france:{has:{labels:!0},pageDescription:"Create your own custom map of France. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"France",pageSlug:"france",site:"mapchart",subdivision:["region","regions"]},"france-departments":{has:{header:!0,zoom:!0},pageDescription:"Create your own custom map of French Departments. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"France - Departments",pageSlug:"france-departments",pageSpecificJS:!0,site:"mapchart",subdivision:["department","departments"],wideLayout:!0},germany:{has:{labels:!0},pageDescription:"Create your own custom map of Germany. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Germany",pageSlug:"germany",site:"mapchart",subdivision:["state","states"]},"germany-districts":{has:{header:!0,searchBySubdivision:!0},pageDescription:"Create your own custom map of Germany's Districts/Kreise/Landkreise. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Germany - Districts",pageSlug:"germany-districts",site:"mapchart",subdivision:["district","districts"],wideLayout:!0},greece:{pageDescription:"Create your own custom map of Greece. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Greece",pageSlug:"greece",site:"mapchart",subdivision:["prefecture","prefectures"]},"hearts-of-iron-iv":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,notes:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom Hearts of Iron IV map. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Hearts of Iron IV",pageSlug:"hearts-of-iron-iv",site:"mapchart",subdivision:["state","states"],wideLayout:!0},index:{pageDescription:"Make your own custom map of the World, United States, Europe, and 50+ different maps. Color an editable map and download it for free to use in your project.",pageName:"Create Custom Map",pageSlug:"index",site:"mapchart"},"index-historical":{pageDescription:"Make your own custom historical map of the World, United States or Europe. Color an editable map and download it for free to use in your project.",pageName:"Create Custom Historical Map",pageSlug:"index",site:"historicalmapchart"},india:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of Indian states. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"India",pageSlug:"india",pageSpecificJS:!0,site:"mapchart",subdivision:["state","states"]},indonesia:{has:{header:!0,zoom:!0},pageDescription:"Create your own custom map of Indonesia. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Indonesia",pageSlug:"indonesia",site:"mapchart",subdivision:["regency/city","regencies/cities"],wideLayout:!0},italy:{has:{labels:!0},pageDescription:"Create your own custom map of Italy. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Italy",pageSlug:"italy",site:"mapchart",subdivision:["province","provinces"],subheading:!0},japan:{has:{labels:!0},pageDescription:"Create your own custom map of Japan. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Japan",pageSlug:"japan",site:"mapchart",subdivision:["prefecture","prefectures"]},login:{pageDescription:"Log in to your MapChart Premium account.",pageName:"Log in",pageSlug:"login",site:"mapchart"},mexico:{has:{labels:!0},pageDescription:"Create your own custom map of Mexico. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Mexico",pageSlug:"mexico",site:"mapchart",subdivision:["state","states"]},"middle-east":{has:{labels:!0},pageDescription:"Create your own custom map of the Middle East. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Middle East",pageSlug:"middle-east",pageSpecificJS:!0,site:"mapchart",subdivision:["country","countries"]},"my-maps":{pageDescription:"Check, edit, or delete your saved map configurations.",pageName:"My maps",pageSlug:"my-maps",pageSpecificJS:!0,site:"mapchart"},"my-palette":{pageDescription:"Check, edit, or delete your saved palette colors.",pageName:"My palette",pageSlug:"my-palette",pageSpecificJS:!0,site:"mapchart"},netherlands:{pageDescription:"Create your own custom map of Netherlands municipalities. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Netherlands",pageSlug:"netherlands",site:"mapchart",subdivision:["municipality","municipalities"],subheading:!0},"oceania-detailed":{has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,labels:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of all subdivisions of Oceania. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Oceania - Detailed",pageSlug:"oceania-detailed",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0},poland:{pageDescription:"Create your own custom map of Poland's counties (powiats). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Poland",pageSlug:"poland",site:"mapchart",subdivision:["powiat","powiats"],subheading:!0},portugal:{pageDescription:"Create your own custom map of Portugal. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Portugal",pageSlug:"portugal",site:"mapchart",subdivision:["municipality","municipalities"],subheading:!0},premium:{pageDescription:"Get the MapChart Premium version.",pageName:"Premium",pageSlug:"premium",pageSpecificJS:!0,site:"mapchart"},"privacy-policy":{pageDescription:"Privacy policy for MapChart.",pageName:"Privacy Policy",pageSlug:"privacy-policy",site:"mapchart"},"privacy-policy-historical":{pageDescription:"Privacy policy for Historical MapChart.",pageName:"Privacy Policy",pageSlug:"privacy-policy",site:"historicalmapchart"},russia:{has:{header:!0,labels:!0},pageDescription:"Create your own custom map of Russia. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Russia",pageSlug:"russia",pageSpecificJS:!0,site:"mapchart",subdivision:["state","states"],wideLayout:!0},shapes:{pageDescription:"Testing page",pageName:"shapes",pageSlug:"shapes",site:"mapchart",subdivision:["country","countries"]},showcase:{pageDescription:"Showcase of various maps created with MapChart.",pageName:"Showcase",pageSlug:"showcase",site:"mapchart"},spain:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of Spain. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Spain",pageSlug:"spain",pageSpecificJS:!0,site:"mapchart",subdivision:["province","provinces"],subheading:!0},sweden:{has:{labels:!0,zoom:!0},pageDescription:"Create your own custom map of Sweden. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Sweden",pageSlug:"sweden",site:"mapchart",subdivision:["province","provinces"],subheading:!0},tamriel:{has:{header:!0,zoom:!0},pageDescription:"Create your own custom map of Tamriel from the Elder Scrolls series. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Tamriel",pageSlug:"tamriel",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],wideLayout:!0},terms:{pageDescription:"Terms of Use for MapChart.",pageName:"Terms of Use",pageSlug:"terms",site:"mapchart"},"terms-historical":{pageDescription:"Terms of Use for Historical MapChart.",pageName:"Terms of Use",pageSlug:"terms",site:"historicalmapchart"},turkey:{has:{header:!0,labels:!0},pageDescription:"Create your own custom map of Turkey. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Turkey",pageSlug:"turkey",pageSpecificJS:!0,site:"mapchart",subdivision:["province","provinces"],wideLayout:!0},tutorial:{pageDescription:"The official Tutorial page for creating maps on MapChart. Guides, tips, and videos how to use the map making tools of MapChart.",pageName:"Tutorial",pageSlug:"tutorial",pageSpecificJS:!0,site:"mapchart"},"tutorial-premium":{pageDescription:"The official Tutorial page for the Premium features on MapChart. Guides, tips, and videos how to use the map making tools of MapChart.",pageName:"Tutorial - Premium",pageSlug:"tutorial-premium",pageSpecificJS:!0,site:"mapchart"},uk:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of the United Kingdom and Ireland's counties (Ceremonial/Preserved/Lieutenancy areas). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United Kingdom & Ireland - Counties",pageSlug:"uk",pageSpecificJS:!0,site:"mapchart",subdivision:["county","counties"],subheading:!0},"uk-election":{has:{searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom election map for the United Kingdom. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United Kingdom - Election Map",pageSlug:"uk-election",site:"mapchart",subdivision:["subdivision","subdivisions"],subheading:!0},"uk-historic":{has:{searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of the United Kingdom historic counties. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United Kingdom & Ireland - Historic counties",pageSlug:"uk-historic",pageSpecificJS:!0,site:"mapchart",subdivision:["county","counties"],subheading:!0},"uk-postcodes":{has:{labels:!0,zoom:!0},pageDescription:"Create your own custom map of the United Kingdom's postcode areas. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United Kingdom - Postcode Areas",pageSlug:"uk-postcodes",site:"mapchart",subdivision:["postcode area","postcode areas"],subheading:!0},ukraine:{has:{searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of Ukraine's oblasts (regions), raions (districts), and hromadas (communities). Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"Ukraine",pageSlug:"ukraine",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],subheading:!0},usa:{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of US States. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United States",pageSlug:"usa",pageSpecificJS:!0,site:"mapchart",subdivision:["state","states"]},"usa-and-canada":{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0},pageDescription:"Create your own custom map of US States and Canada's provinces. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United States & Canada",pageSlug:"usa-and-canada",pageSpecificJS:!0,site:"mapchart",subdivision:["state","states"]},"usa-congressional-districts":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom map of the United States Congressional Districts. Color an editable map, fill in the legend, and download it for free to use in your project or election predictions.",pageName:"United States - Congressional Districts",pageSlug:"usa-congressional-districts",pageSpecificJS:!0,site:"mapchart",subdivision:["district","districts"],subdivisionGroup:["state","states"],wideLayout:!0},"usa-counties":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create a custom map of US Counties. Color an editable map, fill in the legend, and download it for free. Make a county map for each state or your own US travel map.",pageName:"United States - Counties",pageSlug:"usa-counties",pageSpecificJS:!0,site:"mapchart",subdivision:["county","counties"],subdivisionGroup:["state","states"],wideLayout:!0},"usa-hex-cartogram":{ads:{bottomBanner:!0,topBanner:!0},has:{labels:!0,notes:!0},pageDescription:"Create your own custom hexagonal cartogram map for the upcoming US Elections. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"United States Electoral College Cartogram",pageSlug:"usa-hex-cartogram",pageSpecificCSS:!0,pageSpecificJS:!0,site:"mapchart",subdivision:["state","states"],subheading:!0},"usa-historical":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,zoom:!0},pageDescription:"Create your own custom historical map of the United States from 1790 to this day. Color an editable map, fill in the legend, and download it for free. Explore the territorial evolution of the United States on a map.",pageName:"USA Historical Map",pageSlug:"usa-historical",pageSpecificCSS:!0,pageSpecificJS:!0,site:"historicalmapchart",subdivision:["state","states"],wideLayout:!0},wargames:{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,zoom:!0},pageDescription:"Create a custom World map to use in alternate history scenarios or map games. Color an editable map, fill in the legend, and download it for free.",pageName:"\u2694\uFE0F World Map - War Games",pageSlug:"wargames",site:"mapchart",subdivision:["area","areas"],subdivisionGroup:["country","countries"],wideLayout:!0},welcome:{pageDescription:"Welcome to MapChart Premium!",pageName:"Welcome",pageSlug:"welcome",pageSpecificJS:!0,site:"mapchart"},westeros:{ads:{topBanner:!0},has:{zoom:!0},pageDescription:"Create a custom fantasy map of Westeros from A Song of Ice and Fire and Game of Thrones. Color an editable map, fill in the legend, and download it for free.",pageName:"Westeros Houses Map (Game of Thrones/aSoIaF)",pageSlug:"westeros",pageSpecificJS:!0,site:"mapchart",subdivision:["subdivision","subdivisions"],subheading:!0},world:{ads:{bottomRectangle:!0,topBanner:!0},has:{colorRegion:!0,header:!0,labels:!0,zoom:!0},pageDescription:"Create your own custom World Map showing all countries of the world. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"World Map - Simple",pageSlug:"world",pageSpecificJS:!0,site:"mapchart",subdivision:["country","countries"],wideLayout:!0},"world-1815":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,zoom:!0},pageDescription:"Create your own custom historical map of the World in 1815, during the height of the Napoleonic Wars. Color an editable map, fill in the legend, and download it for free.",pageName:"World Map - 1815",pageSlug:"world-1815",site:"historicalmapchart",subdivision:["country","countries"],wideLayout:!0},"world-1880":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,zoom:!0},pageDescription:"Create your own custom historical map of the World in 1880. Color an editable map, fill in the legend, and download it for free.",pageName:"World Map - 1880",pageSlug:"world-1880",site:"historicalmapchart",subdivision:["country","countries"],wideLayout:!0},"world-1914":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,zoom:!0},pageDescription:"Create your own custom historical map of the World in 1914, before the start of World War I. Color an editable map, fill in the legend, and download it for free.",pageName:"World Map - 1914",pageSlug:"world-1914",site:"historicalmapchart",subdivision:["country","countries"],wideLayout:!0},"world-1938":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,zoom:!0},pageDescription:"Create your own custom historical map of the World in 1938, before the start of World War I. Color an editable map, fill in the legend, and download it for free.",pageName:"World Map - 1938",pageSlug:"world-1938",site:"historicalmapchart",subdivision:["country","countries"],wideLayout:!0},"world-advanced":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorRegion:!0,header:!0,zoom:!0},pageDescription:"Create your own free custom World map. Includes rivers, lakes, major cities, and more. Color an editable map, fill in the legend, and download it for free.",pageName:"World Map - Advanced",pageSlug:"world-advanced",pageSpecificJS:!0,site:"mapchart",subdivision:["country","countries"],wideLayout:!0},"world-cold-war":{ads:{bottomRectangle:!0,topBanner:!0},has:{header:!0,zoom:!0},pageDescription:"Create your own free custom historical map of the World during the Cold War. A world map showing all countries borders from 1946 to 1989 and beyond.",pageName:"World - Cold War",pageSlug:"world-cold-war",pageSpecificCSS:!0,pageSpecificJS:!0,site:"historicalmapchart",subdivision:["country","countries"],wideLayout:!0},"world-pacific":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorRegion:!0,header:!0,labels:!0,zoom:!0},pageDescription:"Create your own custom pacific-centered World Map showing all countries of the world. Color an editable map, fill in the legend, and download it for free to use in your project.",pageName:"World Map - Pacific-Centered",pageSlug:"world-pacific",pageSpecificJS:!0,site:"mapchart",subdivision:["country","countries"],wideLayout:!0},"world-subdivisions":{ads:{bottomRectangle:!0,topBanner:!0},has:{colorMany:!0,colorSingle:!0,header:!0,isolateMany:!0,isolateSingle:!0,searchBySubdivision:!0,zoom:!0},pageDescription:"Create your own custom World map with all countries' subdivisions (provinces, states, etc.). Color an editable map, fill in the legend, and download it for free.",pageName:"World Map - Subdivisions",pageSlug:"world-subdivisions",site:"mapchart",subdivision:["subdivision","subdivisions"],subdivisionGroup:["country","countries"],wideLayout:!0}}};var XI=$("#scripts-table>tbody"),QI=$("#scripts-output-message"),Xy=$("#scripts-output"),da=Zy.pages[Fe]||"index",jt,ua;da?.subdivision!==void 0&&(jt=da.subdivision[1]);da?.subdivisionGroup!==void 0&&(ua=da.subdivisionGroup[0]);function Qy(){let t={"random-color":{label:"Random color",description:"Randomly colors the whole map. Select how many colors to use. </br> \u26A0\uFE0F &nbsp; WARNING: The current map will be cleared. Use undo to go back.",option:"<select class='form-control input-sm' id='random-colors-select'> </select><br/><textarea class='form-control' rows='3' id='random-colors-list'> </textarea>",onRun:nk,onInit:ek},"random-color-by-group":{label:`Random color by ${ua}`,description:`Randomly colors the whole map. ${jt} belonging to the same group will have the same color. Select how many colors to use. </br> \u26A0\uFE0F &nbsp; WARNING: The current map will be cleared. Use undo to go back.`,option:"<select class='form-control input-sm' id='random-colors-select-by-group'> </select><br/><textarea class='form-control' rows='3' id='random-colors-list-by-group'> </textarea>",onRun:ik,onInit:tk,isDetailedOnly:!0},"find-uncolored":{label:`Find uncolored ${jt}`,description:`Scans the map for ${jt} that are uncolored (still have the default color).`,onRun:rk},count:{label:`Count ${jt}`,description:`Total number of ${jt} on the map.`,onRun:sk},"count-by-group":{label:`Count ${jt} by ${ua}`,description:`Total number of ${jt} on the map by ${ua}.`,onRun:ok,isDetailedOnly:!0},list:{label:`List ${jt}`,description:`Get a list of all names of ${jt} on the map.`,onRun:ak}};for(let e in t){let n=t[e];if(n.isDetailedOnly&&da.subdivisionGroup===void 0)continue;let i=`run-${e}`;XI.append(`<tr> 
        <td><img class="img script-icon" src="dist/img/scripts/${e}-icon.png"/></td>
        <td><strong>${n.label} </strong></td>
        <td>${n.description}</td>
        <td>${n.option??""}</td>
        <td><a role="button" class="btn btn-link run-script" id="${i}"><i class="fa fa-play" aria-hidden="true"></i>  </a>  </td>
        </tr>`),n.onInit?.(),$(`#${i}`).on("click",function(){n.onRun?.()})}}function ek(){eb()}function tk(){eb(!0)}function eb(t=!1){let e=t?$("#random-colors-select-by-group"):$("#random-colors-select"),n=t?$("#random-colors-list-by-group"):$("#random-colors-list");e.append(Array.from({length:20},(i,r)=>r+1).map(i=>`<option value="${i}">${i}</option>`)),e.find("option").eq(0).val("default").html("Number of colors").attr("disabled",!0),e.on("change",function(){let i=[];for(let r=0;r<this.value;r++){let s=Math.floor(Math.random()*Jy.length);i.push(Jy[s])}n.val(i)})}function nk(){tb()}function ik(){tb(!0)}function tb(t=!1){zn(Ma());let n=(t?$("#random-colors-list-by-group"):$("#random-colors-list")).val().split(/[\s,]+/);if(n.every(i=>i[0]==="#"&&i.length===7)){if(t){let i=Ea();for(let r of i){let s=Math.floor(Math.random()*n.length),o=n[s];Be().each(function(){let a=this.id;hn(a)===r&&It(o,a)})}}else Be().each(function(){let i=this.id,r=Math.floor(Math.random()*n.length),s=n[r];It(s,i)});for(let i of n)$("#fillpicker").spectrum("addColorToSelectionPalette",i)}else lk("Not valid colors list. All colors should be comma-separated, in hex format. E.g.: #cc3333, #ff22aa, #d1abe2");Fe==="usa-hex-cartogram"&&updateVotes()}function rk(){let t=[];Be().each(function(){$(this).getFill()===mt&&t.push(this.id)}),gc(`There are ${t.length} uncolored ${jt}:`,t.join(", "))}function sk(){nb()}function ok(){nb(!0)}function nb(t=!1){if(t){let e={};Be().each(function(){let i=hn(this.id);e[i]===void 0?e[i]=1:e[i]+=1});let n="";for(let i in e){let r=Ca(i);n+=`${i}	${r}	${e[i]}
`}gc(`Total number of ${jt} by ${ua}: `,n)}else gc(`Total number of ${jt}: `,Be().length)}function ak(){let t=[];Be().each(function(){t.push(this.id)}),gc(`List of ${jt}: `,t.sort().join(", "))}function lk(t){Xy.before(`<div class="alert alert-danger alert-dismissible" role="alert">            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> ${t} </div>`)}function gc(t,e){QI.html(`<i class="fa fa-info-circle" aria-hidden="true"></i> <strong>${t}</strong>`),Xy.html(`${e}`)}var Jy=["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31c2c","#fdbf6f","#ff7f00","#cab2d6","#fbb4ae","#e41a1c","#377eb8","#4daf4a","#984ea3","#ff2000","#ffff33","#a65628","#999999","#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#ffa07a","#b15928","#6a3d9a","#ffed6f","#9e0142","#5e4fa2","#ffffbf","#1a9850","#4d4d4d","#6baed6","#71c671","#388e8e","#7d9ec0","#7171c6","#8e388e","#8e8e38","#00c957","#cc3333","#63b598","#ce7d78","#ea9e70","#a48a9e","#c6e1e8","#648177","#0d5ac1","#f205e6","#1c0365","#14a9ad","#4ca2f9","#a4e43f","#d298e2","#6119d0","#d2737d","#c0a43c","#f2510e","#651be6","#79806e","#61da5e","#cd2f00","#9348af","#01ac53","#c5a4fb","#996635","#b11573","#4bb473","#75d89e","#2f3f94","#2f7b99","#da967d","#34891f","#b0d87b","#ca4751","#7e50a8","#c4d647","#e0eeb8","#11dec1","#289812","#566ca0","#ffdbe1","#2f1179","#935b6d","#916988","#513d98","#aead3a","#9e6d71","#4b5bdc","#0cd36d","#250662","#cb5bea","#228916","#ac3e1b","#df514a","#539397","#880977","#f697c1","#ba96ce","#679c9d","#c6c42c","#5d2c52","#48b41b","#e1cf3b","#5be4f0","#57c4d8","#a4d17a","#225b8a","#be608b","#96b00c","#088baf","#f158bf","#e145ba","#ee91e3","#05d371","#5426e0","#4834d0","#802234","#6749e8","#0971f0","#8fb413","#b2b4f0","#c3c89d","#c9a941","#41d158","#fb21a3","#51aed9","#5bb32d","#807fba","#21538e","#89d534","#d36647","#7fb411","#0023b8","#3b8c2a","#986b53","#f50422","#983f7a","#ea24a3","#79352c","#521250","#c79ed2","#d6dd92","#e33e52","#b2be57","#fa06ec","#1bb699","#6b2e5f","#64820f","#1c2711","#21538e","#89d534","#d36647","#7fb411","#0023b8","#3b8c2a","#986b53","#f50422","#983f7a","#ea24a3","#79352c","#521250","#c79ed2","#d6dd92","#e33e52","#b2be57","#fa06ec","#1bb699","#6b2e5f","#64820f","#1c271b","#9cb64a","#996c48","#9ab9b7","#06e052","#e3a481","#0eb621","#fc458e","#b2db15","#aa226d","#792ed8","#73872a","#520d3a","#cefcb8","#a5b3d9","#7d1d85","#c4fd57","#f1ae16","#8fe22a","#ef6e3c","#243eeb","#1dc186","#dd93fd","#3f8473","#e7dbce","#421f79","#7a3d93","#635f6d","#93f2d7","#9b5c2a","#15b9ee","#0f5997","#409188","#911e20","#1350ce","#10e5b1","#fff4d7","#cb2582","#ce00be","#32d5d6","#172322","#608572","#c79bc2","#00f87c","#77772a","#6995ba","#fc6b57","#f07815","#8fd883","#060e27","#96e591","#21d52e","#d00043","#b47162","#1ec227","#4f0f6f","#1d1d58","#947002","#bde052","#e08c56","#28fcfd","#bb09ba","#36486a","#d02e29","#1ae6db","#3e464c","#a84a8f","#911e7e","#3f16d9","#0f525f","#ac7c0a","#b4c086","#c9d730","#30cc49","#3d6751","#fb4c03","#640fc1","#62c03e","#d3493a","#88aa0b","#406df9","#615af0","#4be47a","#2a3434","#4a543f","#79bca0","#a8b8d4","#00efd4","#7ad236","#7260d8","#1deaa7","#06f43a","#823c59","#e3d94c","#dc1c06","#f53b2a","#b46238","#2dfff6","#a82b89","#1a8011","#436a9f","#1a806a","#4cf09d","#c188a2","#67eb4b","#b308d3","#fc7e41","#af3101","#ff0655","#71b1f4","#a2f8a5","#e23dd0","#d3486d","#00f7f9","#474893","#3cec35","#1c65cb","#5d1d0c","#2d7d2a","#ff3420","#5cdd87","#a259a4","#e4ac44","#1bede6","#8798a4","#d7790f","#b2c24f","#de73c2","#d70a9c","#25b67a","#88e9b8","#c2b0e2","#86e98f","#ae90e2","#1a806b","#436a9e","#0ec0ff","#f812b3","#b17fc9","#8d6c2f","#d3277a","#2ca1ae","#9685eb","#8a96c6","#dba2e6","#76fc1b","#608fa4","#20f6ba","#07d7f6","#dce77a","#77ecca"];var ck=$(".theme-switcher-btn");async function ib(){let t=localStorage.getItem("theme")||"default";$(`button[data-theme='${t}']`).parent().addClass("is-active"),ck.on("click",function(){uk($(this).data("theme")),$(this).parent().siblings().each(function(){$(this).removeClass("is-active")}),$(this).parent().addClass("is-active")})}function uk(t){t!=="default"&&!$t()||(document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t),PAGE=="account"&&mc({prefName:"theme",prefValue:t}))}var _c="";function dk(){$("#showSvgControls, #svgControls").toggle(),$("#map-container").css("border","1px dashed #f78f1e"),mapchart.zoomTool=new $.SvgZoomer($("#map"),{isNestedSVG:!0,maxZoomLevel:20,adjustStrokeWidths:!0})}function hk(){$("#showSvgControls, #svgControls").toggle(),$("#map-container").css("border",""),mapchart.zoomTool.stop(),wt()}function fk(){$("#showSvgControls, #svgControls").toggle(),$("#map-container").css("border",""),mapchart.zoomTool.reset(),wt()}function ob(){let t=$("#legend-font"),e=IS_MACOS?"Helvetica":"Century Gothic";t.fontpicker({localFonts:ba,lang:"en",variants:!0,lazyLoad:!0,nrRecents:3,onSelect:function(s){let o=s.fontSpec;be("LEGEND_OPTION_CHANGE",{option:"legend-font",value:o},function(){Gc(o)})}}),t.val(e).trigger("change"),$("#legend-status").on("change",function(){let s=this.value;be("LEGEND_OPTION_CHANGE",{option:"legend-status",value:s},function(){Wc(s)})}),$("#legend-position").on("change",function(){let s=this.value;be("LEGEND_OPTION_CHANGE",{option:"legend-position",value:this.value},function(){La(s)})}),$("#legend-size").on("change",function(){let s=this.value;be("LEGEND_OPTION_CHANGE",{option:"legend-size",value:s},function(){Hc(s)})}),$("#legend-columns").on("change",function(){let s=this.value;be("LEGEND_OPTION_CHANGE",{option:"legend-columns",value:s},function(){Kc(parseInt(s))})}),$("#startZoom").on("click",function(){dk()}),$("#exitZoom").on("click",function(){hk()}),$("#resetZoom").on("click",function(){fk()}),$("#default-layout-setting-btn").on("click",function(){qs("default")}),$("#simple-layout-setting-btn").on("click",function(){qs("simple")}),$("#simple-reversed-layout-setting-btn").on("click",function(){qs("simple-reversed")});let n=document.getElementById("upload-txt-drop-area");$("#upload-txt-inp").on("change",function(s){let o=s.target.files[0];rb(o)}),["dragenter","dragover","dragleave","drop"].forEach(function(s){n.addEventListener(s,function(o){o.preventDefault(),o.stopPropagation()})}),["dragenter","dragover"].forEach(function(s){n.addEventListener(s,function(o){n.classList.add("highlight")})}),["dragleave","drop"].forEach(function(s){n.addEventListener(s,function(o){n.classList.remove("highlight")})}),n.addEventListener("drop",function(s){let o;s.dataTransfer.files.length>1?Lr("Please drag and drop only the mapChartSave config text file."):(o=s.dataTransfer.files[0],o.type!=="text/plain"?Lr("Incorrect file type. Please upload the mapChartSave config text file."):($("#uploaded-file-name").html(o.name),rb(o)))}),$("#patternBuilderModal").on("shown.bs.modal",function(){$(document).off("focusin.modal")});let i;$("#legend-table-body").sortable({start:function(){i=nt()},stop:function(){let s=nt();be("REARRANGE_LEGEND",{prevConfig:i,config:s},function(){wt()}),i=s}}),$("#uploadModal").on("show.bs.modal",function(s){let o=js();if(o){let a=xc(o);$("#autosave-message").html("Autosave from: "+a)}else $("#autosave-message").html("No autosave found for this map");_c="",$("#uploaded-file-name").html(" - "),$("#upload-textarea").val(""),$("#upload-txt-drop-area").removeClass("disabled")}),$("#advancedOptionsModal").on("shown.bs.modal",function(){$(document).off("focusin.modal")}),$(".colorpicker-draggable").draggable({scroll:!0,handle:"span#colorpicker-drag-handle",snap:"#colorpicker-row, #map-container",start:function(){$(this).addClass("moving-draggable"),$("#colorpicker-row").addClass("draggable-origin")},stop:function(s,o){var a=$(this).data("ui-draggable").snapElements,l=$.map(a,function(c){return c.snapping?c.item.id:null});l.length===1&&l.includes("colorpicker-row")&&($(this).removeClass("moving-draggable"),$("#colorpicker-row").removeClass("draggable-origin"))}}),$("#legend-table-body").on("mouseover",function(s){if(s.target.classList.contains("legend-box")){let o=$(s.target),a=$("#legend-table-body .legend-box").index(o)+1,l=a<10?`Shortcut: ${a}`:"",c=o.parent().parent().attr("id").replace("legend-row-",""),h=Xi();if(c.length>7){let u=h[c].count;o.attr("data-tooltip",`${u} ${u==1?"item":"items"} with this pattern. Click to change. Right-click to select again. ${l}`)}else{let u=h["#"+c].count;o.attr("data-tooltip",`${u} ${u==1?"item":"items"} with color ${"#"+c}. Click to change. Right-click to select again. ${l}`)}}});let r=$('<div id="info-tooltip">');if($("#rsr").append(r),$("#no-borders").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"border-visibility-setting"},function(){Dp(s)})}),$(".scale-patterns-setting").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"scaling-patterns-setting"},function(){Mp(!s)})}),$("#legend-rows-same-color-setting").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"legend-rows-same-color-setting"},function(){Lp(!s)})}),$("#stroke-width-setting").on("change",function(){let s=this.value;be("MAP_SETTING_CHANGE",{option:"stroke-width-setting"},function(){Xc(s)})}),["africa","americas","asia","brazil","canada","caribbean","china","detworld","europe","europe-world-war-1","europe-world-war-2","france","germany","italy","japan","mexico","middle-east","russia","spain","sweden","turkey","uk","uk-postcodes"].includes(PAGE)&&$('text[id$="_label"]').hide(),["world","world-pacific"].includes(PAGE)&&$('text[id$="_label"], #city_labels').hide(),PAGE==="india"&&$('text[id*="_label"]').hide(),$("#show-names").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"labels-visibility"},function(){jc(s)})}),["europe-nuts2","europe-nuts3","turkey","usa-congressional-districts","usa-counties","wargames"].includes(PAGE)&&$("#show-state-borders").on("change",function(){let s=this.checked,o;PAGE=="turkey"?o="region":PAGE.includes("usa")?o="state":o="country",be("MAP_SETTING_CHANGE",{option:`${o}-borders-visibility`},function(){qc(s)})}),["world","world-pacific"].includes(PAGE)&&($("#US_States, #Canada_States").children().each(function(){bt(this.id),$(this).hide()}),$("#show-usa-states").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"US-states-visibility"},function(){Yc(s)})}),$("#show-canada-states").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"Canada-states-visibility"},function(){Zc(s)})})),["world","world-pacific","europe"].includes(PAGE)){for(let s of Ws)bt(s),$("#"+s).hide();$("#split-uk").on("change",function(){let s=this.checked;be("MAP_SETTING_CHANGE",{option:"the-UK-countries-visibility"},function(){Jc(s)})})}$(".btn-icon-drop[class*=icon]").on({mouseover:function(){$(this).css("color",$(this).css("background-color"))},mouseout:function(){$(this).css("color","#fff")},click:function(){$(this).css("color","#fff")}}),$("#download, #edit").hide(),$("#isolate-alert, #color-many-alert").hide(),$("#isolate-alert, #color-many-alert").on("closed.bs.alert",function(){$(this).html("")}),$("#map-title").on("keydown",function(s){s.which==13&&s.preventDefault()}),Vc("#map-title"),$(window).on("resize",function(){wt()}),$(document).on("keydown",function(s){if((s.ctrlKey||s.metaKey)&&(s.key=="z"||s.key=="Z"?(s.preventDefault(),Hr("undo")):(s.key=="y"||s.key=="Y")&&(s.preventDefault(),Hr("redo"))),[1,2,3,4,5,6,7,8,9].map(a=>a.toString()).includes(s.key)&&!$("input, textarea").is(":focus")){let a=parseInt(s.key)-1,l=$("#legend-table-body .legend-box").eq(a).attr("data-paint");l&&$("#fillpicker").spectrum("set",l)}})}function rb(t){let e=document.getElementById("upload-txt-drop-area");$("#uploaded-file-name").html(t.name);let n=new FileReader;n.onload=function(i){_c=i.target.result,e.classList.add("disabled")},n.readAsText(t,"UTF-8")}function Uf(){$("#fillpicker").spectrum({color:"#cc3333",showInput:!0,showPalette:!0,showEyeDropper:!0,palette:ui,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"fillpicker-container",includePatternsInPalette:!0,show:function(){for(let t in Xi())$(`.fillpicker-container .sp-palette-container span.sp-thumb-el[title="${t}"]`).addClass("sp-thumb-active")}}),$("#backgroundpicker").spectrum({color:"#ffffff",showInput:!0,showPalette:!0,palette:Jf,showPaletteOnly:!0,togglePaletteOnly:!0,showSelectionPalette:!0,hideAfterPaletteSelect:!0,showAlpha:!0,preferredFormat:"hex",containerClassName:"backgroundpicker-container",change:function(t){be("COLORPICKER_CHANGE",{colorpicker:"backgroundpicker",color:t},function(){Qs(t.toString())})},show:function(){$(`.backgroundpicker-container .sp-palette-container span.sp-thumb-el[title="${$("#backgroundpicker").spectrum("get").toString()}"]`).addClass("sp-thumb-active")}}),$("#borderpicker").spectrum({color:"#000000",showInput:!0,showPalette:!0,palette:Xf,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"borderpicker-container",change:function(t){be("COLORPICKER_CHANGE",{colorpicker:"borderpicker",color:t},function(){$a(t.toString())})},show:function(){$(`.borderpicker-container .sp-palette-container span.sp-thumb-el[title="${$("#borderpicker").spectrum("get").toString()}"]`).addClass("sp-thumb-active")}}),$("#legendbgpicker").spectrum({color:"#00000000",showInput:!0,showPalette:!0,palette:Qf,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,showAlpha:!0,preferredFormat:"hex",containerClassName:"legendbgpicker-container",change:function(t){be("COLORPICKER_CHANGE",{colorpicker:"legendbgpicker",color:t},function(){Js(t.toString())})}}),$("#legendfontcolorpicker").spectrum({color:"#000000",showInput:!0,showPalette:!0,palette:Cc,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"legendfontcolorpicker-container",show:function(){$(`.legendfontcolorpicker-container .sp-palette-container span.sp-thumb-el[title="${$("#legendfontcolorpicker").spectrum("get").toString()}"]`).addClass("sp-thumb-active")},change:function(t){be("COLORPICKER_CHANGE",{colorpicker:"legendfontcolorpicker",color:t},function(){Xs(t.toString())})}}),$("#defaultcolorpicker").spectrum({color:mt,showInput:!0,showPalette:!0,palette:ep,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"defaultcolorpicker-container",show:function(){$(`.defaultcolorpicker-container .sp-palette-container span.sp-thumb-el[title="${$("#defaultcolorpicker").spectrum("get").toString()}"]`).addClass("sp-thumb-active")},change:function(t){be("COLORPICKER_CHANGE",{colorpicker:"defaultcolorpicker",color:t},function(){eo(t.toString())})}}),$("#labelscolorpicker").spectrum({color:Wr,showInput:!0,showPalette:!0,palette:Cc,showPaletteOnly:!0,togglePaletteOnly:!0,hideAfterPaletteSelect:!0,preferredFormat:"hex",containerClassName:"labelscolorpicker-container",show:function(){$(`.labelscolorpicker-container .sp-palette-container span.sp-thumb-el[title="${$("#labelscolorpicker").spectrum("get").toString()}"]`).addClass("sp-thumb-active")},change:function(t){be("COLORPICKER_CHANGE",{colorpicker:"labelscolorpicker",color:t},function(){to(t.toString())})}}),PAGE!=="my-palette"&&$.contextMenu({selector:".fillpicker-container .sp-thumb-el",className:"fillpicker-palette-context-menu",items:{addToMyPalette:{name:"Add to My Palette",icon:"fa-heart",className:"context-add-to-palette",callback:(t,e)=>{Rs(e.$trigger.attr("title")).then(()=>{$("#fillpicker").spectrum("reflow"),sb()})},disabled:(t,e)=>!$t()||Je.includes(e.$trigger.attr("title"))},removeFromMyPalette:{name:"Remove from My Palette",icon:"fa-heart-o",className:"context-remove-from-palette",callback:(t,e)=>{Ns(e.$trigger.attr("title")).then(()=>{$("#fillpicker").spectrum("reflow"),sb()})},disabled:(t,e)=>!$t()||!Je.includes(e.$trigger.attr("title"))}}})}function sb(){let t=$(".fillpicker-container .sp-my-palette-toggle");t.css("background-color","var(--accent-color)"),setTimeout(()=>{t.css("background-color","initial")},250)}function mk(){ap(),Uy();let t=this;ib(),Fe!==""&&!ya.includes(Fe)?(wp(),e(Fe).then(()=>{Mf(),Ip()})):Fe==="account"?Mf():Fe==="my-palette"&&(Nc($("#sample-svg")[0]),Uf());async function e(l){let c=Math.floor(Math.random()*9e4)+1e4;$("#map-loading-bars").length==0&&$("#map-container").height("700px").prepend($('<div id="map-loading-bars" class="loading-bars"></div>')),$("#map-loading-bars").show();let u=await(await fetch("svg/"+l+".svg?v="+c,{cache:"reload"})).text(),d=$(u);d.length>1&&(d=$(d[d.length-1]));let p=`0 0 ${d.attr("width")} ${d.attr("height")}`;d.attr({id:"map",viewBox:p,preserveAspectRatio:"xMinYMin"});let _=document.createElementNS("http://www.w3.org/2000/svg","svg"),g=$(_);if(g.attr({id:"wrapper",viewBox:p,preserveAspectRatio:"xMinYMin",height:d.attr("height"),width:d.attr("width")}),g.append(d),$("#rsr").append(g),d.attr({"data-originalStrokeWidth":d.children("path").first().attr("stroke-width")}),$("#map-container").height("auto"),$("#map-loading-bars").hide(),t.wrapper=_,t.$wrapper=g,n(d),i(),typeof pageSpecificSetup=="function"&&pageSpecificSetup(),window.isTestingLocally){var y=document.createElement("script");y.type="text/javascript",y.src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.0.0/bootstrap-slider.min.js",document.body.appendChild(y);var v=document.createElement("link");v.rel="stylesheet",v.href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.0.0/css/bootstrap-slider.min.css",document.body.appendChild(v),y.addEventListener("load",function(){yp(),PAGE=="usa-counties"&&bp()})}}function n(l){t.$svg=l,t.svg=l[0],t.$vPaths=Be(),Nc(t.svg),$("#canvas1").attr({width:conf.canvasW,height:conf.canvasH}),Wy(t.$svg)}function i(){$("#download").on("click",function(){s(this,"canvas1")}),$("#convert").on("click",function(){a()}),$("#edit").on("click",function(){o()}),$("#clear").on("click",function(){r()}),$("#save-config").on("click",function(){let l=nt();this.href="data:text/plain;charset=utf-8,"+encodeURIComponent(l);let c="mapchartSave__"+PAGE+"__"+$("#map-title").val().substring(0,32);this.download=c.replace(/[^\w]/gi,"_")+".txt"}),$("#upload-config").on("click",function(){let l=_c.trim()||$("#upload-textarea").val().trim();l?be("UPLOAD_CONFIG",{},function(){zn(l)}):Lr("No configuration found. Please use one of the above methods to upload your configuration.")}),$("#restore-autosave").on("click",function(){be("RESTORE_AUTOSAVE",{},function(){let l=localStorage.getItem(js());zn(l)}),$("#uploadModal").hide()}),$("#undo-action").on("click",function(){Hr("undo")}),$("#redo-action").on("click",function(){Hr("redo")}),$("#legend-position").val(conf.legendPosition),ob(),Uf(),$("#color-single").length&&Vp(),$("#color-many").length&&Hp(),$("#isolate-single").length&&Wp(),$("#isolate-many").length&&Gp(),$(".search-entity").length&&jp(),$("#color-region").length&&qp(),Qy()}function r(){let l=nt(!0);if(be("CLEAR_ALL",{prevConfig:l},function(){zn(Ma())}),!localStorage.getItem("seen-undo-clear-msg")){let h=$("<div id='undo-clear-msg'><p><i class='fa fa-arrow-left' aria-hidden='true'></i> Use the undo button to undo clearing the map.</p><button class='btn-link'>Don't show this again.</button></div>");$("#undo-action").after(h),$("#undo-clear-msg button").on("click",function(){localStorage.setItem("seen-undo-clear-msg",!0),h.remove()})}}function s(l,c){let h=document.getElementById("canvas1").toDataURL("image/png"),u=_p(Yy(h,300)),d=URL.createObjectURL(u),p=$("#map-title").val();IS_IE_OR_EDGE?l.download=p?p.replace(/\W/g,"_")+".png":"MapChart_Map.png":l.download=p?p.replace(/\W/g,"_"):"MapChart_Map",l.href=d,/iP(hone|od|ad)/.test(navigator.platform)&&(l.href=h)}function o(){$("#credit-text-svg").attr("visibility","hidden"),$("#canvas1, #status-bar").hide(),$("#wrapper, #side-controls").show();let l=document.getElementById("canvas1");l.getContext("2d").clearRect(0,0,l.width,l.height),wt(),Hs("enable"),$("#download, #edit").hide(),$("#convert").show("fast")}async function a(){$("#map-loading-bars").show(),IS_SAFARI||$(window).width()<768?$("#status-bar").html("Use Download Map to download your map as an image."):$("#status-bar").html("Use Download Map or right-click &gt; Save image as... to download your map as an image."),nt(!0),await Ap(),kp(),$("#legend-handle-g").attr("visibility","hidden");let l=self.URL||self.webkitURL||self,c=new Image,h=document.getElementById("canvas1"),u=conf.canvasH,d=t.$svg.attr("data-originalVB")?di(t.$svg.attr("data-originalVB")):di(t.$svg.attr("viewBox")),_=parseFloat(t.$svg.attr("height"))/d.h;h.setAttribute("height",u*_);let g=new XMLSerializer().serializeToString(document.querySelector("#wrapper")),y=h.getContext("2d"),v=IS_SAFARI?"image/svg+xml":"image/svg+xml;charset=utf-8",w=new Blob([g],{type:v}),S=l.createObjectURL(w);c.src=S,c.onload=function(){y.fillStyle=$("#backgroundpicker").spectrum("get").toString(),y.fillRect(0,0,h.width,h.height),IS_SAFARI?setTimeout(()=>y.drawImage(c,0,0,h.width,h.height),100):y.drawImage(c,0,0,h.width,h.height),$("#map-loading-bars").hide(),$("#credit-text-svg").remove(),$("#legend-handle-g").removeAttr("visibility"),l.revokeObjectURL(S)},Hs("disable"),$("#status-bar").css("background-color","var(--switch-color)").show(),$("#canvas1, #wrapper, #side-controls").toggle(),$("#convert").hide(),$("#download, #edit").show("fast")}return{colorPath:It,saveConfig:nt,showPath:Ut,hidePath:bt,restoreConfig:zn,removePaint:Ti,edit:o,convert:a,colors:Xi,isHidden:Nt,verifyPath:Yt,getVPaths:Be,initializeMap:n,getURLParams:Ji,generateTestCloudConfigs:Vy}}var gk=new mk;window.mapchart=gk;})();
/*!

JSZip v3.10.0 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/
/*! @license DOMPurify 2.3.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.8/LICENSE */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
//# sourceMappingURL=mapchart.min.js.map
